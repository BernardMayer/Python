CRMINTCO                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , trim(both from TRIM(leading '0' from STR1.IDCANA)) IDCANA , STR1.IDSEC1 , STR1.NBMAX0 , STR1.DDVALA , STR1.DADMAA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CNL CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE and trim(both from TRIM(leading '0' from STR1.IDCANA)) = trim(both from TRIM(leading '0' from CIR1.ID_CNL)) AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.SEGM_MRCH_CIAL CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE and STR1.IDSEC1 = CIR2.ID_SEGM_CIAL AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
PDI0VU02                                          SELECT STR1.CD_EDS_BNQ , STR1.CDBCF1 , STR1.CDBCF2 , STR1.DTRA , STR1.NUMCR1 , STR1.CDENR2 , STR1.NUSEQ1 , STR1.CDOPE , STR1.CDAPPA , STR1.CDENR5 , STR1.NUSEQ9 , STR1.FILLER_2 , STR1.DEEFM1 , STR1.DADAC , STR1.CDTRT5 , STR1.IDCPR , STR1.NUMCR1_2 , STR1.CDPAS , STR1.IDVERP , STR1.CTINC0A , STR1.CTINC0B , STR1.CTINC0C , STR1.CTINC0D , STR1.CTINC0E , STR1.DEEFM1A , STR1.DADACA , STR1.CDTRT5A , STR1.IDCPRA , STR1.NUMCR1_2A , STR1.NUCOT , STR1.NUCOTA , STR1.NUCOTB , STR1.NUCPTE , STR1.CDPASA , STR1.IDVERPA , STR1.CTINC0F , STR1.CTINC0G , STR1.CTINC0H , STR1.CTINC0I , STR1.CTINC0J , STR1.DEEFM1B , STR1.DADACB , STR1.CDTRT5B , STR1.IDCPRB , STR1.NUMCR1_2B , STR1.CDPASB , STR1.IDVERPB , STR1.CTINC0K , STR1.CTINC0L , STR1.CTINC0M , STR1.CTINC0N , STR1.CTINC0O , STR1.FILLERZ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , CASE WHEN APROD.CD_FAM_PROD_1 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_2 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_3 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_4 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_5 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_6 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_7 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_8 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_9 = 'RGP10045' THEN 1 WHEN APROD.CD_FAM_PROD_10 = 'RGP10045' THEN 1 ELSE 0 END AS FAM_PROD_RGP10045 , CASE WHEN APROD.CD_FAM_PROD_1 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_2 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_3 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_4 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_5 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_6 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_7 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_8 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_9 = 'RGP10033' THEN 1 WHEN APROD.CD_FAM_PROD_10 = 'RGP10033' THEN 1 ELSE 0 END AS FAM_PROD_RGP10033 , CASE WHEN CIR5.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CIR5.DFCOM2 , CASE WHEN SCAL.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 , CASE WHEN SCAL.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR4 , COALESCE(SCAL.MONTANT,0) MONTANT , CIR21.DAA94 , CIR3.MKACQ5 , CIR5.CDBEA , CASE WHEN CIR7.CDBCF IS NOT NULL THEN CIR7.CDBCF WHEN CIR22.CDBCF IS NOT NULL THEN CIR22.CDBCF ELSE NULL END AS CDBCF , CIR5.CDBCF AS CIR5_CDBCF , CASE WHEN CIR7.CDBUR IS NOT NULL THEN CIR7.CDBUR WHEN CIR21.CDBUR IS NOT NULL THEN CIR21.CDBUR ELSE NULL END AS CDBUR , CIR5.CDBUR AS CIR5_CDBUR , CIR3.CDBUR1 , CIR5.CDCHT , CASE WHEN CIR5.CDCLB IS NOT NULL THEN CIR5.CDCLB WHEN CIR8.CDCLB IS NOT NULL THEN CIR8.CDCLB WHEN CIR22.CDCLB IS NOT NULL THEN CIR22.CDCLB ELSE NULL END AS CDCLB , CIR7.CCONV1 , CIR3.CDEMI , CIR21.CDGARA , CASE WHEN CIR7.CDBGD3 IS NOT NULL THEN CIR7.CDBGD3 WHEN CIR22.CDBGD3 IS NOT NULL THEN CIR22.CDBGD3 ELSE NULL END AS CDBGD3 , CIR5.CDBGD3 AS CIR5_CDBGD3 , CIR22.CDIND , CIR3.CDNAN , CIR5.CDOFC , CIR3.CDOPT , CIR19.CDOPG5 , CASE WHEN CIR3.CDTRT5 IS NOT NULL THEN CIR3.CDTRT5 WHEN CIR4.CDTRT5 IS NOT NULL THEN CIR4.CDTRT5 WHEN CIR5.CDTRT5 IS NOT NULL THEN CIR5.CDTRT5 WHEN CIR7.CDTRT5 IS NOT NULL THEN CIR7.CDTRT5 WHEN CIR8.CDTRT5 IS NOT NULL THEN CIR8.CDTRT5 WHEN CIR19.CDTRT5 IS NOT NULL THEN CIR19.CDTRT5 WHEN CIR21.CDTRT5 IS NOT NULL THEN CIR21.CDTRT5 WHEN CIR22.CDTRT5 IS NOT NULL THEN CIR22.CDTRT5 ELSE NULL END AS CIR_CDTRT5 , CIR19.CDTRT0 , CIR8.CORIG3 , CASE WHEN CIR3.CDPAS IS NOT NULL THEN CIR3.CDPAS WHEN CIR4.CDPAS IS NOT NULL THEN CIR4.CDPAS WHEN CIR5.CDPAS IS NOT NULL THEN CIR5.CDPAS WHEN CIR7.CDPAS IS NOT NULL THEN CIR7.CDPAS WHEN CIR8.CDPAS IS NOT NULL THEN CIR8.CDPAS WHEN CIR21.CDPAS IS NOT NULL THEN CIR21.CDPAS ELSE NULL END AS CIR_CDPAS , CIR21.CQACQU , CIR22.CDRADO , CIR3.CDACH0 , CIR5.CDRIM , CIR19.CDREFS , CIR5.NOSCTC , CIR5.NOSCTP , CASE WHEN CIR5.CSTGAR IS NOT NULL THEN CIR5.CSTGAR WHEN CIR7.CSTGAR IS NOT NULL THEN CIR7.CSTGAR WHEN CIR21.CSTGAR IS NOT NULL THEN CIR21.CSTGAR ELSE NULL END AS CSTGAR , CIR4.CDSTR , CIR7.IDMOT1 , CIR4.CDTXA , CIR7.CBTED , CIR19.CDCCO , CIR19.CTGES1 , CIR7.CTRGL , CIR7.CTREN , CIR3.CTSOU , CIR8.MCARE2 , CIR8.MCARE5 , CIR8.MCARE , CIR8.MCARE4 , CIR4.QCREX , CASE WHEN CIR4.MTCVA2 IS NOT NULL THEN CIR4.MTCVA2 WHEN CIR22.MTCVA2 IS NOT NULL THEN CIR22.MTCVA2 ELSE NULL END AS MTCVA2 , CASE WHEN CIR4.MCBCA2 IS NOT NULL THEN CIR4.MCBCA2 WHEN CIR22.MCBCA2 IS NOT NULL THEN CIR22.MCBCA2 ELSE NULL END AS MCBCA2 , CASE WHEN CIR4.MTCVA4 IS NOT NULL THEN CIR4.MTCVA4 WHEN CIR22.MTCVA4 IS NOT NULL THEN CIR22.MTCVA4 ELSE NULL END AS MTCVA4 , CASE WHEN CIR5.DDCAP IS NOT NULL THEN CIR5.DDCAP WHEN CIR22.DDCAP IS NOT NULL THEN CIR22.DDCAP ELSE NULL END AS DDCAP , CIR21.DDEXE3 , CIR8.DFPERW , CIR5.DFINC1 , CIR4.DFVAL6 , CIR8.DFPESR , CIR3.DFPRO , CIR7.DAFSR , CIR21.DADMAA , CASE WHEN CIR5.DFCOM2 IS NOT NULL THEN CIR5.DFCOM2 WHEN CIR7.DFCOM2 IS NOT NULL THEN CIR7.DFCOM2 ELSE NULL END AS CIR_DFCOM2 , CASE WHEN CIR7.DDEIP1 IS NOT NULL THEN CIR7.DDEIP1 WHEN CIR8.DDEIP1 IS NOT NULL THEN CIR8.DDEIP1 ELSE NULL END AS DDEIP1 , CASE WHEN CIR5.DDETE0 IS NOT NULL THEN CIR5.DDETE0 WHEN CIR7.DDETE0 IS NOT NULL THEN CIR7.DDETE0 ELSE NULL END AS DDETE0 , CASE WHEN CIR3.DADAC IS NOT NULL THEN CIR3.DADAC WHEN CIR4.DADAC IS NOT NULL THEN CIR4.DADAC WHEN CIR5.DADAC IS NOT NULL THEN CIR5.DADAC WHEN CIR7.DADAC IS NOT NULL THEN CIR7.DADAC WHEN CIR8.DADAC IS NOT NULL THEN CIR8.DADAC WHEN CIR19.DADAC IS NOT NULL THEN CIR19.DADAC WHEN CIR21.DADAC IS NOT NULL THEN CIR21.DADAC WHEN CIR22.DADAC IS NOT NULL THEN CIR22.DADAC ELSE NULL END AS CIR_DADAC , CASE WHEN (CIR5.DADMA4 IS NOT NULL AND CIR5.DADMA4<>0) THEN CAST(CAST (CIR5.DADMA4 AS char(8) ) AS DATE FORMAT 'YYYYMMDD') WHEN CIR21.DADMA4 IS NOT NULL THEN CIR21.DADMA4 ELSE NULL END AS DADMA4 , CIR8.DADRV , CIR5.DADAC2 , CIR4.DADEV , CIR19.DADAT2 , CIR3.DAPRO , CIR3.DADRE , CASE WHEN CIR3.DEEFM1 IS NOT NULL THEN CIR3.DEEFM1 WHEN CIR4.DEEFM1 IS NOT NULL THEN CIR4.DEEFM1 WHEN CIR5.DEEFM1 IS NOT NULL THEN CIR5.DEEFM1 WHEN (CIR7.DEEFM1 IS NOT NULL AND CIR7.DEEFM1<>0) THEN CAST(CAST (CIR7.DEEFM1 AS char(8) ) AS DATE FORMAT 'YYYYMMDD') WHEN CIR8.DEEFM1 IS NOT NULL THEN CIR8.DEEFM1 WHEN CIR19.DEEFM1 IS NOT NULL THEN CIR19.DEEFM1 WHEN CIR21.DEEFM1 IS NOT NULL THEN CIR21.DEEFM1 WHEN CIR22.DEEFM1 IS NOT NULL THEN CIR22.DEEFM1 ELSE NULL END AS CIR_DEEFM1 , CIR19.DEEFF1 , CASE WHEN CIR5.DEGAA IS NOT NULL THEN CIR5.DEGAA WHEN CIR7.DEGAA IS NOT NULL THEN CIR7.DEGAA ELSE NULL END AS DEGAA , CIR19.DTEFF2 , CIR21.DANAI0 , CIR3.DANAN , CIR3.DAOPP , CIR5.DDCOM2 , CIR7.DTRGT2 , CIR4.DTPPR , CIR21.DAPRV6 , CIR8.DAPRV ,CASE WHEN CIR3.DATER1 IS NOT NULL THEN CIR3.DATER1 WHEN CIR8.DATER1 IS NOT NULL THEN CIR8.DATER1 ELSE NULL END AS DATER1 , CIR8.DATER2 , CIR4.DTRGT1 , CIR19.DAREGV , CIR8.DAREV , CASE WHEN CIR3.DDSOU0 IS NOT NULL THEN CIR3.DDSOU0 WHEN CIR5.DASIG1 IS NOT NULL THEN CIR5.DASIG1 WHEN CIR7.DASIG1 IS NOT NULL THEN CIR7.DASIG1 WHEN CIR22.DASIC2 IS NOT NULL THEN CIR22.DASIC2 ELSE NULL END AS DDSOU0 , CIR7.DASRE , CIR8.PEDUR , CIR21.ZB001 , CIR19.ZB001A , CIR21.IDCPR AS CIR21_IDCPR , CIR5.NUMCR1 AS CIR5_NUMCR1 , CIR3.IDEXEF AS CIR3_IDEXEF , CASE WHEN CIR5.IDEXEF IS NOT NULL THEN CIR5.IDEXEF WHEN CIR7.NUMCR1 IS NOT NULL THEN CIR7.NUMCR1 ELSE NULL END AS IDEXEF , CIR3.NUMCR1 AS CIR3_NUMCR1 , CIR21.IDCTR5 , CIR8.IOFFR8 , CIR19.IDCDP0 , CASE WHEN CIR3.IDVERP IS NOT NULL THEN CIR3.IDVERP WHEN CIR4.IDVERP IS NOT NULL THEN CIR4.IDVERP WHEN CIR5.IDVERP IS NOT NULL THEN CIR5.IDVERP WHEN CIR7.IDVERP IS NOT NULL THEN CIR7.IDVERP WHEN CIR8.IDVERP IS NOT NULL THEN CIR8.IDVERP WHEN CIR21.IDVERP IS NOT NULL THEN CIR21.IDVERP ELSE NULL END AS CIR_IDVERP , CIR21.CDTPRE , CIR3.CBPAB , CIR3.CBGAN , CASE WHEN CIR5.LIDOE1 IS NOT NULL THEN CIR5.LIDOE1 WHEN CIR7.LIDOE1 IS NOT NULL THEN CIR7.LIDOE1 WHEN CIR22.LIDOE1 IS NOT NULL THEN CIR22.LIDOE1 ELSE NULL END AS LIDOE1 , CIR4.DEJPR1 , CIR7.MTPRP1 , CIR3.MTTER , CASE WHEN CIR4.MTPRE2 IS NOT NULL THEN CIR4.MTPRE2 WHEN CIR21.MTPRE2 IS NOT NULL THEN CIR21.MTPRE2 ELSE NULL END AS MTPRE2 , CIR22.MKCAP0 , CIR19.MSTNC4 , CIR4.MTIMPU , CIR3.MTNOMH , CIR3.MTPAB , CIR19.MTMONH , CIR4.MTSST , CIR22.MTDOTW , CIR22.MTMO02 , CIR4.MTVAN , CIR19.MTVAM5 , CIR22.MTVER , CASE WHEN CIR4.MTVOU8 IS NOT NULL THEN CIR4.MTVOU8 WHEN CIR7.MTVOU1 IS NOT NULL THEN CIR7.MTVOU1 WHEN CIR22.MTVOU8 IS NOT NULL THEN CIR22.MTVOU8 ELSE NULL END AS MTVOU8 , CIR7.NBTAS , CASE WHEN CIR5.NUCRS9 IS NOT NULL THEN CIR5.NUCRS9 WHEN CIR7.NUCRS9 IS NOT NULL THEN CIR7.NUCRS9 WHEN CIR22.NUCRS9 IS NOT NULL THEN CIR22.NUCRS9 ELSE NULL END AS NUCRS9 , CIR21.LNNPP4 , CIR21.LNPATF , CASE WHEN CIR3.NCPTEI IS NOT NULL THEN CIR3.NCPTEI WHEN CIR7.NCPCN IS NOT NULL THEN CIR7.NCPCN WHEN CIR22.NCPCN IS NOT NULL THEN CIR22.NCPCN ELSE NULL END AS NCPTEI , CIR5.NCPCN , NUCPTE AS CASE_NUCOT , CIR8.IDRF13 , CIR3.NOSCTD , CIR3.NSOUS1 , CIR7.PEARR , CASE WHEN CIR4.CFVER2 IS NOT NULL THEN CIR4.CFVER2 WHEN CIR21.CFVER2 IS NOT NULL THEN CIR21.CFVER2 ELSE NULL END AS CFVER2 , CASE WHEN CIR4.MSACI0 IS NOT NULL THEN CIR4.MSACI0 WHEN CIR22.MSACI0 IS NOT NULL THEN CIR22.MSACI0 ELSE NULL END AS MSACI0 , CASE WHEN CIR3.CPSTC IS NOT NULL THEN CIR3.CPSTC WHEN CIR21.CPSTC IS NOT NULL THEN CIR21.CPSTC ELSE NULL END AS CPSTC , CIR3.TXCHR1 , CIR4.TXCHR3 , CIR4.TXCHR2 , CIR21.TXFRR1 , CIR21.TXFRR , CIR8.TXREV , CIR8.MTRANF , CIR8.MTRANG , CIR5.CDVOC , CIR23.MBRUT , CIR19.MVNOML , CIR11.QCPTRJ , CIR11.IDPR , CIR23.MTNET0 , Case When REJ1.CD_BQE is null then 0 else 1 End ROW_FOUND_LNE FROM (SELECT STR12.* , STR12.NUCOT AS NUCPTE FROM %DTA%.PDI0VU02 STR12 WHERE STR12.TK_FLAG IN ('R','*') UNION ALL SELECT STR12.* , STR12.NUCOTA AS NUCPTE FROM %DTA%.PDI0VU02 STR12 WHERE STR12.TK_FLAG IN ('R','*') AND STR12.NUCOT <> STR12.NUCOTA UNION ALL SELECT STR12.* , STR12.NUCOTB AS NUCPTE FROM %DTA%.PDI0VU02 STR12 WHERE STR12.TK_FLAG IN ('R','*') AND STR12.NUCOT <> STR12.NUCOTB AND STR12.NUCOTA <>STR12.NUCOTB ) STR1 LEFT OUTER JOIN %DE1%.PDI0VU03 CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND NUCPTE=CIR3.NUCOT AND CIR3.TK_ACTION in ('I','U')) LEFT OUTER JOIN %DE1%.PDI0VU04 CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND NUCPTE=CIR4.NUCOT AND CIR4.TK_ACTION in ('I','U')) LEFT OUTER JOIN %DE1%.PDI0VU07 CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_EDS_BNQ AND NUCPTE=CIR7.NUCOT AND CIR7.TK_ACTION in ('I','U')) LEFT OUTER JOIN %DE1%.PDI0VU08 CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_EDS_BNQ AND NUCPTE=CIR8.NUCOT AND CIR8.TK_ACTION in ('I','U')) LEFT OUTER JOIN %DE1%.PDI0VU19 CIR19 ON (STR1.CD_EDS_BNQ=CIR19.CD_EDS_BNQ AND NUCPTE=CIR19.NUCOT AND CIR19.TK_ACTION in ('I','U')) LEFT OUTER JOIN %DE1%.PDI0VU21 CIR21 ON (STR1.CD_EDS_BNQ=CIR21.CD_EDS_BNQ AND NUCPTE=CIR21.NUCOT AND CIR21.TK_ACTION in ('I','U')) LEFT OUTER JOIN %DE1%.PDI0VU22 CIR22 ON (STR1.CD_EDS_BNQ=CIR22.CD_EDS_BNQ AND NUCPTE=CIR22.NUCOT AND CIR22.NUCOT IS NOT NULL AND CIR22.TK_ACTION in ('I','U')) LEFT OUTER JOIN %DE1%.PDI0VU11 CIR11 ON (STR1.CD_EDS_BNQ=CIR11.CD_EDS_BNQ AND NUCPTE=CIR11.NUCOT AND CIR11.NUCOT IS NOT NULL AND CIR11.TK_ACTION in ('I','U')) LEFT OUTER JOIN (SELECT T.NUCOT , T.CD_EDS_BNQ ,CAST(T.DEEFM1 AS CHAR(7))||'-01' AS DEEFMM ,SUM(T.MTNET0) AS MTNET0 ,SUM(T.MBRUT) AS MBRUT FROM (SELECT DISTINCT NUCOT,CD_EDS_BNQ,DEEFM1, MTNET0, MBRUT FROM %DE1%.PDI0VU23 WHERE TK_ACTION in ('I','U') ) T GROUP BY T.NUCOT,T.CD_EDS_BNQ,DEEFMM) CIR23 ON (STR1.CD_EDS_BNQ=CIR23.CD_EDS_BNQ AND NUCPTE=CIR23.NUCOT AND CIR23.DEEFMM=TD_MONTH_BEGIN(ADD_MONTHS(CAST(STR1.DT_ELIG AS DATE),-1)) ) LEFT OUTER JOIN %SOC%.ACCL_CTR_ECD CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CAST(STR1.NUCPTE AS BIGINT)=CIR1.NU_CPTE AND CIR1.NU_CPTE IS NOT NULL) LEFT OUTER JOIN %SOC%.ACCL_PROD APROD ON (CIR1.CD_PROD_CIAL = APROD.CD_PROD_CIAL AND APROD.DF_HISTO = CAST('9999-12-31 00:00:00' AS TIMESTAMP(0) FORMAT 'YYYY-MM-DDBHH:MI:SS')) LEFT OUTER JOIN %REJ%.LIST_NUCOT_ECART REJ1 ON (STR1.CD_EDS_BNQ = REJ1.CD_BQE AND( STR1.NUCOT = REJ1.NU_COT OR STR1.NUCOTA = REJ1.NU_COT OR STR1.NUCOTB = REJ1.NU_COT ) AND REJ1.OBJECT_CODE ='D304890') LEFT OUTER JOIN %DE1%.PDI0VU05 CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ AND NUCPTE=CIR5.NUCOT AND CIR5.TK_ACTION in ('I','U')) LEFT OUTER JOIN (SELECT SS1.CD_EDS_BNQ, SS1.NUCOT, SS1.DTRA, SS1.IDCDPA, SS1.IDVERP, SUM(SS1.NBPAR6*SS1.MTCOU0) AS MONTANT FROM (SELECT DE13.CD_EDS_BNQ, DE13.NUCOT, DE13.DTRA, DE12.IDCDPA, DE12.IDVERP, DE13.NBPAR6, DE12.MTCOU0 FROM %DE1%.PDI0VU13 DE13 INNER JOIN %DE1%.PDI0VU12 DE12 ON (DE13.CD_EDS_BNQ=DE12.CD_EDS_BNQ AND DE13.RFCCS=DE12.RFCCS AND DE13.DTRA = DE12.DTRA) WHERE DE13.RFCCS not in ('001620', '000166', '000020', '000600', '000734', '000182', '001095', '000622', '000012', '001622') ) AS SS1 GROUP BY SS1.CD_EDS_BNQ,SS1.NUCOT, SS1.DTRA, SS1.IDCDPA, SS1.IDVERP ) SCAL ON (SCAL.CD_EDS_BNQ=STR1.CD_EDS_BNQ AND SCAL.NUCOT=NUCPTE AND SCAL.DTRA=STR1.DTRA AND SCAL.IDCDPA=CIR4.CDPAS AND SCAL.IDVERP=CIR4.IDVERP)
V_MS_PROFILS                                      SELECT IDCR, IDFONCTION, IDEDS, IDPF, LIBPF, PFRESP, PROFILGROUPNAME FROM %PIL%%DatabaseMstrSuffix%.%ObjectNameFrom% STR1
TYP_EVT_FINANCIER_CST                             SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRA220                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPRSC , STR1.CQPRSC , STR1.IDCONV , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.GRA220 STR1 LEFT JOIN %SOC%.TYP_CT_PRSCRPTN CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CQPRSC=CIR1.CT_PRSCRPTN) LEFT JOIN (SELECT DISTINCT CD_BQE, ID_PRSCRPTR FROM %SOC%.PRSCRPTR ) CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDPRSC=CIR2.ID_PRSCRPTR)
DGXG66                                            SELECT STR1.CD_EDS_BNQ , STR1.IDTCN , STR1.PEMCT , STR1.CPICP , STR1.CQTTC , STR1.CQNTC , STR1.LNTCN , STR1.CBUCAP , STR1.CBTECC , STR1.CBMODP , CAST(trim(CAST(STR1.IDCANA AS INTEGER)(format 'Z(2)9')) AS CHAR(2)) IDCANA , STR1.CBTCON , STR1.KFCTCN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.DGXG66 STR1
OPERN_FAM_OPERN_CST                               SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DGCZ11                                            SELECT STR1.CD_EDS_BNQ , STR1.IDBTN , Max(STR1.DT_ELIG) DT_ELIG , Max(STR1.TK_CREATE) TK_CREATE , Max(STR1.TK_CHANGE) TK_CHANGE , Max(STR1.TK_FLAG) TK_FLAG , Max(STR1.TK_ACTION) TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1 GROUP BY 1,2
MESSAF                                            SELECT STR1.CD_EDS_BNQ , STR1.IDMSGF , STR1.IDMDC , STR1.IDPARZ , STR1.IDMEST , STR1.IDPART , STR1.KFMSG1 , STR1.DDMSG , STR1.DFRMS , STR1.CDRLP , STR1.CPMES , STR1.DMSME , STR1.CPEMSG , STR1.DMEMSG , STR1.QTEMS1 , STR1.QCLIC2 , STR1.DFAFFC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_PART,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR_PART,0) ID_DWR_PART_COM , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.PART CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDPART = CIR1.ID_PART AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PART CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.IDPARZ = CIR2.ID_PART AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
INTREL                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.NTMIRE , STR1.NTUNIA , STR1.NTUNIC , STR1.NTUNIE , STR1.NTUNIS , STR1.NTUNID , STR1.NTUNIU , STR1.DADMAJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_CLI_CIAL FROM %DTA%.INTREL STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCLC= TCO1.ID_SOURCE1)
COCLICO_SCOR                                      SELECT STR1.CD_EDS_BNQ , STR1.CODENR , STR1.DATPRO , STR1.NATURE , STR1.IDENTI , STR1.IDTEC , STR1.DATAPL , STR1.CODANU , STR1.CODENR_2 , STR1.IDECAM , STR1.IDSUJE , STR1.NOTSCO , STR1.RANG , STR1.CLASSM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CLI_CIAL , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , TCO2.ID_DWR ID_DWR_CTR , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , TCO3.ID_DWR ID_DWR_EDC , Case When TCO3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO3 , TCO4.ID_DWR ID_DWR_PART , Case When TCO4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO4 , CIR1.TYPSUJ , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.COCLICO_SCOR STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDSUJE=TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDSUJE=TCO2.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO TCO3 ON (STR1.CD_EDS_BNQ=TCO3.CD_EDS_BNQ AND STR1.IDSUJE || 'ECD' =TCO3.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO TCO4 ON (STR1.CD_EDS_BNQ=TCO4.CD_EDS_BNQ AND STR1.IDSUJE=TCO4.ID_SOURCE1) LEFT JOIN %DE1%.CRM_CARAC CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDTEC =CIR1.IDTEC AND CIR1.TK_ACTION IN ('I','U'))
T1R21                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDPART1 , STR1.CDINPR , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , COALESCE(CIR2.ID_DWR_PART,0) ID_DWR_PART , COALESCE(CIR3.CQLCCP,' ') CQLCCP , COALESCE(CIR3.CQLCCR,' ') CQLCCR , COALESCE(CIR4.ID_DWR,0) ID_DWR , COALESCE(CIR5.ID_DWR,0) PAR_ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART =CIR1.ID_SOURCE1) LEFT JOIN %SOC%.PART CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDPART1=CIR2.ID_PART and CIR2.CT_PART='GP' and CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.CDINPR = CAST(CIR3.CDVAL9 AS DECIMAL(2)) and CIR3.CDTABO='T1R21XXXCDINPR' AND CIR3.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_PART_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND STR1.IDPART = CIR4.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ AND STR1.IDPART1= CIR5.ID_SOURCE1)
TYP_SEGM_NOTATN_BALE_AGRG_CST                     SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DGCZ19                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPORT , STR1.DELIEN , STR1.DFLIEN , STR1.IDTYPO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.ID_CT_PORTEF , COALESCE(CIR2.ID_DWR,0) ID_DWR_CLI_COMCIAL , COALESCE(CIR3.ID_DWR,0) ID_DWR_PORTEF , Case WHEN CIR1.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_PORTEF CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDTYPO=CIR1.ID_CT_PORTEF and CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_CLI_CIAL_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDCLC =CIR2.ID_SOURCE1) LEFT JOIN %TCO%.ID_PORTEF_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.IDPORT=CIR3.ID_SOURCE1)
GRCO_GARANTIE                                     SELECT STR1.CD_EDS_BNQ , STR1.DFCOLT , STR1.IDGARP , STR1.IDPRET , STR1.IDELCH IDELCH_BYTE , CAST(STR1.IDELCH AS BYTE(15)) AS IDELCH_TR1 , CAST(%PMU%.Bin2Char(STR1.IDELCH) AS VARCHAR(46)) AS IDELCH , STR1.IDPOCE , STR1.MKVAG1 , STR1.NM684 , STR1.NMTGAR , STR1.DCARR7 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR AS ID_DWR_CREANC_EXPOSE , CIR1.ID_DWR_CREANC_EXPOSE AS ID_DWR_CREANC_EXPOSE_EDC , CIR2.NOSIR4 AS NU_SIREN_GARANT_RISQ , TCO2.ID_DWR AS ID_DWR_EDC , CIR5.ID_DWR_EDC AS ID_DWR_EDC_ECD , CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_TCO1 , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR4 , CASE WHEN TCO2.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_TCO2 , CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR5 , CASE WHEN NU_SIREN_GARANT_RISQ = '350892022' THEN '1' WHEN NU_SIREN_GARANT_RISQ IN ('209322733','784338527') THEN '2' WHEN NU_SIREN_GARANT_RISQ = '302493275' THEN '3' WHEN NU_SIREN_GARANT_RISQ IN ('320252489','319997466') THEN '4' WHEN NU_SIREN_GARANT_RISQ = '130006364' THEN '5' ELSE '-1' END AS CD_ORGAN_GRNT_RISQ FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CREANCE_EXPO_TCO TCO1 ON ( STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDPRET=TCO1.ID_SOURCE1) LEFT JOIN %SOC%.EDC_CRED_EXPOSE_MENS CIR1 ON ( CIR1.CD_BQE = TCO1.CD_EDS_BNQ AND CIR1.ID_DWR_CREANC_EXPOSE = TCO1.ID_DWR AND CIR1.DD_PE = CAST(TD_MONTH_BEGIN(ADD_MONTHS (STR1.DT_ELIG,-1)) AS DATE)) LEFT JOIN %DTA%.GRCO_TIERS CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPOCE = CIR2.IDPOCE) LEFT JOIN %SOC%.TYP_TYP_GRNT_BALE2 CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_BQE AND STR1.NMTGAR = CIR3.CT_GRNT_BALE2 AND CIR3.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR3.DF_HISTO) LEFT JOIN %SOC%.TYP_NATU_SURT CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_BQE AND STR1.NM684 = CIR4.CD_NATU_SURT AND CIR4.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR4.DF_HISTO) LEFT JOIN %TCO%.ID_EDC_TCO TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND IDELCH_TR1=TCO2.BY_SOURCE1 AND SUBSTR(TCO2.ID_SOURCE1,31,3)='ECD') LEFT JOIN %SOC%.ECD_DETENU CIR5 ON ( CIR5.CD_BQE = TCO2.CD_EDS_BNQ AND CIR5.ID_DWR_EDC = TCO2.ID_DWR AND CIR5.DF_HISTO = '9999-12-31 00:00:00')
PRECON                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPREC , STR1.IDCPG2 , STR1.IDACTC , STR1.LIPRE3 , STR1.CTCLG , STR1.LCPREC , STR1.CTMCN1 , STR1.CDOFFR , STR1.IDCTAC , STR1.IDPARZ , STR1.IDTRT , STR1.IDPART , STR1.IDELEX , STR1.IDCTRA IDCTRA_BYTE , CAST (Case when CIR1.CD_EDS_BNQ is not null then CIR1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDCTRA) End AS VARCHAR(30)) AS IDCTRA , STR1.NCPTE , STR1.DIPREC , STR1.DDPREC , STR1.DFPREC , STR1.CTPCS , STR1.IDWO , STR1.CPSIPR , STR1.CPPREC , STR1.CPSOPR , STR1.DMPREC , STR1.DMSSPR , STR1.DMSIPR , STR1.KFCLG , STR1.DDDIPR , STR1.COCHST , STR1.CTRAIS , STR1.CDRAIS , STR1.LIARG1 , STR1.MTSTDA , STR1.LIARG2 , STR1.MTSTDB , STR1.LIARG3 , STR1.MTSTDC , STR1.LIARG4 , STR1.MTSTDD , STR1.LIARG5 , STR1.MTSTDE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,-1) AS ID_DWR_CTR , COALESCE(CIR2.ID_DWR_PST_FNCT,0) AS ID_DWR_PST_FNCT , COALESCE(CIR3.ID_DWR,0) AS ID_DWR_PART , COALESCE(CIR4.ID_DWR,0) AS ID_DWR_PARZ , COALESCE(CIR5.ID_DWR_EDC,0) AS ID_DWR_EDC , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% sTR1 LEFT JOIN %TCO%.ID_CTR_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDCTRA=CIR1.BY_SOURCE1) LEFT JOIN %SOC%.PST_FNCT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDWO=CIR2.CD_PST_FNCT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_PART_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDPART=CIR3.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND STR1.IDPARZ=CIR4.ID_SOURCE1) LEFT JOIN %SOC%.ECD_DETENU CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE AND STR1.IDELEX=CIR5.ID_EDC_EXT AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE))
TYP_CATG_CONTREPARTIE_CST                         SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
PDIPRO                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCDP0 , STR1.IDCDPR , CIR1.CD_PROD_CIAL , trim(CAST((STR1.IDCDPR (FORMAT '9(05)')) AS CHAR(05))) as IDCDPR_CONV , STR1.CTPRO4 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End as Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 left join %SOC%.PROD_CIAL CIR1 ON (trim(CAST((STR1.IDCDPR (FORMAT '9(05)')) AS CHAR(05))) = CIR1.CD_PROD_CIAL)
ACTECO                                            SELECT STR1.CD_EDS_BNQ , STR1.CDACTE , STR1.LIACTE , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.CNAF93 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
C3RE01                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDELP , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_ELT_PATRIM , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART= CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_ELT_PATRIM_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND CAST(CAST(STR1.IDELP as format 'Z(I)') as VARCHAR(9)) = CIR2.ID_SOURCE1)
CERCOM                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCCO IDCCO_BYTE , CAST(COALESCE(CIR2.ID_SOURCE1,' ') as VARCHAR(30)) AS IDCCO , STR1.LNCCO , STR1.DCRE , STR1.DFVAL , STR1.CTCCO , STR1.CDMCO , STR1.IDFIPE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR,0) ID_DWR_CRCL_COM , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.TYMOCO CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.CDMCO=CIR1.CDMCO and CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_CRCL_COM_TCO CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDCCO=CIR2.BY_SOURCE1)
GRA024                                            Select S.CD_EDS_BNQ, S.GRA024_IDELCO||' '||cast(S.NOECPR AS FORMAT'9(3)')||'.' AS ID_SOURCE1, CAST(NULL AS BYTE(15)) AS BY_SOURCE1 FROM %DTA%.GRA024 S INNER JOIN %DE1%.GRA610 CIR1 ON (S.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND S.GRA024_IDELCO = CIR1.GRA610_IDELCO AND CIR1.TK_ACTION in ('I','U')) INNER JOIN %DE1%.GRA606 CIR2 ON (CIR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND CIR1.GRA610_IDLIMI = CIR2.GRA606_IDLIMI AND CIR2.TK_ACTION in ('I','U')) INNER JOIN %DE1%.GRA001 CIR3 ON (CIR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND CIR1.GRA610_IDELCO = CIR3.GRA001_IDELCO AND CIR3.TK_ACTION in ('I','U')) INNER JOIN %DE1%.E2R19G CIR4 ON (CIR2.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND CIR2.GRA606_IDELCO = CIR4.IDELC2 AND CIR4.TK_ACTION in ('I','U')) INNER JOIN %SOC%.ECD_DETENU CIR5 ON (CIR2.CD_EDS_BNQ=CIR5.CD_BQE AND CIR2.GRA606_IDELCO=CIR5.ID_EDC_CRED aND (CIR5.DF_HISTO='9999/12/31 00:00:00') AND CIR5.ID_EDC_CRED IS NOT NULL) WHERE CIR4.CDDOM3 = 'LI' AND CIR3.CDAPPR = 2
OPTN_PROD_CIAL                                    SELECT STR1.CD_EDS_BNQ , STR1.CD_OPTN , STR1.CD_PROD_CIAL , STR1.CD_PRES_OPTN_PROD , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_OPTN is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_PROD_CIAL is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_OPTN FROM %SOC%.OPTN ) CIR1 ON (STR1.CD_OPTN=CIR1.CD_OPTN) LEFT JOIN (Select DISTINCT CD_PROD_CIAL FROM %SOC%.PROD_CIAL) CIR2 ON (STR1.CD_PROD_CIAL=CIR2.CD_PROD_CIAL)
C817ACT                                           SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CTACO , STR1.IDECV , STR1.CPIMVP , STR1.CPPIJ , STR1.IDCOV , STR1.CPOBJE , STR1.IDACT , STR1.DTECO , STR1.DRECO , STR1.DLECO , STR1.IDACTD , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_CD_PRES_PCE_JUSTIF CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CPPIJ = CIR1.CD_PRES_PCE_JUSTIF AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.COVENANT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDCOV = CIR2.ID_COVENANT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CPOBJE = CIR3.CD_STATU_CRED_COMPLEXE AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ACTN_CRED_COMPLEXE CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.IDACT = CIR4.ID_ACTN AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
TYP_RISQ_4BRNC_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('0' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TDSCK144                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER , STR1.CDOPE , STR1.CDCOP , STR1.DOOPFK , STR1.NUEMN , STR1.LNEMET , STR1.IDCED , STR1.DOOPFH , STR1.LIBEL , STR1.LIBE2 , STR1.CDANU , STR1.CDOPE3 , STR1.NCREDT , STR1.NUALL , STR1.LIB24 , STR1.LCTXBA , STR1.CDLOC , STR1.TKCHG0 , STR1.CDMREJ , STR1.LICOM , STR1.CDOAFB , STR1.NUECR , STR1.CDOPES , STR1.DTTRT , STR1.CDETBA , STR1.CDGBDG , STR1.NCPINI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
SPCASV                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.CDISIN , STR1.LNSUP , STR1.IDQUEX , STR1.NBPAR0 , STR1.MVPART , STR1.DACVPA , STR1.MULATS , STR1.MVSUPQ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR as ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1)
DOFISC                                            SELECT STR1.CD_EDS_BNQ , STR1.IDDOFI IDDOFI_BYTE , CAST(COALESCE(TCO1.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDDOFI , STR1.IDPART , STR1.MTREIM , STR1.QTPART , STR1.DAARE1 , STR1.DDMOD , STR1.CDOMJ , STR1.MTREVE , STR1.QTENC7 , STR1.QTAPC2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(TCO1.ID_DWR,0) ID_DWR_DONNEE_FISC , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_DONNEE_FISC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDDOFI = TCO1.BY_SOURCE1)
TYP_SEGM_NOTATN_BALE_CST                          SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_SS_SECTR_INVSTMNT_CST                         SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DTWHD002                                          SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.K300 , STR1.CDETA5 , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.NCPTEY , STR1.CTDOSS , STR1.CQPPT , STR1.CTSOC , STR1.CDSOCS , STR1.LNSOC , STR1.MTRPA , STR1.NBPARF , STR1.IDNAN , STR1.MOCOM2 , STR1.FILLER , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR AS ID_DWR_EDC , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1) LEFT Join %SOC%.EPRGN_FINC_IMMO_CPTE CIR2 ON (TCO1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(TCO1.ID_SOURCE1 AS CHAR(30)) =CIR2.ID_EDC_VEGA AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
TYP_SCNRIO_VNT_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRA024                                            SELECT STR1.CD_EDS_BNQ ,STR1.GRA024_IDELCO ,STR1.NOECPR ,STR1.MTPACR ,STR1.CQTXPR ,STR1.CDTXRE ,STR1.TXMAJO ,STR1.TXACPR ,STR1.CDDIDX ,STR1.CPIPFI ,STR1.CWDETX ,STR1.QTJOBK ,STR1.CDMAPR ,STR1.ZTEVER ,STR1.NUECE3 ,STR1.NUECE8 ,STR1.CWBILL ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,COALESCE(CIR3.ID_DWR_EDC,0) ID_DWR_EDC ,TCO1.ID_DWR ID_DWR_PLFD_UTIL ,CIR1.GRA610_IDLIMI GRA610_IDLIMI ,Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 ,Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.GRA610 CIR1 ON (CIR1.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR1.GRA610_IDELCO=STR1.GRA024_IDELCO AND CIR1.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.GRA606 CIR2 ON (CIR2.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and CIR2.GRA606_IDLIMI=CIR1.GRA610_IDLIMI AND CIR2.TK_ACTION in ('I','U')) LEFT JOIN %SOC%.ECD_DETENU CIR3 ON (CIR2.CD_EDS_BNQ=CIR3.CD_BQE AND CIR2.GRA606_IDELCO IS NOT NULL AND CIR2.GRA606_IDELCO=CIR3.ID_EDC_CRED AND (CIR3.DF_HISTO='9999/12/31 00:00:00') AND CIR3.ID_EDC_CRED IS NOT NULL) INNER JOIN %TCO%.ID_PLFD_UTIL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.GRA024_IDELCO||' '||cast(STR1.NOECPR AS FORMAT'9(3)')||'.'= TCO1.ID_SOURCE1)
THICONSP                                          SELECT STR1.CD_EDS_BNQ , STR1.NCPTE , STR1.NSOC , STR1.HICAN , STR1.HICTRIM , STR1.HICMOIS , STR1.TYCONS , STR1.HICMNB , STR1.HICMMT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
CRED                                              SELECT DISTINCT STR1.CD_BQE ,STR1.ID_DWR_EDC ,CASE WHEN CIR1.CD_EDS_BNQ is null then 0 else 1 End OPENCT ,CASE WHEN CIR2.CD_EDS_BNQ is null then 0 else 1 End PAKPPA ,COALESCE(CIR1.IPART1,0) IPART1 ,COALESCE(CIR2.IDCTR1,0) IDCTR1 FROM %SOC%.%ObjectNameFrom% STR1 LEFT JOIN %DTA%.OPENCT CIR1 ON (CIR1.CD_EDS_BNQ=STR1.CD_BQE AND CAST(CAST(CAST(CIR1.IPART1 AS format 'Z(I)') AS format '9(11)') AS CHAR(11)) = STR1.ID_EDC_CRED AND CAST(STR1.DD_HISTO AS DATE)<=CIR1.DT_ELIG AND CIR1.DT_ELIG < CAST (STR1.DF_HISTO AS DATE) AND STR1.TYP_SOURCE_CRED = 'S' AND STR1.ID_EDC_CRED IS NOT NULL) LEFT JOIN %DTA%.PAKPPA CIR2 ON (CIR2.CD_EDS_BNQ=STR1.CD_BQE AND CAST(CAST(CAST(CIR2.IDCTR1 AS format 'Z(I)') AS format '9(11)') AS CHAR(11)) = STR1.ID_EDC_CRED AND CAST(STR1.DD_HISTO AS DATE)<=CIR2.DT_ELIG AND CIR2.DT_ELIG < CAST (STR1.DF_HISTO AS DATE) AND STR1.TYP_SOURCE_CRED = 'S' AND STR1.ID_EDC_CRED IS NOT NULL)
GRCO_GP_RISQUE                                    SELECT STR1.IDEXEY , STR1.IDGRRI , STR1.DFCOLT , STR1.CDSTGO , STR1.MAENTT , STR1.GRAGDR1 , STR1.DTNOTC1 , STR1.GRAGDR2 , STR1.DTNOTC2 , STR1.LNGRR0 , STR1.ISEGN , STR1.CTFIPE , STR1.DCARR7 , STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
INFINA                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.DFVAL , STR1.CQSOC , STR1.CBTEND , STR1.DDVAL , STR1.PECUM , STR1.DTMOIS , STR1.CBTENE , STR1.CDTOPB , STR1.CDTOPD , STR1.CDTOPO , STR1.CDTOPE , STR1.CDTOPL , STR1.CDTOPQ , STR1.CDTOPS , STR1.CDTOPT , STR1.CDTOPW , STR1.CDTOPM , STR1.CDTOP0 , STR1.CDTOPN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_CLI_CIAL FROM %DTA%.INFINA STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCLC= TCO1.ID_SOURCE1)
GRCO_DU_RET_COMP_DEG                              SELECT STR1.IDSTU , STR1.DFCOLT , STR1.CIDENV , STR1.IDPRET , STR1.CDMONT , STR1.CDCORB , STR1.CETACR , STR1.CDREMO , STR1.CDSTMC , STR1.CBOPIG , STR1.MTEA1E , STR1.MTRT1E , STR1.KPONDE , STR1.CDMPOC , STR1.MTTR1E , STR1.MTEADE , STR1.MTEXP , STR1.CDPREI , STR1.TXCCFS , STR1.CLACPO , STR1.CQOPE , STR1.IDEXEY , STR1.DCARR7 , STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
OFR_FAM_OFR                                       SELECT STR1.CD_EDS_BNQ , STR1.ID_OFR_BQR , STR1.CD_FAM_OFR , COALESCE(STR1.POIDS,0) POIDS , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.ID_OFR_BQR is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_FAM_OFR is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT ID_OFR_BQR FROM %SOC%.OFR ) CIR1 ON (STR1.ID_OFR_BQR=CIR1.ID_OFR_BQR) LEFT JOIN (Select DISTINCT CD_FAM_OFR FROM %SOC%.FAM_OFR) CIR2 ON (STR1.CD_FAM_OFR=CIR2.CD_FAM_OFR)
UNICA_3G                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.IDPRG , STR1.IDECA1 , STR1.IDCPG2 , STR1.LICPG , STR1.LNLCPG , STR1.LISTS , STR1.DDPRV0 , STR1.DFPRV0 , STR1.LIGRB , STR1.LISTA3 , STR1.LMCPG3 , STR1.DDCPG0 , STR1.DFCPG0 , STR1.LMOBJC , STR1.LMINIC , STR1.LISTSC , STR1.CTPRJC , STR1.LITYPP , STR1.LCCPG , STR1.CMARCH , STR1.IDSEC1 , STR1.CTCPGU , STR1.LTYPO , STR1.CTEVTU , STR1.LITYPE , STR1.CBPREI , STR1.CBISMC , STR1.IDCPGC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
PROD_PRODTR_PROD_PRODTR                           SELECT STR1.CD_EDS_BNQ , STR1.CD_PROD_PRODTR_M , STR1.CD_PROD_PRODTR_F , STR1.CD_NATU_REL , STR1.LI_NATU_REL , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_PROD_PRODTR is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_PROD_PRODTR is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_PROD_PRODTR FROM %SOC%.PROD_PRODTR) CIR1 ON (STR1.CD_PROD_PRODTR_M=CIR1.CD_PROD_PRODTR ) LEFT JOIN (Select DISTINCT CD_PROD_PRODTR FROM %SOC%.PROD_PRODTR) CIR2 ON (STR1.CD_PROD_PRODTR_F=CIR2.CD_PROD_PRODTR )
BAC000SO                                          SELECT STR1.CD_EDS_BNQ , STR1.CDCARE , STR1.IDPARC , STR1.NOOPFI , STR1.NOPROF , STR1.NOCCAM , STR1.CDDOIT , STR1.CDSOC , STR1.CDBIFI , STR1.CDTYUS , STR1.FILLER , STR1.CCATPR , STR1.CCATFI , STR1.CDCOMP , STR1.CDTECR , STR1.CDLOAM , STR1.CFPERI , STR1.CLDJNS , STR1.CDWA , STR1.DUTIBA , STR1.DAPRBA , STR1.DHZEBA , STR1.DDECBA , STR1.CT1DPR , STR1.TXANEC , STR1.CDDEOR , STR1.CDNATX , STR1.CCDH , STR1.DTCDT1 , STR1.DTPREX , STR1.FILL10 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1S.ID_DWR_EDC , CIR1S.ID_EDC_VEGA , CIR1S.ID_EDC_CRED , CIR1S.CD_DOMN_PROD , CIR1S.CD_ETAT_CTR_CRED , CIR1S.CD_TECHN_FINCT , CIR1S.TYP_SOURCE_CRED , CIR1S.DUR_THRQ_PRET , CIR1S.DT_DECI , CIR1S.DT_1ERE_ECHCE , CIR1S.DT_SIGNER_CTR_CRED , CIR1S.MT_ACCORDE_PRET_PAR_CR , CIR1S.MT_DEBLOQUE_REALISATION , CIR1S.MT_PROCH_ECHCE_THRQ , CIR1S.MT_CRD_REEL , CIR1S.MT_CRD_THRQ , CIR1S.MT_FINCT_GLOBAL , CIR1S.MT_UTILISE , CIR1S.FLAG_SINSTR_EN_COURS , CIR1S.ID_PART_GREEN , CIR1S.CD_ORIG_PRET , CIR1S.CD_LOI_CONSO , CIR1S.CD_AMRTSM_FIGE , CIR1S.ID_PROJ , CIR1S.VARIANTE_PROD_GREEN , CIR1S.NB_PS , CIR1S.J_ECHCE , CIR1S.TOP_MRCH , CIR1S.TOP_DUR_CTR , CIR1S.CD_TECHN_CRED_PROD , CIR1S.CD_AMRTSM , CIR1S.ID_AGT , CIR1S.ID_DWR_AGT , CIR1S.CD_REFERENCE_TX , CIR1S.TX_MAJORATION_MINORATION , CIR1S.DT_EDT , CIR1S.SECTEUR_FINCT , CIR1S.CD_STADE_AVANCEMENT , CIR1S.CD_STATU_PRET , CIR1S.CD_APERIODIQUE , CIR1S.DF_REELLE_CRED , CIR1S.CUM_RBT_PAR_ANTICIPATION , CIR1S.CD_GST , CIR1S.MT_ECHCE_FIX , CIR1S.DT_EMISSON_OFR_CRED , CIR1S.DT_RCPTN_OFR_CRED_GED , CIR1S.DT_TRT_REALN_CRED , CIR1S.DT_DECI_AP , CIR1S.CD_SOLTN_HAB , CIR1S.CD_DEPT_INVSTMNT FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED CIR1S ON ( CIR1S.ID_EDC_CRED=STR1.IDPARC AND CIR1S.CD_BQE=STR1.CD_EDS_BNQ AND CIR1S.TYP_SOURCE_CRED = 'S' AND CIR1S.DF_HISTO = CAST('9999-12-31 00:00:00' AS TIMESTAMP(0) FORMAT 'YYYY-MM-DDBHH:MI:SS') AND CIR1S.ID_EDC_CRED is not NULL)
FAM_PROD                                          SELECT STR1.CD_EDS_BNQ , STR1.CD_FAM_PROD , STR1.CD_USG_FAM , STR1.LI_FAM_PROD , STR1.INDIC_FAM_GRP , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_USG_FAM is Null Then 0 Else 1 END Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_USG_FAM FROM %SOC%.USG_FAM) CIR1 ON (STR1.CD_USG_FAM=CIR1.CD_USG_FAM)
REF_STATUT                                        SELECT STR1.CD_EDS_BNQ , STR1.STATUT_ID , STR1.STATUT_LIBELLE , STR1.STATUT_LIBELLE_IMP , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
LIBELSEG                                          SELECT STR1.CD_EDS_BNQ , STR1.IDNOMS , STR1.CDSEGM , STR1.IDECAM , STR1.LIB50D , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_METHD_NOTATN_PART_CST                         SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1 UNION SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
COCL_EQPM_CLI                                     SELECT STR1.CD_EDS_BNQ ,STR1.ID_STRUCT_CONSO ,STR1.ID_TECHN_EQPM_CLI ,STR1.ID_TECHN_CONSO_EQPM_CLI ,STR1.CD_FAM_PROD_COMCIAL_EQPM_CLI ,STR1.TS_MAJ_EQPM_CLI ,STR1.ID_STRUCT_MAJ_EQPM_CLI ,STR1.ID_AGT_MAJ_EQPM_CLI ,STR1.CD_CNL_DE_DSTRB_MAJ_EQPM_CLI ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CONSO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.ID_TECHN_CONSO_EQPM_CLI=CIR1.ID_TK_CONSO AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.FAM_PROD CIR2 ON ( STR1.CD_FAM_PROD_COMCIAL_EQPM_CLI=CIR2.CD_FAM_PROD AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) AND CIR2.CD_BQE=99900)
HABITA                                            SELECT STR1.CD_EDS_BNQ , STR1.IDLOGE IDLOGE_BYTE , CAST(COALESCE(TCO1.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDLOGE , STR1.IDPART , STR1.CDSLOG , CAST(STR1.CDSLOG as CHAR(2)) AS CDSLOG_CHAR , COALESCE(STR1.CTYLOG,'99') AS CTYLOG , STR1.DAOCC1 , CAST(STR1.DAOCC1 AS CHAR(6) ) AS DAOCC1_CHAR , STR1.CRESEC , STR1.CRELOC , STR1.DDMOD , STR1.CDOMJ , STR1.MTBIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(TCO1.ID_DWR,0) ID_DWR_LGT , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_OCC_LGT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CDSLOG = CIR2.CD_OCC_LGT) LEFT JOIN %SOC%.TYP_LGT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CTYLOG = CIR3.CT_LGT) LEFT JOIN %TCO%.ID_LGT_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDLOGE = TCO1.BY_SOURCE1)
TDSSOL                                            SELECT STR1.CD_EDS_BNQ , STR1.NCPTE , STR1.MSOAR , STR1.DTARR , STR1.MSOCOC , STR1.DTSCC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTE=CIR1.NU_CPTE)
T1R49C                                            SELECT STR1.CD_EDS_BNQ , STR1.CDPCSP , CAST(CAST(CAST(STR1.CDPCSP AS format 'Z(I)') AS Format '9(2)' ) AS CHAR(2)) AS CDPCSP_CH , STR1.IDPART , STR1.CDPPPS , STR1.DELIEN , STR1.DFLIEN , STR1.DADVAL , STR1.TYCONT , STR1.DFPERL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1)
TYP_ORGAN_GARANT_RISQ_CST                         SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
T1R31                                             SELECT STR1.CD_EDS_BNQ , STR1.IDENTR IDENTR_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDENTR) end AS VARCHAR(30)) AS IDENTR , STR1.IDPART , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_ENTR , COALESCE(CIR2.ID_DWR,0) ID_DWR_ETS , COALESCE(CIR3.ID_DWR,0) ID_DWR_PART , COALESCE(CIR4.CQLCCP,' ') CQLCCP , COALESCE(CIR4.CQLCCr,' ') CQLCCR , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_ENTR_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDENTR = CIR1.BY_SOURCE1 ) LEFT JOIN %TCO%.ID_ETS_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPART = CIR2.ID_SOURCE1 ) LEFT JOIN %TCO%.ID_PART_TCO CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.IDPART = CIR3.ID_SOURCE1 ) LEFT JOIN %DE1%.DTWHNLIE CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_EDS_BNQ AND CIR4.CDTABO = 'T1R31'AND CIR4.TK_ACTION IN('I','U'))
FREMLO04                                          SELECT STR1.CD_EDS_BNQ , STR1.CDZDF , STR1.CDZIF , STR1.CDANU , STR1.DCARR1 , STR1.IOFFR8 , STR1.NUMCR4 , STR1.IDEXEH , STR1.IDEXEC , STR1.NUCOT1 , STR1.IDGRS , STR1.NUSEQX , STR1.CDPROD , STR1.CTDT , STR1.NUSEQ3 , STR1.CDENR , STR1.CDMODA , STR1.MTVIE2 , STR1.MSCNT4 , STR1.MSCNT5 , STR1.MSCNT6 , STR1.MKCAQ2 , STR1.MICAPA , STR1.MRPRIB , STR1.MIBRP , STR1.MICALY , STR1.MRPRI6 , STR1.MRPRIA , STR1.DASOU1 , STR1.DHECH4 , STR1.DFCLO , STR1.COPFTC , STR1.CDDIV , STR1.PECONC , STR1.CUECT1 , STR1.CDFIT5 , STR1.FILLER_2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NUCOT1=CIR1.NU_CPTE)
UNICA_3C                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.IDPRG , STR1.IDECA1 , STR1.IDCPG2 , STR1.LICPG , STR1.LMCPG , STR1.LISTS , STR1.DDPRV0 , STR1.DFPRV0 , STR1.LIGRB , STR1.LISTA3 , STR1.IDCPG3 , STR1.LMCPG3 , STR1.DDCPG0 , STR1.DFCPG0 , STR1.LMOBJC , STR1.LMINIC , STR1.LISTSC , STR1.KFCPG0 , STR1.CTPRJC , STR1.LITYPP , STR1.CDOBJK , STR1.LIOBJ0 , STR1.CDPGMR , STR1.LIPGMR , STR1.LCCPG , STR1.CMARCH , STR1.IDSEC1 , STR1.CDDOM6 , STR1.CDSDOM , STR1.CDMED4 , STR1.LIMEDI , STR1.CTCPGU , STR1.LTYPO , STR1.CTEVTU , STR1.LITYPE , STR1.CTEXEC , STR1.LITEXE , STR1.CBMOP , STR1.CBPREI , STR1.CFEXE , STR1.LIFEXE , STR1.LMFEXE , STR1.CBAOPT , STR1.CBISMC , STR1.IDCPGC , STR1.CQTRA0 , STR1.LITRAV , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
REF_ICS                                           SELECT STR1.CD_EDS_BNQ , STR1.CD_ENREG , STR1.ID_ICS , STR1.LI_ICS , STR1.LI_COM_ICS , STR1.LI_PREN , STR1.CD_ETAT_ICS , STR1.CD_JUR_ICD , STR1.LI_ADR , STR1.CD_POST , STR1.LI_VILLE , STR1.CD_SIREN , STR1.CD_NAF_APE , STR1.DD_VAL , STR1.DD_MAJ_ICS , STR1.DF_VAL , STR1.ID_NNE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
C3RE02                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELP , STR1.IDPRD , STR1.IDETC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_ELT_PATRIM , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_ELT_PATRIM_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND CAST(CAST(STR1.IDELP as format 'Z(I)') as VARCHAR(9)) = TCO1.ID_SOURCE1) LEFT JOIN %DE1%.PROCON CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPRD=CIR1.IDPRD AND CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.CONCUR CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDETC=CIR2.IDETC AND CIR1.TK_ACTION IN ('I','U'))
DESCOM                                            SELECT STR1.CD_EDS_BNQ , STR1.IDNUPA IDNUPA_BYTE , CAST(substr(COALESCE(TCO1.ID_SOURCE1,''),4,30) AS VARCHAR(30)) AS IDNUPA , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.CDNPAI , STR1.DDNPA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.DELIEN AS DELIEN_T5R02 , CIR1.DFLIEN AS DFLIEN_T5R02 , CAST(COALESCE(%PMU%.Bin2Char(CIR1a.IDADRE),' ') AS VARCHAR(30)) AS IDADRE_T5R09 , CIR1a.DELIEN AS DELIEN_T5R09 , CIR1a.DFLIEN AS DFLIEN_T5R09 , Coalesce(CAST(CIR1a.CDPAYS as INTEGER),0) CDPAYS , CAST(COALESCE(%PMU%.Bin2Char(CIR1b.IDADRE),' ') AS VARCHAR(30)) AS IDADRE_LOCALI , CIR1b.LIGAD3 LIGAD3 , CIR1b.LIGAD4 LIGAD4 , CIR1b.LIGAD5 LIGAD5 , CIR1b.LIGAD6 LIGAD6 , CIR1b.DDVAL AS DDVAL_LOCALI , CIR1b.DFVAL AS DFVAL_LOCALI , CIR1b.HFVAL AS HFVAL_LOCALI , CAST(COALESCE(%PMU%.Bin2Char(CIR2a.IDINTS),' ') AS VARCHAR(30)) IDINTS_INTSPE , CIR2a.LILIG1 LILIG1_INTSPE , CIR2a.LILIG2 , CIR2a.DDVAL AS DDVAL_INTSPE , CIR2a.DFVAL AS DFVAL_INTSPE , CIR2a.HFVAL AS HFVAL_INTSPE , CIR2.DELIEN AS DELIEN_T5R03 , CIR2.DFLIEN AS DFLIEN_T5R03 , COALESCE(TCO1.ID_DWR,0) ID_DWR_COORD , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR1a.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1a , Case When CIR1b.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1b , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR2a.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2a , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , CIR3.ID_CD_PAYS , CAST(COALESCE(%PMU%.Bin2Char(CIR2.IDINTS),' ') AS VARCHAR(30)) IDINTS_T5R03 , CAST(COALESCE(%PMU%.Bin2Char(CIR2.IDNUPA),' ') AS VARCHAR(30)) IDNUPA_T5R03 , CAST(COALESCE(%PMU%.Bin2Char(CIR1.IDADRE),' ') AS VARCHAR(30)) AS IDADRE_T5R02 , CAST(COALESCE(%PMU%.Bin2Char(CIR1.IDNUPA),' ') AS VARCHAR(30)) AS IDNUPA_T5R02 FROM %DTA%.DESCOM STR1 LEFT JOIN %DE1%.T5R02 CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDNUPA=CIR1.IDNUPA AND STR1.DT_ELIG <= CIR1.DFLIEN AND CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.T5R09 CIR1a ON (CIR1.CD_EDS_BNQ = CIR1a.CD_EDS_BNQ AND CIR1.IDADRE=CIR1a.IDADRE AND STR1.DT_ELIG <= CIR1a.DFLIEN AND CIR1a.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.LOCALI CIR1b ON (CIR1.CD_EDS_BNQ = CIR1b.CD_EDS_BNQ AND CIR1.IDADRE=CIR1b.IDADRE AND CIR1b.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.T5R03 CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDNUPA=CIR2.IDNUPA AND STR1.DT_ELIG <= CIR2.DFLIEN AND CIR2.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.INTSPE CIR2a ON (CIR2.CD_EDS_BNQ = CIR2a.CD_EDS_BNQ AND CIR2.IDINTS=CIR2a.IDINTS AND CIR2a.TK_ACTION IN ('I','U')) LEFT JOIN %SOC%.PAYS CIR3 ON (CIR1a.CD_EDS_BNQ = CIR3.CD_BQE AND CIR1a.CDPAYS = CAST(CIR3.ID_CD_PAYS as INTEGER)) LEFT JOIN %TCO%.ID_COORD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDNUPA=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,1,3)='ADR') WHERE 1=1 and STR1.DFVAL >= CAST(STR1.DT_ELIG as DATE) and COALESCE(Bin2Char(CIR1.IDADRE),' ') <> '000000000000000000000000000000'
REF_OFFRE                                         SELECT STR1.CD_EDS_BNQ , STR1.OFFRE_ID , STR1.OFFRE_CODE , STR1.OFFRE_LIBELLE , STR1.FAMILLE_OFFRE_ID , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_FAM_OFR_FIDEL CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.FAMILLE_OFFRE_ID=CIR1.ID_FAM_OFR_PRVE)
PARBATCH                                          SELECT STR1.CD_EDS_BNQ , STR1.DTMODS , STR1.DTCREA , STR1.DTMOD , STR1.IDUTIL , STR1.SBUTIL , STR1.CRABO1 , STR1.NOMMOD , STR1.NOMPAR , STR1.TYPPAR , STR1.DESPAR , STR1.VALNUM , STR1.VALCAR , STR1.CRABO2 , STR1.RE_CYCLE , STR1.DT_ELIG , CURRENT_TIMESTAMP(0) DD_HISTO , CURRENT_TIMESTAMP(0) DF_HISTO , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_TOP_MSTR_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
OFR_SEGM_MRCH_CIAL                                SELECT STR1.CD_EDS_BNQ , STR1.ID_OFR_BQR , STR1.ID_SEGM_CIAL , STR1.CD_PERTINENCE , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.ID_OFR_BQR is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.ID_SEGM_CIAL is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT ID_OFR_BQR FROM %SOC%.OFR ) CIR1 ON (STR1.ID_OFR_BQR=CIR1.ID_OFR_BQR) LEFT JOIN (Select DISTINCT ID_SEGM_CIAL FROM %SOC%.SEGM_MRCH_CIAL) CIR2 ON (STR1.ID_SEGM_CIAL=CIR2.ID_SEGM_CIAL) /*Proposition JMC LEFT JOIN (Select DISTINCT CD_BQE, ID_SEGM_CIAL FROM %SOC%.SEGM_MRCH_CIAL) CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.ID_SEGM_CIAL=CIR2.ID_SEGM_CIAL) */
BRUHMVO2                                          SELECT STR1.CD_EDS_BNQ , STR1.IDENCLE , STR1.CDOP2 , STR1.DBENVX , STR1.FILLER_2 , STR1.CDZDFM , STR1.CDZIFM , STR1.CMANOM , STR1.NUADHM , STR1.NUBURG , STR1.NCCONM , STR1.CDVALT , STR1.LNVALM , STR1.WVNOLN , STR1.CDFOVM , STR1.CSMVMM , STR1.WCTITM , STR1.DTRINM , STR1.DDVALM , STR1.LMZECM , STR1.CTBLSM , STR1.CTBLAM , STR1.DDSCRM , STR1.WNNETM , STR1.CCVLRM , STR1.CDPCON , STR1.CQMVTM , STR1.LCNATM , STR1.CDUQTM , STR1.CDLISM , STR1.NUDOSM , STR1.CDOSTM , STR1.CTMOSM , STR1.CDAMOM , STR1.CCPTFM , STR1.CPFET , STR1.REFAP , STR1.CDACD , STR1.CDPTO , STR1.CDOPN , STR1.CDACTB , STR1.CDBAN2 , STR1.NUCRLA , STR1.CDPAYE , STR1.CDPAYC , STR1.WBBRUM , STR1.WNNETA , STR1.DETIT1 , STR1.IDENFI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCCONM=CIR1.NU_CPTE)
SIPAEC                                            SELECT STR1.CD_EDS_BNQ ,STR1.IDSPEC IDSPEC_BYTE ,CAST(CASE WHEN TCO1.CD_EDS_BNQ IS NOT NULL THEN TCO1.ID_SOURCE1 ELSE %PMU%.Bin2Char(STR1.IDSPEC) END AS VARCHAR(30)) AS IDSPEC , STR1.MOSPEC , STR1.DDSPEC , STR1.DFSPEC , STR1.CDTELC , STR1.DTECHT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION ,Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Coalesce(TCO1.ID_DWR,0) ID_DWR_SITUA_PARTC_EDC , Coalesce(TCO2.ID_DWR,0) CT_DWR_SITUA_PARTC FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_SITUA_PARTC_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDSPEC = TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,1) = '3') LEFT JOIN %TCO%.ID_TYP_SITUA_PARTC_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND (STR1.CDTELC ||'3') = TCO2.ID_SOURCE1) LEFT JOIN %SOC%.TYP_SITUA_PARTC CIR1 ON (TCO2.CD_EDS_BNQ = CIR1.CD_BQE AND TCO2.ID_DWR = CIR1.CT_DWR_SITUA_PARTC AND CAST(CIR1.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) )
TYP_MTF_SORT_DFT_CST_1                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRA018                                            SELECT STR1.CD_EDS_BNQ ,STR1.IDELCO ,STR1.NUEVPR ,STR1.CDEVEN ,STR1.DATREV ,STR1.DVEVEN ,STR1.DAOPEV ,STR1.NUOPPR ,STR1.CDANEV ,STR1.DAANEV ,STR1.NUEMET ,STR1.NUMATR ,STR1.ZTEVER ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,CIR1.ID_DWR_AGT ,COALESCE (CIR4.DD_HISTO,CIR2.DD_HISTO) AS DD_HISTO_EDC ,COALESCE(CIR4.ID_DWR_EDC,CIR2.ID_DWR_EDC,0) ID_DWR_EDC ,CAST(CAST(CAST(STR1.NUMATR AS FORMAT 'Z(I)') AS FORMAT '9(5)') AS CHAR(7) ) as NUMATR_TX ,CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 ,CASE WHEN CIR4.CD_BQE IS NULL AND CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 ,CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 FROM %DTA%.GRA018 STR1 LEFT JOIN %SOC%.AGT CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CAST(CAST(CAST(STR1.NUMATR AS FORMAT 'Z(I)') AS FORMAT '9(5)') AS CHAR(7) )=CIR1.ID_AGT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CRED CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDELCO=CIR2.ID_EDC_CRED AND CIR2.TYP_SOURCE_CRED IN ('G', 'L') AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_EVT_CRED CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CDEVEN=CIR3.CD_EVT_CRED) LEFT JOIN ( SELECT DISTINCT ED.CD_BQE, ED.ID_EDC_CRED, ED.ID_DWR_EDC,PF.DD_HISTO,PF.DF_HISTO FROM %SOC%.PLFD_UTIL PF INNER JOIN %SOC%.ECD_DETENU ED ON PF.CD_BQE = ED.CD_BQE AND PF.ID_EDC_ECHCE = ED.ID_EDC_CRED ) CIR4 ON (CIR4.CD_BQE = STR1.CD_EDS_BNQ AND STR1.IDELCO = CIR4.ID_EDC_CRED AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) WHERE 1=1 AND STR1.CDEVEN IN (004, 041,321, 322,398)
T1R08P                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.IDELCO1 IDELCO1_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO1) end AS VARCHAR(30)) AS IDELCO1 , STR1.IDTREC , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC_E , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC_R , COALESCE(CIR3.CQLCCP,' ') CQLCCP , COALESCE(CIR3.CQLCCR,' ') CQLCCR , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDELCO = CIR1.BY_SOURCE1 AND SUBSTR(CIR1.ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDELCO1= CIR2.BY_SOURCE1 AND SUBSTR(CIR2.ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.IDTREC = CIR3.CDVAL9 AND CIR3.CDTABO='T1R08PXXIDTREC' AND CIR3.TK_ACTION IN ('I','U'))
UNICA_3D                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.IDCPG2 , STR1.IDECA1 , STR1.IDACTC , STR1.LNACTC , STR1.CBPOPT , STR1.LNPOPT , STR1.LISEGP , STR1.LNDIAG , STR1.DTEXEC , STR1.LIEXEC , STR1.NBRDEX ,CAST(STR1.LIDCIB AS VARCHAR(100)) , STR1.LNACT1 , STR1.LNACT2 , STR1.IDACTP , STR1.DDACT1 , STR1.DFACT1 , STR1.NOETP0 , STR1.PEOPRL , STR1.CTACTC , STR1.LIACN , STR1.LICACN , STR1.KFACT0 , STR1.CFEXE , STR1.LIFEXE , STR1.LMFEXE , STR1.CBACOP , STR1.CBCACA , STR1.IDCANA , STR1.IDTCN , STR1.IDMEST , STR1.IDARGU , STR1.CDTRTJ , STR1.NUCMP , STR1.IDEVT , STR1.CBMOP , STR1.CBICPT , STR1.CDOFFR , STR1.PEOBSE , STR1.PEDAFF , STR1.QPRME2 , STR1.CDREDA , STR1.MDOFF1 , STR1.MDFOF1 , STR1.MDEXE1 , STR1.MTMOY1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.PROJ_UNICA CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDCPG2 = CIR1.ID_CAMPGN_UNICA AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
GRA005                                            SELECT STR1.CD_EDS_BNQ ,STR1.GRA005_IDELCO ,STR1.NUECEL ,STR1.CTCEPR ,STR1.MTTHCE ,STR1.CPICCE ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,COALESCE(CIR2.ID_DWR_EDC,0) ID_DWR_EDC_ECD ,COALESCE(CIR3.ID_DWR_EDC,0) ID_DWR_EDC_CRED ,Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 ,Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_BQE, ID_EDC_ECHCE FROM %SOC%.PLFD_UTIL WHERE ID_EDC_ECHCE IS NOT NULL ) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.GRA005_IDELCO=CIR1.ID_EDC_ECHCE) LEFT JOIN (SELECT DISTINCT CD_BQE, ID_EDC_CRED,ID_DWR_EDC FROM %SOC%.ECD_DETENU WHERE ID_EDC_CRED IS NOT NULL )CIR2 ON (CIR1.CD_BQE=CIR2.CD_BQE AND CIR1.ID_EDC_ECHCE=CIR2.ID_EDC_CRED) LEFT JOIN (SELECT DISTINCT CD_BQE,ID_EDC_CRED,ID_DWR_EDC FROM %SOC%.CRED WHERE ID_EDC_CRED IS NOT NULL AND TYP_SOURCE_CRED = 'G' )CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.GRA005_IDELCO=CIR3.ID_EDC_CRED)
IARFKA1L                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.IDBANC , STR1.CDDOMI , STR1.CDPROD , STR1.CDBUR1 , STR1.LNMARI , STR1.LNPRUS , STR1.DNAISA , STR1.CDDRTF , STR1.NCPTPA , STR1.CBSOU1 , STR1.CBSOU2 , STR1.CBSOU3 , STR1.CBSOU , STR1.CBSOU4 , STR1.CBSOU5 , STR1.KA10_IDCTRT , STR1.KA10_CDBURO , STR1.KA10_CDVEND , STR1.KA10_NUIMAG , STR1.KA10_CDFOIC , STR1.KA10_CPEFAC , STR1.KA10_CDSICT , STR1.KA10_DEDIMC , STR1.KA10_DEFIMC , STR1.KA10_DEDAFN , STR1.KA10_DECHC1 , STR1.KA10_DPRECH , STR1.KA10_DRESC1 , STR1.KA10_MOTRS1 , STR1.KA10_KMRM , STR1.KA10_CDMTCO , STR1.KA10_CDITRF , STR1.KA10_MTITRF , STR1.KA10_CDDTRF , STR1.KA10_CDDTR1 , STR1.KA10_KMDTRF , STR1.KA10_MTTAXE , STR1.KA10_MTCOMA , STR1.KA10_MTCOTI , STR1.KA10_CDAPPT , STR1.KA10_CBREPD , STR1.KA10_DERSPR , STR1.KA10_CDMORP , STR1.KA10_DADERS , STR1.KA10_DACRE , STR1.KA10_CTDOJA , STR1.KA10_CTDOJB , STR1.KA10_CTDOJC , STR1.KA10_CTDOJD , STR1.KA10_CTDOJE , STR1.KA10_CTDOJF , STR1.KA10_CBINDG , STR1.KA10_KFSUR , STR1.KA10_CDTOP1 , STR1.KA10_CDTOP2 , STR1.KA10_IDPERC , STR1.KA10_CDETAX , STR1.KA10_CDGBD1 , STR1.KA10_NCPTDF , STR1.KA10_CLRIBP , STR1.KA10_CDETA5 , STR1.KA10_CDBGD3 , STR1.KA10_NCPTDG , STR1.KA10_CLRIBI , STR1.KA10_DHECH1 , STR1.KA10_DAPASS , STR1.KA10_MTAAB1 , STR1.KA10_CDGAM , STR1.KA10_CBPOP , STR1.KA10_CDPCO , STR1.KA10_CSSITU , STR1.KA10_DATSUP , STR1.KA10_CDTIM , STR1.KA10_MTDRG , STR1.KA10_DDECH3 , STR1.KA10_CDINIT , STR1.KA10_CDVOP1 , STR1.KA10_IDBAN7 , STR1.KA10_IDPERD , STR1.KA10_NOVER4 , STR1.KA10_IDRFIN , STR1.KA10_IDRFI1 , STR1.KA10_CDNTU , STR1.KA10_IDBAN9 , STR1.KA10_IDRFI2 , STR1.KA10_CDNTU1 , STR1.KA10_IDBANA , STR1.KA10_IDRFI3 , STR1.KA10_CDNTU2 , STR1.KA10_CDNTU3 , STR1.KA10_CQAEAG , STR1.KA10_CDORCO , STR1.KA10_CTSOU1 , STR1.KA09_CBHST , STR1.KA09_IDCTRT , STR1.KA09_CTPRS0 , STR1.KA09_NBMV2 , STR1.KA09_MFRAID , STR1.KA09_CMEDI , STR1.KA09_IDTYOQ , STR1.KA09_CDPRCT , STR1.KA10_ZB014 , STR1.KA1A_IDCTRT , STR1.KA1A_NUIMAG , STR1.KA1A_CBSOU1 , STR1.KA1A_DADESS , STR1.KA1A_CTSOU2 , STR1.KA1A_CDTOP , STR1.KA1A_IDCTRH , STR1.KA1A_DGAREF , STR1.KA1A_CDMOCC , STR1.KA1A_IDCTRG , STR1.KA10_DASIEM , STR1.KA10_CDTOP3 , STR1.KA1L_CDZTF0 , STR1.KA1L_NBAYD , STR1.KA1L_NBASS , STR1.KA1L_LNASS0 , STR1.KA1L_IDPERS , STR1.KA1L_NUIMA3 , STR1.KA1L_IDBAN3 , STR1.KA1L_CBRTAS , STR1.KA1L_CDSEXE , STR1.KA1L_DASTD0 , STR1.KA1L_CDRAF , STR1.KA1L_CORAF , STR1.KA1L_CDPCS6 , STR1.KA1L_KMRM2 , STR1.KA1L_CBCSPA , STR1.KA1L_IDPERA , STR1.KA1L_NUIMA1 , STR1.KA1L_IDBAN0 , STR1.KA1L_CBRTA1 , STR1.KA1L_CDSEXA , STR1.KA1L_DNAISS , STR1.KA1L_CDRAF1 , STR1.KA1L_CORA1 , STR1.KA1L_CDPCS9 , STR1.KA1L_KMRM0 , STR1.KA1L_CBCSP1 , STR1.KA1L_IDPERB , STR1.KA1L_NUIMA2 , STR1.KA1L_IDBAN1 , STR1.KA1L_CTRAT , STR1.KA1L_CCPAR , STR1.KA1L_CDSEXB , STR1.KA1L_DANAI4 , STR1.KA1L_KMRM1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_CTR_IARD , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.KA10_IDCTRT=TCO1.ID_SOURCE1)
BSN                                               SELECT STR1.CD_EDS_BNQ , STR1.CD_BSN , STR1.LI_BSN , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRCO_CREANCE                                      SELECT STR1.IDEXEY , STR1.IDELCH , STR1.DFCOLT , STR1.IDPOCE , STR1.IDPRET , STR1.DCARR7 , STR1.CTOPA7 , STR1.GRAPDE1 , STR1.GRAPDE2 , STR1.ICLAN , STR1.CODORI , STR1.CELICR , STR1.CDSTGO , STR1.CLACPO , STR1.CDPOB , STR1.CTRIS , STR1.MTPRV8 , STR1.MTPER1 , STR1.MTEXR2 , STR1.MTENCI , STR1.MTHENG , STR1.MPROK9 , STR1.MTPRV , STR1.DFFON0 , STR1.MPLIMB , STR1.MTDECD , STR1.MKUTP6 , STR1.MFRAE2 , STR1.MITOT4 , STR1.MKCAE4 , STR1.NBJORE , STR1.CTEVCR , STR1.CDARFR , STR1.CBNAEC , STR1.CQCRE4 , STR1.CBCNP5 FROM %BRL%.%ObjectNameFrom% STR1 INNER JOIN (SELECT COUNT(GRCO.CODORI) NB_CODORI, GRCO.DCARR7, GRCO.IDEXEY FROM %BRL%.%ObjectNameFrom% GRCO WHERE GRCO.CODORI in ('20', '21') AND GRCO.DCARR7 = '#FirstDayPreviousMonth#' AND GRCO.IDEXEY IN (#ListEntityToRun#) GROUP BY GRCO.DCARR7, GRCO.IDEXEY) CIR1 ON (STR1.DCARR7 = CIR1.DCARR7 AND STR1.IDEXEY = CIR1.IDEXEY)
EMEXS021                                          SELECT STR1.TK_ACTION , STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DACFLX , STR1.HECRE , STR1.CDTTML , STR1.IDPART , STR1.IDCTRX , STR1.IDELEX , STR1.IDPARZ , STR1.IDCPG2 , STR1.IDBTN , STR1.LIEMLS , STR1.ZB019A , STR1.CDOPMO , STR1.NBUNME , STR1.ZB019B , STR1.CDACK1 , STR1.ZB019C , STR1.CDACK2 , STR1.CBERQ , STR1.LIB100 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , Case When TCO3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO3 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , COALESCE(TCO1.ID_DWR,0) ID_DWR_PART , COALESCE(TCO2.ID_DWR,0) ID_DWR_CTR , COALESCE(TCO3.ID_DWR,0) ID_DWR_PART_COM , COALESCE(CIR2.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(CIR1.ID_CAMPGN_UNICA,0) ID_CAMPGN_UNICA FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDPART= TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.IDCTRX= TCO2.ID_SOURCE1 AND TRIM(STR1.IDCTRX) <> '') LEFT JOIN %TCO%.ID_PART_TCO TCO3 ON (STR1.CD_EDS_BNQ = TCO3.CD_EDS_BNQ AND STR1.IDPARZ= TCO3.ID_SOURCE1) LEFT JOIN %SOC%.PROJ_UNICA CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDCPG2=CIR1.ID_CAMPGN_UNICA AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ECD_DETENU CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.IDELEX= CIR2.ID_EDC_EXT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) AND TRIM(STR1.IDELEX) <> '')
EXCTEMA2                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(TCO1.ID_SOURCE1 as VARCHAR(30)) IDELCO , STR1.IDCTRA IDCTRA_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCTRA) AS VARCHAR(30)) AS IDCTRA , STR1.IDCLI1 , STR1.IDPACO , STR1.DDFONC , STR1.DFFONC , STR1.DASTD , STR1.MKRDR , STR1.MKRDT , STR1.NBERE0 , STR1.MTECF4 , STR1.MTRNO1 , STR1.MTRAN2 , STR1.MTECH4 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) AS ID_DWR_EDC_TCO1 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND substr(TCO1.ID_SOURCE1, character(TCO1.ID_SOURCE1)-2)='ECD') INNER JOIN %SOC%.CRED CIR1 ON (CIR1.CD_BQE=TCO1.CD_EDS_BNQ AND TCO1.ID_DWR=CIR1.ID_DWR_EDC AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
ELSTJOUV                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDJOUV , STR1.LIJOUV , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRA093                                            SELECT STR1.CD_EDS_BNQ ,STR1.IDELCO ,STR1.CTRESS ,STR1.NCPRRE ,STR1.DDAREC ,STR1.DFAREC ,STR1.MTRETH ,STR1.QQRPR3 ,STR1.CDAREC ,STR1.ZTEVER ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,COALESCE(CIR3.ID_DWR_EDC,CIR1.ID_DWR_EDC,0) AS ID_DWR_EDC ,COALESCE (CIR3.DD_HISTO,CIR1.DD_HISTO) AS DD_HISTO_EDC ,CASE WHEN CIR1.CD_BQE IS NULL AND CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 ,CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 FROM %DTA%.GRA093 STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELCO=CIR1.ID_EDC_CRED AND CIR1.TYP_SOURCE_CRED IN ('G', 'L') AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_TYP_RESS CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CTRESS=CIR2.CT_PRESS AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN ( SELECT DISTINCT ED.CD_BQE, ED.ID_EDC_CRED, ED.ID_DWR_EDC,PF.DD_HISTO,PF.DF_HISTO FROM %SOC%.PLFD_UTIL PF INNER JOIN %SOC%.ECD_DETENU ED ON PF.CD_BQE = ED.CD_BQE AND PF.ID_EDC_ECHCE = ED.ID_EDC_CRED ) CIR3 ON (CIR3.CD_BQE = STR1.CD_EDS_BNQ AND STR1.IDELCO=CIR3.ID_EDC_CRED AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
T6R05                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDINPA IDINPA_BYTE , CAST(Case When TCO1.CD_EDS_BNQ is not null then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDINPA) End AS VARCHAR(30)) IDINPA , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_EVT , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(TCO2.ID_DWR,0) ID_DWR_SITUA_PARTC , CIR2.ITSPPA ITSPPA , COALESCE(CIR3.ID_DWR_TYP_EVT,0) ID_DWR_TYP_EVT FROM %DTA%.T6R05 STR1 LEFT JOIN %TCO%.ID_EVT_TCO TCO1 ON(STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDINPA=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,1)='2') LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_SITUA_PARTC_TCO TCO2 ON(STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDINPA=TCO2.BY_SOURCE1 AND SUBSTR(TCO2.ID_SOURCE1,31,1)='2') LEFT JOIN %DE1%.INCPAR CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDINPA=CIR2.IDINPA AND CIR2.TK_ACTION IN ('I','U')) LEFT JOIN %SOC%.TYP_EVT CIR3 ON(CIR2.CD_EDS_BNQ=CIR3.CD_BQE AND CIR2.ITSPPA=CIR3.CT_EVT AND CIR3.CD_REGRP_EVT=2 AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
TYP_CATG_PRNCP_GRP_CST                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
IARFKA20                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.NCPTPA , STR1.KA2A_IDDEVS , STR1.KA2A_CDETDE , STR1.KA2A_DEDDEV , STR1.KA2A_DEFDEV , STR1.KA2A_DRESC1 , STR1.KA2A_KMRM , STR1.KA2A_CDMTCO , STR1.KA2A_CDORCO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPACO=CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_DOMN_IARD CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CDDOMI=CIR2.CD_DOMN_IARD) LEFT JOIN %SOC%.PROD_PACIFICA_PROD_CIAL CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CDPROD=CIR3.CD_PROD_ASSU_IARD AND CAST (CIR3.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
TYP_BAR_FACTN_CST                                 SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRCO_COMPL_DEGRA                                  SELECT STR1.IDEXEY , STR1.DFCOLT , STR1.IDELCH , STR1.IDPRET , STR1.CIDENV , STR1.IDCAI6 , STR1.IDCAI8 , STR1.CADEVI , STR1.CDMONT , STR1.MTRACO , STR1.NOPPCI , STR1.NOPCCA , STR1.NOPPCO , STR1.CDNATG , STR1.CDNATH , STR1.CDNATF , STR1.CLACPO , STR1.CDING1 , STR1.CBPCO1 , STR1.CBPCO2 , STR1.CDPAYT , STR1.DCARR7 , STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
T1R18P                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.IDCOSE IDCOSE_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCOSE) end AS VARCHAR(30)) AS IDCOSE , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC_E , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC_R , COALESCE(CIR3.CQLCCP,' ') CQLCCP , COALESCE(CIR3.CQLCCR,' ') CQLCCR , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDELCO= CIR1.BY_SOURCE1 AND SUBSTR(CIR1.ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDCOSE= CIR2.BY_SOURCE1 AND SUBSTR(CIR2.ID_SOURCE1,31,3) = 'SCE') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND CIR3.CDTABO='T1R18P' AND CIR3.TK_ACTION IN ('I','U'))
CRMCAPCA                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , COALESCE(CIR1.ID_CNL, '-1') IDCANA , STR1.IDWO , STR1.QPICNA , STR1.QPXCNA , STR1.QPXMCJ , STR1.QPXMCP , STR1.DDVALA , STR1.DADMAA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR_FNCTN,-1) ID_DWR_FNCTN , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CNL CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND Trim(leading '0' from STR1.IDCANA)=CIR1.ID_CNL AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.FNCTN CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDWO=CAST(CIR2.ID_FNCTN AS CHAR(4)) AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
ELSTPLGH                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDELST , STR1.IDJOUV , STR1.IDPOUV , STR1.DELIEN , STR1.DFLIEN , STR1.IDTYH , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDS , COALESCE(CIR4.ID_EXT_EDS,0) ID_EXT_EDS , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR3 , Case WHEN CIR4.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 Left JOIN %TCO%.ID_EDS_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDELST=CIR1.ID_SOURCE1) Left JOIN %DE1%.ELSTPOUV CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDPOUV=CIR2.IDPOUV and CIR2.TK_ACTION IN ('I','U') ) Left JOIN %DE1%.ELSTJOUV CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.IDJOUV=CIR3.IDJOUV and CIR3.TK_ACTION IN ('I','U') ) Left JOIN %SOC%.ELT_DE_STRUCT CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE and STR1.IDELST=CIR4.ID_EDS and CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
C2R15                                             SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IFONCN , STR1.IPOSTF , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PST_FNCT , COALESCE(CIR2.ID_DWR,0) ID_DWR_FNCTN , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PST_FNCT_TCO CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IPOSTF = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_FNCTN_TCO CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IFONCN = CIR2.ID_SOURCE1)
TYP_CT_ECHCE_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
USG_FAM                                           SELECT STR1.CD_EDS_BNQ , STR1.CD_USG_FAM , STR1.LI_USG_FAM , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
OPENPF                                            SELECT STR1.CD_EDS_BNQ , STR1.IPART1 , STR1.NUPLA1 , STR1.CTPLAN , STR1.DDPLA1 , STR1.DURPL1 , STR1.CTMENS , STR1.TXIAH1 , STR1.MTMEN1 , STR1.MTNEC1 , STR1.MTEIF1 , STR1.MTEIK1 , STR1.DADMAJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC, 0) ID_DWR_EDC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CAST(CAST(CAST(STR1.IPART1 AS format 'Z(I)') AS format '9(11)') AS CHAR(11)) = CIR1.ID_EDC_CRED AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) AND CIR1.TYP_SOURCE_CRED = 'S' AND CIR1.ID_EDC_CRED IS NOT NULL) LEFT JOIN (SELECT DISTINCT CD_EDS_BNQ, IPART1 FROM %DE1%.OPENEL WHERE TK_ACTION in ('I', 'U')) CIR2 ON (CIR2.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR2.IPART1=STR1.IPART1)
DOFXSAVJ                                          SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.DACST2 , STR1.CDCFRA , TRIM(SUBSTR(STR1.IAGENT , 3,5)) AS IAGENT1 , STR1.IAGENT , STR1.IDOPFD , STR1.CDNOP1 , STR1.CDOPE1 , STR1.MEANTI , STR1.DOOPFI , STR1.NUCPSW , STR1.LIB20 , STR1.CDPIDE , STR1.IDPII1 , STR1.DACCP , STR1.LICOMA , STR1.LNCLI2 , STR1.LNCORR , STR1.DANAI4 , STR1.AINLIB , STR1.AIADN2 , STR1.CPCSES , STR1.CTPART , STR1.LINAPP , STR1.LICOE , STR1.CDORFD , STR1.LIB100 , STR1.CTDOJ , STR1.CDDESF , STR1.LIB101 , STR1.CDCONN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR3.ID_DWR_AGT,0) ID_DWR_AGT , COALESCE(CIR10.ID_DWR_EDS,0) ID_DWR_EDS , CIR10.ID_TYP_EDS , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR5 , CASE WHEN CIR6.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR6 , CASE WHEN CIR7.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR7 , CASE WHEN CIR8.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR8 , CASE WHEN CIR9.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR9 , CASE WHEN CIR10.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR10 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_CSP CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CPCSES = TRIM(CIR1.CD_CSP) AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_PART CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CTPART = CIR2.CT_PART AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.AGT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND TRIM(SUBSTR(STR1.IAGENT ,3,5)) = TRIM(SUBSTR(CIR3.ID_AGT ,1,5))) LEFT JOIN %SOC%.TYP_PCE_IDENT CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CDPIDE = CIR4.CT_PCE_IDENT AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CPTE CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE AND STR1.NUCPSW = CAST(CIR5.NU_CPTE as decimal(11)) AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_DESTN_FONDS CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_BQE AND STR1.CDDESF = CIR6.CD_DESTN_FONDS AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_JUSTIF CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_BQE AND STR1.CTDOJ = CIR7.CD_JUSTIF AND CAST(CIR7.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR7.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_NATU_OPERN_LAB CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_BQE AND STR1.CDNOP1 = CIR8.CD_NATU_OPERN_LAB AND CAST(CIR8.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR8.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_NATU_ORIG_FONDS CIR9 ON (STR1.CD_EDS_BNQ=CIR9.CD_BQE AND STR1.CDORFD = CIR9.CD_NATU_ORIG_FONDS AND CAST(CIR9.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR9.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR10 ON (STR1.CD_EDS_BNQ=CIR10.CD_BQE AND CAST(STR1.CDCFRA as integer)= CIR10.ID_EXT_EDS AND CAST(CIR10.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR10.DF_HISTO AS DATE) and cir10.dd_valid <> cir10.df_valid)
T6R15                                             SELECT STR1.CD_EDS_BNQ , STR1.IDMESA IDMESA_BYTE , CAST(Case When TCO1.CD_EDS_BNQ is not null then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDMESA) End AS VARCHAR(30)) IDMESA , STR1.IDCTRA IDCTRA_BYTE , CAST(Case When CIR1.ID_SOURCE1 is not null then CIR1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDCTRA) End AS VARCHAR(30))IDCTRA , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_EVT , COALESCE(CIR1.ID_DWR,0) ID_DWR_CTR , CIR2.IDTYMS as IDTYMS , COALESCE(CIR3.ID_DWR_TYP_EVT,0) ID_DWR_TYP_EVT FROM %DTA%.T6R15 STR1 LEFT JOIN %TCO%.ID_EVT_TCO TCO1 ON(STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDMESA=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,1)='4') LEFT JOIN %TCO%.ID_CTR_TCO CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDCTRA=CIR1.BY_SOURCE1) LEFT JOIN %DE1%.MESAUV CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDMESA=CIR2.IDMESA AND CIR2.TK_ACTION IN ('I','U')) LEFT JOIN %SOC%.TYP_EVT CIR3 ON(CIR2.CD_EDS_BNQ=CIR3.CD_BQE AND CIR2.IDTYMS=CIR3.CT_EVT AND CIR3.CD_REGRP_EVT=4 AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
STATSAFROID                                       SELECT STR1.CD_EDS_BNQ , STR1.CDMAT , STR1.IDTECH , STR1.TYPSDA , STR1.IDEDS , STR1.IDSAV , STR1.MATAGENT , STR1.CODEPF , STR1.NOSDA , STR1.TRHORA , STR1.DATMES , STR1.STATVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR11.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE is NULL THEN 0 ELSE 1 END Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR5 , CASE WHEN CIR6.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR6 , CASE WHEN CIR8.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR8 , CIR11.ID_DWR_EDS , CIR2.CD_TRCH_HOR , CIR3.ID_DWR AS ID_DWR_AGT , CIR4.ID_DWR_PST_FNCT , CIR4.DD_HISTO AS DD_HISTO_PST_FNCT , CIR5.ID_DWR_EDS AS ID_DWR_EDS_PST_FNCT , CIR6.ID_DWR_FNCTN , CIR7.NB_APPL_DCROCH_LGN_AGNC_EDS AS NB_AGC , CIR0.NB_ACCS_AUTRE_CPTE , CIR0.NB_ACCS_CNSLTATN_ENCRS_CART , CIR0.NB_ACCS_CNSLTATN_OPERN_CART , CIR0.NB_ACCS_CNSLTATN_OPERN_CRDTR , CIR0.NB_ACCS_CNSLTATN_OPERN_DBTR , CIR0.NB_ACCS_CNSLTATN_SLD , CIR0.NB_ACCS_MODIF_CD_SECRET , CIR0.NB_APPL_RECU_FVERT , CIR0.NB_APPL_RECU_FVERT_AVI , CIR0.NB_IDTN_CNVRSATN , CIR0.NB_IDTN_ECHOUEE_FVERT , CIR0.NB_IDTN_REUSSIE_CNVRSATN , CIR0.NB_IDTN_REUSSIE_FVERT , CIR0.NB_APPL_AGNC , CIR0.NB_APPL_TR_1ERE_SOLCITATN , CIR0.NB_APPL_TR_2EME_SOLCITATN , CIR0.NB_APPL_TR_3EME_SOLCITATN , CIR0.NB_APPL_TR_4EME_SOLCITATN , CIR0.NB_APPL_DISSUADE_SECRS , CIR0.NB_APPL_VERS_SECRS_SAV , CIR0.NB_APPL_VERS_SECRS_AVI_CCM , CIR0.NB_APPL_VERS_SECRS_FVERT , CIR0.NB_APPL_VERS_SECRS_LNTL , CIR0.NB_APPL_RECU_AVI_CCM , CIR0.NB_APPL_RECU_DEPUIS_AVI_FVERT , CIR0.NB_APPL_RECU_DEPUIS_AVI_AGNC , CIR0.NB_IDTN_REUSSIE_AVI_CCM , CIR0.NB_IDTN_ECHOUEE_AVI_CCM , CIR0.NB_APPL_DIRIGE_CCM , CIR0.NB_APPL_AVI_CCM_DIRIGE_AGNC , CIR0.NB_ACCS_FVERT_VIREMT , CIR0.NB_ACCS_FVERT_CNSLTATN_SLD , CIR0.NB_ACCS_FVERT_OPERN_CRDTR , CIR0.NB_ACCS_FVERT_OPERN_DBTR , CIR0.NB_ACCS_FVERT_ENCRS_CART , CIR0.NB_ACCS_FVERT_OPERATIONS_CART , CIR0.NB_ACCS_FVERT_DMND_RAPPEL_AGT , CIR0.NB_ACCS_FVERT_MODIF_CD_SECRET , CIR0.NB_ACCS_FVERT_SOS , CIR0.NB_APPL_RECU_AGNC , CIR0.NB_APPL_RECU_AGNC_INTRN , CIR0.NB_APPL_RECU_AGNC_EXT , CIR0.NB_APPL_MEVO_AGNC , CIR0.NB_APPL_DISSUADE , CIR0.NB_APPL_MULTIPLE , CIR0.NB_DMND_AGNC , CIR0.NB_APPL_IN_AUTRE_EDS , CIR0.NB_APPL_OUT_AUTRE_EDS , CIR0.NB_APPL_DIRIGE_AGNC , CIR0.NB_DMND_RECU_ARC , CIR0.NB_APPL_DIRIGE_SECOURS , CIR0.NB_CHOIX_AGNC , CIR0.NB_CHOIX_FVERT , CIR0.NB_CHOIX_HOR , CIR0.NB_CHOIX_CCM , CIR0.NB_CHOIX_OPPO , CIR0.DUR_TOT_MISE_REL , CIRAGT.NB_APPL_PRESTE_AGT , CIRAGT.NB_APPL_DCROCH_AGT , CIRAGT.NB_APPL_TR_AGT , CIRAGT.NB_TOT_DCROCH_AGT , CIRAGT.NB_RENVOI_GSM , CIRAGT.NB_APPL_RECU_AGT , CIRAGT.NB_APPL_RECU_AGT_INTRN , CIRAGT.NB_APPL_RECU_AGT_EXT , CIRAGT.NB_APPL_PRESTE_LGN_AGT , CIRAGT.NB_APPL_PRESTE_LGN_AGNC , CIRAGT.NB_APPL_PRESTE_LGN_AGT_INTRN , CIRAGT.NB_APPL_PRESTE_LGN_AGNC_INTRN , CIRAGT.NB_APPL_PRESTE_LGN_AGNC_EXT , CIRAGT.NB_APPL_PRESTE_LGN_AGT_EXT , CIRAGT.NB_APPL_TRSF_LGN_AGT , CIRAGT.NB_APPL_INTRCPT_LGN_AGT , CIRAGT.NB_APPL_TRSF_LGN_AGNC , CIRAGT.NB_APPL_INTRCPT_LGN_AGNC , CIRAGT.NB_SOLCITATN_PRVNC_LGN_AGT , CIRAGT.NB_SOLCITATN_PRVNC_LGN_AGNC , CIRAGT.NB_APPL_MEVO_LGN_AGT , CIRAGT.NB_APPL_TR_LGN_AGNC , CIRAGT.NB_APPL_TR_MOINS_20S , CIRAGT.NB_APPL_TR_MOINS_90S , CIRAGT.NB_APPL_DCROCH_LGN_AGNC_EDS , CIRAGT.NB_APPL_DCROCH_LGN_AGT , CIRAGT.DUR_APPL_IN_AGT , CIRAGT.DUR_APPL_OUT_AGT , CIRAGT.MOYN_SONNERIE_DCROCH , CIRAGT.NB_APPL_OUT_AGT , CIRAGT.NB_APPL_TR_LGN_AGT , CIRSAV.NB_APPL_RECU_SAV , CIRSAV.NB_APPL_RECU_HNO_SAV , CIRSAV.NB_APPL_MULTIPLE_SAV , CIRSAV.NB_APPL_PRESTE_SAV , CIRSAV.NB_SOLCITATN_SAV , CIRSAV.NB_APPL_DECROCHE_SAV , CIRSAV.NB_APPL_MEVO_SAV , CIRSAV.DUR_TOT_APPL_SAV , CIRSAV.NB_APPL_DISSUADE_SAV FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN ( SELECT STR1.CD_EDS_BNQ , COALESCE(STR1.CDMAT,'N') AS CDMAT_VAL , STR1.TYPSDA , COALESCE(STR1.IDEDS,'-1') AS IDEDS_VAL , STR1.TRHORA , STR1.DATMES , COALESCE(STR1.NOSDA,' ') AS NOSDA_VAL ,MAXIMUM ( CASE WHEN STR1.IDTECH = '205' THEN STR1.STATVAL ELSE NULL END) NB_ACCS_AUTRE_CPTE ,MAXIMUM ( CASE WHEN STR1.IDTECH = '209' THEN STR1.STATVAL ELSE NULL END) NB_ACCS_CNSLTATN_ENCRS_CART ,MAXIMUM ( CASE WHEN STR1.IDTECH = '210' THEN STR1.STATVAL ELSE NULL END) NB_ACCS_CNSLTATN_OPERN_CART ,MAXIMUM ( CASE WHEN STR1.IDTECH = '207' THEN STR1.STATVAL ELSE NULL END) NB_ACCS_CNSLTATN_OPERN_CRDTR ,MAXIMUM ( CASE WHEN STR1.IDTECH = '208' THEN STR1.STATVAL ELSE NULL END) NB_ACCS_CNSLTATN_OPERN_DBTR ,MAXIMUM ( CASE WHEN STR1.IDTECH = '206' THEN STR1.STATVAL ELSE NULL END) NB_ACCS_CNSLTATN_SLD ,MAXIMUM ( CASE WHEN STR1.IDTECH = '211' THEN STR1.STATVAL ELSE NULL END) NB_ACCS_MODIF_CD_SECRET ,MAXIMUM ( CASE WHEN STR1.IDTECH = '201' THEN STR1.STATVAL ELSE NULL END) NB_APPL_RECU_FVERT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '202' THEN STR1.STATVAL ELSE NULL END) NB_APPL_RECU_FVERT_AVI ,MAXIMUM ( CASE WHEN STR1.IDTECH = '212' THEN STR1.STATVAL ELSE NULL END) NB_IDTN_CNVRSATN ,MAXIMUM ( CASE WHEN STR1.IDTECH = '204' THEN STR1.STATVAL ELSE NULL END) NB_IDTN_ECHOUEE_FVERT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '213' THEN STR1.STATVAL ELSE NULL END) NB_IDTN_REUSSIE_CNVRSATN ,MAXIMUM ( CASE WHEN STR1.IDTECH = '203' THEN STR1.STATVAL ELSE NULL END) NB_IDTN_REUSSIE_FVERT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '601' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_AGNC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '602' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_1ERE_SOLCITATN ,MAXIMUM ( CASE WHEN STR1.IDTECH = '603' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_2EME_SOLCITATN ,MAXIMUM ( CASE WHEN STR1.IDTECH = '604' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_3EME_SOLCITATN ,MAXIMUM ( CASE WHEN STR1.IDTECH = '605' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_4EME_SOLCITATN ,MAXIMUM ( CASE WHEN STR1.IDTECH = '606' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_DISSUADE_SECRS ,MAXIMUM ( CASE WHEN STR1.IDTECH = '607' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_VERS_SECRS_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '608' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_VERS_SECRS_AVI_CCM ,MAXIMUM ( CASE WHEN STR1.IDTECH = '609' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_VERS_SECRS_FVERT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '610' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_VERS_SECRS_LNTL ,MAXIMUM ( CASE WHEN STR1.IDTECH = '301' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_AVI_CCM ,MAXIMUM ( CASE WHEN STR1.IDTECH = '302' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_DEPUIS_AVI_FVERT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '303' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_DEPUIS_AVI_AGNC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '304' THEN STR1.STATVAL ELSE NULL END ) NB_IDTN_REUSSIE_AVI_CCM ,MAXIMUM ( CASE WHEN STR1.IDTECH = '305' THEN STR1.STATVAL ELSE NULL END ) NB_IDTN_ECHOUEE_AVI_CCM ,MAXIMUM ( CASE WHEN STR1.IDTECH = '306' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_DIRIGE_CCM ,MAXIMUM ( CASE WHEN STR1.IDTECH = '307' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_AVI_CCM_DIRIGE_AGNC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '308' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_VIREMT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '309' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_CNSLTATN_SLD ,MAXIMUM ( CASE WHEN STR1.IDTECH = '310' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_OPERN_CRDTR ,MAXIMUM ( CASE WHEN STR1.IDTECH = '311' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_OPERN_DBTR ,MAXIMUM ( CASE WHEN STR1.IDTECH = '312' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_ENCRS_CART ,MAXIMUM ( CASE WHEN STR1.IDTECH = '313' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_OPERATIONS_CART ,MAXIMUM ( CASE WHEN STR1.IDTECH = '314' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_DMND_RAPPEL_AGT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '315' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_MODIF_CD_SECRET ,MAXIMUM ( CASE WHEN STR1.IDTECH = '316' THEN STR1.STATVAL ELSE NULL END ) NB_ACCS_FVERT_SOS ,MAXIMUM ( CASE WHEN STR1.IDTECH = '101' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_AGNC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '102' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_AGNC_INTRN ,MAXIMUM ( CASE WHEN STR1.IDTECH = '103' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_AGNC_EXT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '104' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_MEVO_AGNC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '105' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_DISSUADE ,MAXIMUM ( CASE WHEN STR1.IDTECH = '106' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_MULTIPLE ,MAXIMUM ( CASE WHEN STR1.IDTECH = '107' THEN STR1.STATVAL ELSE NULL END ) NB_DMND_AGNC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '108' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_IN_AUTRE_EDS ,MAXIMUM ( CASE WHEN STR1.IDTECH = '109' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_OUT_AUTRE_EDS ,MAXIMUM ( CASE WHEN STR1.IDTECH = '110' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_DIRIGE_AGNC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '111' THEN STR1.STATVAL ELSE NULL END ) NB_DMND_RECU_ARC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '112' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_DIRIGE_SECOURS ,MAXIMUM ( CASE WHEN STR1.IDTECH = '113' THEN STR1.STATVAL ELSE NULL END ) NB_CHOIX_AGNC ,MAXIMUM ( CASE WHEN STR1.IDTECH = '114' THEN STR1.STATVAL ELSE NULL END ) NB_CHOIX_FVERT ,MAXIMUM ( CASE WHEN STR1.IDTECH = '115' THEN STR1.STATVAL ELSE NULL END ) NB_CHOIX_HOR ,MAXIMUM ( CASE WHEN STR1.IDTECH = '116' THEN STR1.STATVAL ELSE NULL END ) NB_CHOIX_CCM ,MAXIMUM ( CASE WHEN STR1.IDTECH = '117' THEN STR1.STATVAL ELSE NULL END ) NB_CHOIX_OPPO ,MAXIMUM ( CASE WHEN STR1.IDTECH = '118' THEN STR1.STATVAL ELSE NULL END ) DUR_TOT_MISE_REL FROM %DTA%.STATSAFROID STR1 GROUP BY STR1.CD_EDS_BNQ , CDMAT_VAL , STR1.TYPSDA , IDEDS_VAL , STR1.TRHORA , STR1.DATMES , NOSDA_VAL ) CIR0 ON ( STR1.CD_EDS_BNQ = CIR0.CD_EDS_BNQ AND COALESCE(STR1.CDMAT,'N') = CIR0.CDMAT_VAL AND STR1.TYPSDA = CIR0.TYPSDA AND COALESCE(STR1.NOSDA,' ') = CIR0.NOSDA_VAL AND COALESCE(STR1.IDEDS,'-1') = CIR0.IDEDS_VAL AND STR1.TRHORA = CIR0.TRHORA AND STR1.DATMES = CIR0.DATMES) LEFT JOIN ( SELECT STR1.CD_EDS_BNQ , COALESCE(STR1.CDMAT,'N') AS CDMAT_VAL , STR1.TYPSDA , COALESCE(STR1.IDEDS,'-1') AS IDEDS_VAL , STR1.TRHORA , STR1.DATMES , COALESCE(STR1.NOSDA,' ') AS NOSDA_VAL , COALESCE(STR1.IDSAV,' ') AS IDSAV_VAL ,MAXIMUM ( CASE WHEN STR1.IDTECH = '401' THEN STR1.STATVAL ELSE NULL END) NB_APPL_RECU_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '402' THEN STR1.STATVAL ELSE NULL END) NB_APPL_RECU_HNO_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '403' THEN STR1.STATVAL ELSE NULL END) NB_APPL_MULTIPLE_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '404' THEN STR1.STATVAL ELSE NULL END) NB_APPL_PRESTE_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '405' THEN STR1.STATVAL ELSE NULL END) NB_SOLCITATN_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '406' THEN STR1.STATVAL ELSE NULL END) NB_APPL_DECROCHE_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '407' THEN STR1.STATVAL ELSE NULL END) NB_APPL_MEVO_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '408' THEN STR1.STATVAL ELSE NULL END) DUR_TOT_APPL_SAV ,MAXIMUM ( CASE WHEN STR1.IDTECH = '409' THEN STR1.STATVAL ELSE NULL END) NB_APPL_DISSUADE_SAV FROM %DTA%.STATSAFROID STR1 GROUP BY STR1.CD_EDS_BNQ , CDMAT_VAL , STR1.TYPSDA , IDEDS_VAL , STR1.TRHORA , STR1.DATMES , NOSDA_VAL , IDSAV_VAL ) CIRSAV ON ( STR1.CD_EDS_BNQ = CIRSAV.CD_EDS_BNQ AND COALESCE(STR1.CDMAT,'N') = CIRSAV.CDMAT_VAL AND STR1.TYPSDA = CIRSAV.TYPSDA AND COALESCE(STR1.NOSDA,' ') = CIRSAV.NOSDA_VAL AND COALESCE(STR1.IDEDS,'-1') = CIRSAV.IDEDS_VAL AND STR1.TRHORA = CIRSAV.TRHORA AND STR1.DATMES = CIRSAV.DATMES AND COALESCE(STR1.IDSAV,' ') = CIRSAV.IDSAV_VAL) LEFT JOIN ( SELECT STR1.CD_EDS_BNQ , COALESCE(STR1.CDMAT,'N') AS CDMAT_VAL , STR1.TYPSDA , COALESCE(STR1.IDEDS,'-1') AS IDEDS_VAL , STR1.TRHORA , STR1.DATMES ,COALESCE(STR1.NOSDA,' ') AS NOSDA_VAL , COALESCE(STR1.CODEPF,'-1') AS CODEPF_VAL , COALESCE(STR1.MATAGENT,'-1') AS MATAGENT_VAL , MAXIMUM ( CASE WHEN STR1.IDTECH = '501' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_PRESTE_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '502' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_DCROCH_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '503' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '504' THEN STR1.STATVAL ELSE NULL END ) NB_TOT_DCROCH_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '505' THEN STR1.STATVAL ELSE NULL END ) NB_RENVOI_GSM , MAXIMUM ( CASE WHEN STR1.IDTECH = '506' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '507' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_AGT_INTRN , MAXIMUM ( CASE WHEN STR1.IDTECH = '508' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_RECU_AGT_EXT , MAXIMUM ( CASE WHEN STR1.IDTECH = '509' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_PRESTE_LGN_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '510' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_PRESTE_LGN_AGNC , MAXIMUM ( CASE WHEN STR1.IDTECH = '511' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_PRESTE_LGN_AGT_INTRN , MAXIMUM ( CASE WHEN STR1.IDTECH = '512' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_PRESTE_LGN_AGNC_INTRN , MAXIMUM ( CASE WHEN STR1.IDTECH = '513' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_PRESTE_LGN_AGNC_EXT , MAXIMUM ( CASE WHEN STR1.IDTECH = '514' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_PRESTE_LGN_AGT_EXT , MAXIMUM ( CASE WHEN STR1.IDTECH = '515' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TRSF_LGN_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '516' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_INTRCPT_LGN_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '517' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TRSF_LGN_AGNC , MAXIMUM ( CASE WHEN STR1.IDTECH = '518' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_INTRCPT_LGN_AGNC , MAXIMUM ( CASE WHEN STR1.IDTECH = '519' THEN STR1.STATVAL ELSE NULL END ) NB_SOLCITATN_PRVNC_LGN_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '520' THEN STR1.STATVAL ELSE NULL END ) NB_SOLCITATN_PRVNC_LGN_AGNC , MAXIMUM ( CASE WHEN STR1.IDTECH = '521' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_MEVO_LGN_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '522' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_LGN_AGNC , MAXIMUM ( CASE WHEN STR1.IDTECH = '523' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_MOINS_20S , MAXIMUM ( CASE WHEN STR1.IDTECH = '524' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_MOINS_90S , MAXIMUM ( CASE WHEN STR1.IDTECH = '525' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_DCROCH_LGN_AGNC_EDS , MAXIMUM ( CASE WHEN STR1.IDTECH = '526' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_DCROCH_LGN_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '528' THEN STR1.STATVAL ELSE NULL END ) DUR_APPL_IN_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '527' THEN STR1.STATVAL ELSE NULL END ) DUR_APPL_OUT_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '529' THEN STR1.STATVAL ELSE NULL END ) MOYN_SONNERIE_DCROCH , MAXIMUM ( CASE WHEN STR1.IDTECH = '530' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_OUT_AGT , MAXIMUM ( CASE WHEN STR1.IDTECH = '531' THEN STR1.STATVAL ELSE NULL END ) NB_APPL_TR_LGN_AGT FROM %DTA%.STATSAFROID STR1 GROUP BY STR1.CD_EDS_BNQ , CDMAT_VAL , STR1.TYPSDA , IDEDS_VAL , STR1.TRHORA , STR1.DATMES , NOSDA_VAL , STR1.CODEPF , STR1.MATAGENT ) CIRAGT ON ( STR1.CD_EDS_BNQ = CIRAGT.CD_EDS_BNQ AND COALESCE(STR1.CDMAT,'N') = CIRAGT.CDMAT_VAL AND STR1.TYPSDA = CIRAGT.TYPSDA AND COALESCE(STR1.IDEDS,'-1') = CIRAGT.IDEDS_VAL AND STR1.TRHORA = CIRAGT.TRHORA AND STR1.DATMES = CIRAGT.DATMES AND COALESCE(STR1.NOSDA,' ') = CIRAGT.NOSDA_VAL AND COALESCE(STR1.CODEPF,'-1') = CIRAGT.CODEPF_VAL AND COALESCE(STR1.MATAGENT,'-1') = CIRAGT.MATAGENT_VAL) LEFT JOIN ( Select CIR1.CD_BQE , CIR1.ID_DWR_EDS , CIR1.ID_EXT_EDS , CIR1.ID_TYP_EDS FROM %SOC%.DEN_EDS_CRT CIR1 QUALIFY rank () OVER (PARTITION BY CIR1.CD_BQE , CIR1.ID_EXT_EDS ORDER BY (CIR1.ID_TYP_EDS) ASC ) =1 ) CIR11 ON ( STR1.CD_EDS_BNQ=CIR11.CD_BQE AND STR1.IDEDS=CIR11.ID_EXT_EDS) LEFT OUTER JOIN %SOC%.TYP_TRCH_HOR CIR2 ON ( STR1.TRHORA=CIR2.CD_TRCH_HOR AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT OUTER JOIN ( SELECT * FROM %TCO%.ID_AGT_TCO TCO3 WHERE EXISTS (SELECT 1 FROM %SOC%.AGT AS CIR9 WHERE TCO3.CD_EDS_BNQ=CIR9.CD_BQE AND TCO3.ID_DWR =CIR9.ID_DWR_AGT) ) CIR3 ON ( STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND SUBSTR(STR1.MATAGENT,3,7)=CIR3.ID_SOURCE1) LEFT OUTER JOIN %SOC%.PST_FNCT CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CODEPF = CIR4.CD_PST_FNCT AND CIR4.DF_HISTO = '9999-12-31 00:00:00') LEFT OUTER JOIN %SOC%.PST_FNCT_DEPEND_EDS CIR5 ON(CIR4.CD_BQE=CIR5.CD_BQE AND CIR5.ID_DWR_PST_FNCT =CIR4.ID_DWR_PST_FNCT AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.FNCTN_CORRESPD_PST_FNCT CIR6 ON(CIR4.CD_BQE=CIR6.CD_BQE AND CIR6.ID_DWR_PST_FNCT =CIR4.ID_DWR_PST_FNCT AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.STAT_TELPHNIE_AGT CIR7 ON ( STR1.CD_EDS_BNQ=CIR7.CD_BQE AND CIR11.ID_DWR_EDS=CIR7.ID_DWR_EDS_PST_FNCT AND STR1.DATMES=CIR7.ID_J AND STR1.TRHORA=CIR7.CD_TRCH_HOR) LEFT OUTER JOIN %SOC%.TYP_SAV CIR8 ON ( STR1.CD_EDS_BNQ=CIR8.CD_BQE AND TRIM(STR1.IDSAV)=CIR8.ID_SAV AND CAST(CIR8.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR8.DF_HISTO AS DATE))
V_MS_PROFIL_TDBACCUEIL                            SELECT IDCR, PROFILGROUPNAME, TDB_ID, TDB_NAME FROM %PIL%%DatabaseMstrSuffix%.%ObjectNameFrom% STR1
COCL_DONFI                                        SELECT STR1.CD_EDS_BNQ , STR1.ID_STRUCT , STR1.NUM_SIREN_ENTR , STR1.NUM_NIC_ETS , STR1.AN_CLOT_BILAN , STR1.DT_VACTN , STR1.CD_STRTG , STR1.TYP_PART_PROPRIO , STR1.MT_CHIFR_AFFR_ENTR , STR1.MT_CHIFR_AFFR_NET_FR , STR1.MT_CHIFR_AFFR_NET_EXPRT , STR1.MT_FOND_PROP , STR1.MT_DSPNBLT , STR1.CD_TRNCH_SCORE , STR1.MT_CRED_BAIL_MOBLS , STR1.MT_CRED_BAIL_IMMBLS , STR1.MT_PRET , STR1.MT_AUTR_IMBLSTN_FINC , STR1.MT_CAPTL , STR1.MT_MRCHDS , STR1.MT_CLI_CPTE_RATCH , STR1.MT_VAL_MOBLR_PLACMT , STR1.MT_EMPR_DETT_ETS_CRED , STR1.MT_EMPR_DETT_FINC_DIV , STR1.MT_DETT_FRNSR , STR1.MT_DETT_FISC_SCIAL , STR1.MT_TOT_BILAN , STR1.MT_ACHT_MRCHDS , STR1.MT_VARTN_STCK_MRCHDS , STR1.MT_ACHT_MATIR_PREM , STR1.MT_VARTN_STCK_MATIR_PREM , STR1.MT_CRED_BAIL_MOBLR , STR1.MT_RESULT_XPLTTN , STR1.MT_RESULT_CRNT_AVT_IMPO , STR1.MT_RESULT_FINC , STR1.MT_BNFC_PERT , STR1.MT_ENGAG_CRED_BAIL_MOBLR , STR1.MT_ENGAG_CRED_BAIL_IMMO , STR1.MT_EFFT_ESCMPT_NON_ECHU , STR1.MT_SS_TRTNC , STR1.MT_CRED_BAIL_IMMO , STR1.RATIO_CROIS_CA , STR1.RATIO_RNTBLT_XPLTTN , STR1.RATIO_CPCT_A_GNRER_CASH , STR1.RATIO_POIDS_MASSE_SALARL , STR1.RATIO_RNTBLT_CAPTX , STR1.RATIO_PRDTVT , STR1.RATIO_ROTTN_STCK , STR1.RATIO_ROTTN_CLI , STR1.RATIO_ROTTN_FRNSR , STR1.RATIO_CPCT_AUTO_FINCT , STR1.RATIO_LIQDT , STR1.RATIO_ENDTMT , STR1.RATIO_CVRTR_FOND_PROP , STR1.RATIO_TX_RNVLMT , STR1.RATIO_SURFC_BQR , STR1.SOURCE_CREAT , STR1.SOURCE_MAJ , STR1.TS_MAJ , STR1.ID_AGT_MAJ , STR1.CD_CNL_DSTRB_MAJ , STR1.ID_STRUCT_MAJ , STR1.ID_TECHN_CONSO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.ID_TK_CONSO , Case when CIR1.CD_BQE is not null then 1 else 0 end ROW_FOUND_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %SOC%.CONSO CIR1 ON CIR1.ID_TK_CONSO = STR1.ID_TECHN_CONSO AND CIR1.CD_BQE = STR1.ID_STRUCT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)
CATMPR                                            SELECT STR1.CD_EDS_BNQ , STR1.IDEVT , STR1.LNEVT , STR1.CTDRE , STR1.CDVCC1 , STR1.CDVCC2 , STR1.CDVCC3 , STR1.CDVCC4 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRC814                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDCCA , STR1.IDPART , STR1.DDCCA , STR1.DFCCA , STR1.LICCA , STR1.CPOBJA , STR1.DDSAL , STR1.DFSAL , STR1.LMINC , STR1.ZTEVER , STR1.IDACTA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CPOBJA = CIR1.CD_STATU_CRED_COMPLEXE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
PROFES                                            SELECT STR1.CD_EDS_BNQ , STR1.CDPCSP , STR1.LICSPP , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.CRPCSP , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TECCOM                                            SELECT STR1.CD_EDS_BNQ , STR1.IDTCCO , STR1.LCTCCO , STR1.LITCCO , STR1.CPETAO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
BASMS010                                          SELECT STR1.CD_EDS_BNQ , STR1.LIEMLL , STR1.LINTSA , STR1.LIMES9 , STR1.NBOCCE , STR1.HEURE8 , STR1.DTTRA3 , STR1.CPETAH , STR1.LIEMLK , STR1.IDPART , STR1.IDBAM , STR1.IDPARZ , STR1.IDMEST , STR1.IDMESG , STR1.IDMSG , STR1.CBOROP , STR1.TYPMOU , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION ,COALESCE(CIR1.ID_DWR_PART,0) AS ID_DWR_PART ,CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.PART CIR1 ON(STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDPART = CIR1.ID_PART AND STR1.DT_ELIG >= CIR1.DD_HISTO AND STR1.DT_ELIG < CIR1.DF_HISTO)
TYPORT                                            SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDTYPO , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.DDTPO , STR1.DFTPO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.LITYPO FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN %DE1%.EDSNTPTF CIR1 ON (STR1.IDTYPO = CIR1.IDTYPO AND CIR1.TK_ACTION IN ('I','U'))
DGCZ11                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDBTN , STR1.CQPST , STR1.LMRST , STR1.HEPAT , STR1.DADMAJ , STR1.DELIEN , STR1.DFLIEN , STR1.CDACOR , STR1.CDORIS , STR1.DDVAL , STR1.HDVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %SOC%.BOUTON CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.IDBTN = CIR2.ID_BOUTON_TECHN_CNTCT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
PERPHY                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.LNPATR , STR1.LNMARI , STR1.LNUSAG , STR1.LNPRUS , STR1.CDSEXE , STR1.CLEBDF , STR1.CDCAJU , STR1.DMCAJU , STR1.CDSIFA , STR1.CDTICI , STR1.CDREMA , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.LNEMPR , STR1.DAEMPR , STR1.DADVSF , STR1.DATE2N , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , COALESCE(CIR2.CCATJU,0) CCATJU , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %DE1%.ENNOEC CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART = CIR2.IDPART AND CIR2.TK_ACTION IN ('I','U'))
TYP_CPCT_JUR_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
AYDLEP                                            SELECT STR1.CD_EDS_BNQ , STR1.NCPTE , STR1.DAATRT , STR1.DAAFI1 , STR1.MTIMPO , STR1.CDTRT1 , STR1.DACRE0 , STR1.DADMAJ , STR1.CBVALN , STR1.CQCLI1 , STR1.CDMTFC , STR1.MTREFC , STR1.QTPAR2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTE=CIR1.NU_CPTE)
T3R13                                             SELECT STR1.CD_EDS_BNQ, STR1.IDPART, STR1.IDMARC, STR1.DELIEN, STR1.DFLIEN, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION, COALESCE(TCO1.ID_DWR,0) ID_DWR_PART, Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1, Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.T3R13 STR1 LEFT JOIN %DE1%.CLASSIFICATION CIR1 ON (CIR1.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CAST (CIR1.IDCLAS AS DECIMAL(2))=STR1.IDMARC AND CIR1.IDCRIT = 'MARCHE' AND CIR1.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDPART= TCO1.ID_SOURCE1)
A018DH18                                          SELECT STR1.CD_EDS_BNQ, STR1.IDELCO, STR1.NUEVPR, STR1.CDEVEN, STR1.NOOPPR, STR1.NOPRPR, STR1.MKAREA, STR1.MFREAM, STR1.PDURSD2, STR1.TXACPR2, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION, CIR1.ID_DWR_EDC, CIR2.MFDOA4, CIR2.MFDOI4, CIR2.DT_ELIG AS DT_ELIG_GRA836, Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1, Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2, Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.EVT_PRET CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELCO=CIR1.ID_EDC_CRED AND STR1.NUEVPR=CIR1.NU_EVT_PRET AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG <= CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %DTA%.GRA836 CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.NOOPPR=CIR2.NOOPPR AND STR1.NOPRPR=CIR2.NOPRPR) LEFT JOIN %SOC%.TYP_EVT_CRED CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CDEVEN=CIR3.CD_EVT_CRED)
ICNTRA                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCTRT , STR1.NUIMAG , STR1.IDBANC , STR1.DAACTG , STR1.DADERS , STR1.DADESS , STR1.DMFLUX , STR1.CDBUR1 , STR1.CDVEND , STR1.CDPROD , STR1.CDFOIC , STR1.CDSICT , STR1.DEDIMC , STR1.DEFIMC , STR1.DEDAFN , STR1.DRESC1 , STR1.DECHC1 , STR1.DPRECH , STR1.CPEFAC , STR1.MTCOT0 , COALESCE(CAST(%PMU%.Bin2Char(STR1.IDELCO) AS VARCHAR(30)),' ') AS IDELCO_STR , STR1.IDELCO AS IDELCO_BYTE , CAST(COALESCE(CIR1.ID_SOURCE1,' ') AS VARCHAR(33)) AS IDELCOECD , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN STR1.TK_FLAG='R' then Cast(( CURRENT_DATE - Cast (STR1.RE_CYCLE As date) ) AS integer) ELSE 0 END Flag_Max_Rej , CASE WHEN CIR1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN CIR4.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR5 , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC , COALESCE(TCO1.ID_DWR,0) ID_DWR_CTR_IARD FROM %DTA%.ICNTRA STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON ( STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDELCO=CIR1.BY_SOURCE1 ) LEFT JOIN %SOC%.TYP_PROD_FRMUL_IARD CIR4 ON ( STR1.CD_EDS_BNQ = CIR4.CD_BQE AND STR1.CDPROD = CIR4.CD_PROD_ASSU_IARD AND STR1.CDFOIC = CIR4.CD_FRMUL_CTR_IARD) LEFT JOIN %SOC%.TYP_PROD_ASSU_IARD CIR5 ON ( STR1.CD_EDS_BNQ = CIR5.CD_BQE AND STR1.CDPROD = CIR5.CD_PROD_ASSU_IARD) LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON ( STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCTRT=TCO1.ID_SOURCE1 )
TYP_SEGM_CIAL_CST                                 SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
IARFKA12                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.NCPTPA , STR1.KA10_IDCTRT , STR1.KA12_DACIRC , STR1.KA12_MVNEVE , STR1.KA12_CPOST2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_CTR_IARD , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.KA10_IDCTRT=TCO1.ID_SOURCE1)
T1R18                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.CDPAYS , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %SOC%.PAYS CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CDPAYS = CIR2.ID_CD_PAYS)
UNICA_3A                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.IDECA1 , STR1.IDPLA , STR1.LNPLA , STR1.LMPLA , STR1.LISTS , STR1.DAAFI1 , STR1.LMSEC , STR1.CDSECP , STR1.LISECP , STR1.LIGRB , STR1.LISTA1 , STR1.CTPLAP , STR1.LITYPP , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
AGPFTX                                            SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB ,STR1.IAGENT ,STR1. IPOSTF , STR1.TXOPF , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_EDS_BNQ is Null then 0 else 1 end Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is Null then 0 else 1 end Row_Found_CIR2 , Coalesce(CIR1.ID_DWR,0) ID_DWR_AGT , Coalesce(CIR2.ID_DWR,0) ID_DWR_PST_FNCT FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_AGT_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IAGENT=CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_PST_FNCT_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IPOSTF=CIR2.ID_SOURCE1)
OPSDDR                                            SELECT STR1.CD_EDS_BNQ , STR1.NPART1 , STR1.IDOPED , STR1.IDO3PG , STR1.DICREV , STR1.CDBIC , STR1.CDBICS , STR1.CADEVI , STR1.MOOPFH , STR1.DTRGT9 , STR1.IDCLT9 , STR1.IDBANT , STR1.LNCLI9 , STR1.IDCRN , STR1.CDBIC1 , STR1.NOIBAN , STR1.LNCLI8 , STR1.CDBIC2 , STR1.NOIBA2 , STR1.CTSTRU , STR1.LIRECL , STR1.IDMND , STR1.LNCLIB , STR1.LNPAEF , STR1.LNCLIA , STR1.LNPARF , STR1.LNOBJQ , STR1.CCATOB , STR1.NCPTE , STR1.CDOPEB , STR1.CDSPA4 , STR1.CDSTAP , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_CLASS_NOTATN_CREANC_CST                       SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
COCL_AF_INDIC_CLI                                 SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CD_ENT_CAM_AFFECT_A_INDIC_CLI , STR1.ID_TECHN_INDIC_CLI , CAST(CAST(COALESCE(STR1.ID_TECHN_INDIC_CLI,0) AS BIGINT) AS VARCHAR(5)) AS ID_TECHN_INDIC_CLI_CHAR , STR1.ID_SUJET_INDIC_CLI , CAST(COALESCE(STR1.ID_SUJET_INDIC_CLI,0) AS CHAR(15)) as ID_SUJET_INDIC_CLI_CHAR , STR1.DT_APPLI_AFFECT_A_INDIC_CLI , STR1.SOURCE_AFFECT_A_INDIC_CLI , STR1.CD_TYP_SUJET_INDIC_CLI , STR1.DT_MAJ_AFFECT_A_INDIC_CLI , STR1.CD_VAL_INDIC_CLI , STR1.DT_PROD_AFFECT_A_INDIC_CLI , STR1.INFO_COMPL_AFFECT_A_INDIC_CLI , STR1.HR_MAJ_INDIC_CLI , STR1.ID_STRUCT_MAJ_INDIC_CLI , STR1.ID_AGT_MAJ_INDIC_CLI , STR1.CD_CNL_DE_DSTRB_MAJ_INDIC_CLI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR3.ID_NOMCLTR_INDIC_CLI,0) AS ID_NOMCLTR_INDIC_CLI , COALESCE(CIR1.ID_DWR_PART,0) AS ID_DWR_PART , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT Join %SOC%.PART CIR1 On (STR1.ID_SUJET_INDIC_CLI=CAST(CIR1.ID_PART AS VARCHAR(30)) AND STR1.CD_ENT_CAM_AFFECT_A_INDIC_CLI = CIR1.CD_BQE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT Join %SOC%.INDIC_CLI CIR2 On (STR1.CD_ENT_CAM_AFFECT_A_INDIC_CLI=CIR2.CD_BQE and CAST(CAST(STR1.ID_TECHN_INDIC_CLI AS format 'Z(I)') AS CHAR(5)) =Trim(CIR2.ID_INDIC_CLI) AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT Join %DE1%.COCL_INDIC_CLI CIR3 On (STR1.ID_TECHN_INDIC_CLI=CIR3.ID_TECHN_INDIC_CLI) LEFT Join %SOC%.INDIC_CLI CIR4 On (CIR3.ID_NOMCLTR_INDIC_CLI =CIR4.ID_INDIC_CLI AND STR1.CD_ENT_CAM_AFFECT_A_INDIC_CLI=CIR4.CD_BQE) where (STR1.CD_TYP_SUJET_INDIC_CLI ) = 'PART' and 1=1
GRA002                                            SELECT STR1.CD_EDS_BNQ , STR1.GRA002_IDELCO , STR1.NUELCV , STR1.CDETAB , STR1.CDGUIC , UPPER (STR1.NCPRIB) AS NCPRIB , STR1.CLERIB , STR1.IDCONV , STR1.QQINEC , STR1.MTFIEC , STR1.CDREIN , STR1.TXCOEC , STR1.MTFCEC , STR1.CDRECM , STR1.CSCOMM , STR1.DEELCV , STR1.DFELCV , STR1.IEELCV , STR1.CDSPMP , STR1.PEMOCV , STR1.PEELCV , STR1.DAPECV , STR1.CDEACV , STR1.IDPACV , STR1.CDOAPL , STR1.CDICCV , STR1.CDTYPY , STR1.CCIMEC , STR1.CTROCV , STR1.ZTEVER , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC, 0) ID_DWR_EDC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.GRA002_IDELCO=CIR1.ID_EDC_CRED AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) AND CIR1.ID_EDC_CRED IS NOT NULL) WHERE 1=1 and STR1.CTROCV=2 AND STR1.NCPRIB IS NOT NULL
EXCTIDXX                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ IS NOT NULL THEN TCO1.ID_SOURCE1 ELSE Bin2Char(STR1.IDELCO) END AS VARCHAR(30)) AS IDELCO , STR1.IDCTRA AS IDCTRA_BYTE , CAST(Bin2Char(STR1.IDCTRA) AS VARCHAR(30)) AS IDCTRA , STR1.CDENRG , STR1.IDCLI , STR1.IDPACO , STR1.CBSOLD , CAST(TO_NUMBER(TRIM(STR1.IDPRBS),'99999') AS SMALLINT) AS IDPRBS_INT , STR1.IDPRBC , STR1.IDCDPS , CAST(CAST(STR1.IDCDPC AS INTEGER) AS CHAR(5)) AS IDCDPC_CHAR , STR1.IOFFRE , STR1.DASICO , STR1.DEFCON , STR1.DFINCO , STR1.CDMOOC , STR1.CDMOFC , STR1.DDFONC , STR1.DFFONC , STR1.LIAPUS , STR1.NCCOMP , STR1.IDFPRC , STR1.IDFPRS , STR1.DDCOMP , STR1.DFCOMP , STR1.CTCPTE , STR1.CBETRG , STR1.CDUSAG , STR1.CBTAEM , STR1.CBTARE , STR1.IDELBG , STR1.IDANBG , STR1.IDDEVI , STR1.IDSGMA , STR1.ITSPPA , STR1.ITSPPE , STR1.CDAGEC , STR1.CTACV , STR1.DDINPA , STR1.CDRSY3 , STR1.IDASPR , STR1.CCFIS , STR1.MTVTI5 , STR1.MTNOM0 , STR1.CSTAT , STR1.IDVAL4 , STR1.IDPROD , STR1.QTITRL , STR1.CCTIT3 , STR1.DASOU1 , STR1.CBPASO , STR1.DADCDD , STR1.RE_CYCLE , TD_MONTH_BEGIN(CAST (STR1.DT_ELIG AS DATE) - INTERVAL '1' MONTH) AS DD_PE , CAST(TD_MONTH_END(CAST (STR1.DT_ELIG AS DATE) - INTERVAL '1' MONTH) AS TIMESTAMP(0)) AS DD_HISTO , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , TCO1.ID_DWR , 'MC' as CT_PE FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD')
GRCO_MVT_PERT                                     SELECT STR1.IDEXEY, STR1.IDELCH, STR1.MTPER1, STR1.DEVNT, STR1.CDMTF, STR1.CDMOPR, STR1.MTMO351, STR1.MTMO352, STR1.MTMO353, STR1.CDSTGO, STR1.CTCREB, STR1.CTCRK, STR1.DCARR7, STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
GRC819                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDECV , STR1.CPOBJW , STR1.DAWAI , STR1.ZTEVER , STR1.IDCCA , STR1.CPPIJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT S1.CD_BQE , ID_ELT_COVENANT ,DD_HISTO ,DF_HISTO FROM (SELECT DISTINCT CD_BQE , ID_ELT_COVENANT ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.ELT_COVENANT UNION SELECT DISTINCT CD_BQE , ID_ELT_COVENANT ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.ELT_COVENANT) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_ELT_COVENANT ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDECV = CIR1.ID_ELT_COVENANT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CPOBJW = CIR2.CD_STATU_CRED_COMPLEXE AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_CD_PRES_PCE_JUSTIF CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CPPIJ = CIR3.CD_PRES_PCE_JUSTIF AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN (SELECT S1.CD_BQE , ID_CTR_CADRE ,DD_HISTO ,DF_HISTO FROM (SELECT DISTINCT CD_BQE , ID_CTR_CADRE ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.CTR_CADRE UNION SELECT DISTINCT CD_BQE , ID_CTR_CADRE ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.CTR_CADRE) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_CTR_CADRE ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1) CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.IDCCA = CIR4.ID_CTR_CADRE AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
COCL_AF_CRC                                       SELECT STR1.CD_EDS_BNQ , STR1.ID_STRUCT_CONSO , STR1.ID_TECHN_CRC , STR1.ID_TECHN_CONSO , STR1.CD_RL_CRC , STR1.TS_MAJ_AFFECT_CRC , STR1.SOURCE_MAJ_AFFECT_CRC , STR1.ID_STRUCT_MAJ_AFFECT_CRC , STR1.ID_AGT_MAJ_AFFECT_CRC , STR1.CD_CNL_DSTRB_MAJ_AFFECT_CRC , STR1.DT_ELIG , STR1.RE_CYCLE , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 FROM %DTA%.COCL_AF_CRC STR1 LEFT Join %SOC%.CRCL_REL_CIALE CIR1 on (STR1.ID_STRUCT_CONSO=CIR1.CD_BQE and STR1.ID_TECHN_CRC=CIR1.ID_TK_CRCL_REL_CIALE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT Join %SOC%.CONSO CIR2 on (STR1.ID_STRUCT_CONSO=CIR2.CD_BQE and STR1.ID_TECHN_CONSO=CIR2.ID_TK_CONSO AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT Join %SOC%.TYP_RL_CRCL_REL_CIALE CIR3 on(STR1.ID_STRUCT_CONSO=CIR3.CD_BQE and STR1.CD_RL_CRC= CIR3.CD_RL_CRCL_REL_CIALE AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
REF_TYPE_PREUVE                                   SELECT STR1.CD_EDS_BNQ , STR1.TYPE_PREUVE_ID , STR1.TYPE_PREUVE_LIBELLE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
INCPER                                            SELECT STR1.CD_EDS_BNQ , STR1.IDINPE IDINPE_BYTE , CAST(Case When TCO1.CD_EDS_BNQ is not null then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDINPE) End AS VARCHAR(30)) IDINPE , STR1.DDEIPE , STR1.DFINPE , STR1.ITSPPE , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_SITUA_PARTC , COALESCE(CIR1.CT_DWR_SITUA_PARTC,0) ID_DWR_TYP_SITUA_PARTC , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 , CIR2.IDPART , CIR3.CT_PART , COALESCE(CIR4.CT_PART,'XX') as CT_PART_PART FROM %DTA%.INCPER STR1 LEFT JOIN %TCO%.ID_SITUA_PARTC_TCO TCO1 ON(STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDINPE=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,1)='1') LEFT JOIN %SOC%.TYP_SITUA_PARTC CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.ITSPPE=CIR1.CT_SITUA_PARTC AND CIR1.CD_REGRP_SITUA_PART=1 AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %DE1%.T6R01 CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDINPE=CIR2.IDINPE AND CIR2.TK_ACTION IN ('I','U')) LEFT JOIN (SELECT DISTINCT CD_BQE, CT_PART, DD_HISTO, DF_HISTO, ID_PERSON FROM %SOC%.PERSON) CIR3 ON(CIR2.CD_EDS_BNQ=CIR3.CD_BQE AND CIR2.IDPART=CIR3.ID_PERSON AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN (SELECT DISTINCT CD_BQE, CT_PART, DD_HISTO, DF_HISTO, ID_PART FROM %SOC%.PART) CIR4 ON (CIR2.CD_EDS_BNQ=CIR4.CD_BQE AND CIR2.IDPART=CIR4.ID_PART AND CAST(CIR4.DD_HISTO AS DATE)<=CIR2.DT_ELIG AND CIR2.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
C1RE48                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDELCO IDELCO_BYTE , CAST(COALESCE(CIR2.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDELCO , STR1.CTINCT , STR1.DELIEN , STR1.DFLIEN , STR1.CDFICE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR3.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDELCO=CIR2.BY_SOURCE1 AND SUBSTR(CIR2.ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.CTINCT=CIR3.CDVAL9 AND CIR3.CDTABO = 'C1RE48XXCTINCT' AND CIR3.TK_ACTION IN ('I','U'))
COCLICO_ALPHANUMER                                SELECT STR1.CD_EDS_BNQ , STR1.CODENR , STR1.DATPRO , STR1.NATURE , STR1.IDENTI , STR1.IDTEC , STR1.DATAPL , STR1.CODANU , STR1.CODENR_2 , STR1.IDECAM , STR1.IDSUJE , STR1.VALINA , STR1.INFCOM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CLI_CIAL , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , TCO2.ID_DWR ID_DWR_CTR , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , TCO3.ID_DWR ID_DWR_EDC , Case When TCO3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO3 , TCO4.ID_DWR ID_DWR_PART , Case When TCO4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO4 ,CIR1.TYPSUJ ,Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.COCLICO_ALPHANUMER STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDSUJE= TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.IDSUJE= TCO2.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO TCO3 ON (STR1.CD_EDS_BNQ = TCO3.CD_EDS_BNQ AND STR1.IDSUJE= CAST(TCO3.ID_SOURCE1 AS VARCHAR(30)) AND SUBSTR(TCO3.ID_SOURCE1,31,3)='ECD') LEFT JOIN %TCO%.ID_PART_TCO TCO4 ON (STR1.CD_EDS_BNQ = TCO4.CD_EDS_BNQ AND STR1.IDSUJE= TCO4.ID_SOURCE1) LEFT JOIN %DE1%.CRM_CARAC CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDTEC=CIR1.IDTEC AND CIR1.TK_ACTION IN ('I','U'))
OPTN                                              SELECT STR1.CD_EDS_BNQ , STR1.CD_OPTN , STR1.APPLTN_CIALE_OPTN , STR1.LI_OPTN , STR1.NB_MINI_CHOIX_CLI_OPTN , STR1.NB_MAXI_CHOIX_CLI_OPTN , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
YVPP                                              SELECT STR1.CD_EDS_BNQ , STR1.NUMPART , STR1.DTSIT , STR1.TYPSIT , STR1.VPP_IDPART , CAST(STR1.VPP_IDCC AS CHAR(8)) VPP_IDCC , STR1.VPP_IDGRPRI , STR1.VPP_DTGENER , STR1.VPP_PNBSEGPRI , STR1.VPP_PNBSEGPRO , STR1.VPP_ENCMOYCRE , STR1.VPP_PNBCRE , STR1.VPP_ENCMOYCREA1 , STR1.VPP_PNBCREA1 , STR1.VPP_ENCDAVDEB , STR1.VPP_PNBDAVDEB , STR1.VPP_ENCDAVDEBA1 , STR1.VPP_PNBDAVDEBA1 , STR1.VPP_ENCCRETRE , STR1.VPP_PNBCRETRE , STR1.VPP_ENCCRETREA1 , STR1.VPP_PNBCRETREA1 , STR1.VPP_ENCCREEQ , STR1.VPP_PNBCREEQ , STR1.VPP_ENCCREEQA1 , STR1.VPP_PNBCREEQA1 , STR1.VPP_ENCCREHA , STR1.VPP_PNBCREHA , STR1.VPP_ENCCREHAA1 , STR1.VPP_PNBCREHAA1 , STR1.VPP_ENCCRECON , STR1.VPP_PNBCRECON , STR1.VPP_ENCCRECONA1 , STR1.VPP_PNBCRECONA1 , STR1.VPP_ENCAUCRE , STR1.VPP_PNBAUCRE , STR1.VPP_ENCAUCREA1 , STR1.VPP_PNBAUCREA1 , STR1.VPP_PNBADI , STR1.VPP_PNBADIA1 , STR1.VPP_PNBCAMCA , STR1.VPP_PNBCAMCAA1 , STR1.VPP_PNBFACRE , STR1.VPP_PNBFACREA1 , STR1.VPP_ENCCOL , STR1.VPP_PNBCOL , STR1.VPP_ENCCOLA1 , STR1.VPP_PNBCOLA1 , STR1.VPP_ENCCODAV , STR1.VPP_PNBCODAV , STR1.VPP_ENCCODAVA1 , STR1.VPP_PNBCODAVA1 , STR1.VPP_ENCDIPO , STR1.VPP_PNBDIPO , STR1.VPP_ENCDIPOA1 , STR1.VPP_PNBDIPOA1 , STR1.VPP_ENCCOLTERM , STR1.VPP_PNBCOLTERM , STR1.VPP_ENCCOLTERMA1 , STR1.VPP_PNBCOLTERMA1 , STR1.VPP_ENCCOLASS , STR1.VPP_PNBCOLASS , STR1.VPP_ENCCOLASSA1 , STR1.VPP_PNBCOLASSA1 , STR1.VPP_ENCCOLTI , STR1.VPP_PNBCOLTI , STR1.VPP_ENCCOLTIA1 , STR1.VPP_PNBCOLTIA1 , STR1.VPP_PNBFACCOL , STR1.VPP_PNBFACCOLA1 , STR1.VPP_PNBSERFAC , STR1.VPP_PNBSERFACA1 , STR1.VPP_PNBDYS , STR1.VPP_PNBDYSA1 , STR1.VPP_PNBASS , STR1.VPP_PNBASSA1 , STR1.VPP_PNBPART , STR1.VPP_MTRIST , STR1.VPP_FLCR , STR1.VPP_FLCRA1 , STR1.VPP_COBAL , STR1.VPP_COBALA1 , STR1.VPP_EXDLOS , STR1.VPP_PNBHBA , STR1.VPP_PNBHBA1 , STR1.VPP_ENCMOYHBA , STR1.VPP_ENCMOYHBA1 , STR1.VPP_PNBCOEXCRE , STR1.VPP_PNBCOEXCREA1 , STR1.VPP_PNBCOEXCOL , STR1.VPP_PNBCOEXCOLA1 , STR1.VPP_PNBCOEXFAC , STR1.VPP_PNBCOEXFACA1 , STR1.VPP_PNBCOEXASS , STR1.VPP_PNBCOEXASSA1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_CLI_CIAL , COALESCE(TCO2.ID_DWR,0) ID_DWR_PART FROM %DTA%.YVPP STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.VPP_IDCC = TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.VPP_IDPART= TCO2.ID_SOURCE1)
HISAGR                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDGRRI , STR1.IDENTR IDENTR_BYTE , CAST(CASE WHEN CIR5.CD_EDS_BNQ is not null Then CIR5.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDENTR) end AS VARCHAR(30)) AS IDENTR , STR1.NOSIRI , STR1.IDPART , STR1.DACRE9 , STR1.DCARRD , STR1.MAENT5 , STR1.QTEFF5 , STR1.MTEBE , STR1.MTACIN , STR1.MTVAAJ , STR1.MTREEX , STR1.MTCAF , STR1.MTFOPR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR, 0) ID_DWR_PART_CIR1 , COALESCE(CIR2.ID_DWR_PART, 0) ID_DWR_PART_CIR2 , COALESCE(CIR3.ID_DWR_ENTR, 0) ID_DWR_ENTR_CIR3 , CAST(COALESCE(CIR4.ID_SOURCE1, '') AS CHAR(30)) ID_SOURCE1_CIR4 , COALESCE(CIR5.ID_DWR, 0) ID_DWR_ENTR_CIR5 , COALESCE(CIR6.ID_DWR_ENTR, 0) ID_DWR_ENTR_CIR6 , COALESCE(CIR7.ID_DWR_PART, 0) ID_DWR_PART_CIR7 , CAST(COALESCE(CIR8.ID_SOURCE1, '') AS CHAR(15)) ID_SOURCE1_CIR8 , CASE WHEN TRIM(IDPART) = '' THEN 1 ELSE 0 END IDPART_VIDE , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 , Case When CIR7.CD_BQE is null then 0 else 1 End Row_Found_CIR7 , Case When CIR8.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR8 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT OUTER JOIN %SOC%.PART CIR2 ON ( CIR2.ID_DWR_PART=CIR1.ID_DWR AND CIR1.CD_EDS_BNQ = CIR2.CD_BQE AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.PART_POSSED_ENTR CIR3 ON (CIR1.CD_EDS_BNQ = CIR3.CD_BQE AND CIR1.ID_DWR = CIR3.ID_DWR_PART AND CIR3.DD_VALID <= STR1.DCARRD AND CIR3.DF_VALID > STR1.DCARRD) LEFT OUTER JOIN %TCO%.ID_ENTR_TCO CIR4 ON (CIR3.CD_BQE = CIR4.CD_EDS_BNQ AND CIR3.ID_DWR_ENTR = CIR4.ID_DWR ) LEFT OUTER JOIN %TCO%.ID_ENTR_TCO CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_EDS_BNQ AND STR1.IDENTR = CIR5.BY_SOURCE1) LEFT OUTER JOIN %SOC%.ENTR CIR6 ON ( CIR6.ID_DWR_ENTR=CIR5.ID_DWR AND CIR5.CD_EDS_BNQ = CIR6.CD_BQE AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.PART_POSSED_ENTR CIR7 ON (CIR5.CD_EDS_BNQ = CIR7.CD_BQE AND CIR5.ID_DWR = CIR7.ID_DWR_ENTR AND CIR7.DD_VALID <= STR1.DCARRD AND CIR7.DF_VALID > STR1.DCARRD) LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR8 ON (CIR7.CD_BQE = CIR8.CD_EDS_BNQ AND CIR7.ID_DWR_PART = CIR8.ID_DWR)
PROD_CIAL                                         SELECT STR1.CD_EDS_BNQ , STR1.CD_PROD_CIAL , STR1.APPLTN_CIALE_PROD_CIAL , STR1.LI_PROD_CIAL , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
SAV                                               SELECT STR1.CD_EDS_BNQ , STR1.IDSAV , STR1.LIBSAV , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1 WHERE 1=1
OPPORT                                            SELECT STR1.CD_EDS_BNQ , STR1.IDOPOR , STR1.IDPART , STR1.IDELEX , STR1.IDCTRA IDCTRA_BYTE , CAST(COALESCE(CIR1.ID_SOURCE1,'') AS VARCHAR(30)) AS IDCTRA , STR1.NCPTE , STR1.IDCPG2 , STR1.LCOPP , STR1.DIOPP , STR1.DFOPP , STR1.CPSIOP , STR1.CPOPP , STR1.DMSIOP , STR1.DMSTOP , STR1.CPSIIO , STR1.CPIOPP , STR1.DMSIIP , STR1.DMSTIP , STR1.CPSICO , STR1.CPCOPP , STR1.DMSICP , STR1.DMSTCP , STR1.CPSIPO , STR1.CPPOPP , STR1.DMSIPP , STR1.DMSTPP , STR1.KFOPP , STR1.COCHST , STR1.CTRAIS , STR1.CDRAIS , STR1.LICOPP , STR1.CDOFFR , STR1.NOETP , STR1.CDDOM7 , STR1.CDSDOC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CTR , COALESCE(CIR2.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(CIR3.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDCTRA = CIR1.BY_SOURCE1) LEFT JOIN %SOC%.ECD_DETENU CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.IDELEX = CIR2.ID_EDC_EXT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_PART_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.IDPART = CIR3.ID_SOURCE1)
TDSCK173                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.IDOPED , STR1.FILLER245 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
T5R03D                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCOSE IDCOSE_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCOSE) end AS VARCHAR(30)) AS IDCOSE , STR1.NCPTE , CAST(STR1.NCPTE as CHAR(11)) as NCPTE_CHAR , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC_E , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC_R , COALESCE(CIR3.CQLCCP,' ') CQLCCP , COALESCE(CIR3.CQLCCR,' ') CQLCCR , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ECD_cPTE CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.NCPTE=CIR1.NU_CPTE AND CIR1.CT_LIEN_EDC_CPTE= 'ELCOCPTE') LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDCOSE= CIR2.BY_SOURCE1 AND SUBSTR(CIR2.ID_SOURCE1,31,3) = 'SCE') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND CIR3.CDTABO='T5R03D' AND CIR3.TK_ACTION IN ('I','U'))
NOTEPA                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDNOPA , STR1.TXPDPA , STR1.GRAPDP , STR1.DTNOTE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1)
DTWHES04                                          SELECT STR1.CD_EDS_BNQ , CAST(%PMU%.Bin2Char(STR1.IDCTRA) AS VARCHAR(30)) AS IDCTRA , STR1.IDCTRA AS IDCTRA_BYTE , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ IS NOT NULL THEN TCO1.ID_SOURCE1 ELSE %PMU%.Bin2Char(STR1.IDELCO) END AS VARCHAR(30)) AS IDELCO , STR1.IDPACO , STR1.DDFONC , STR1.DFFONC , STR1.IDCDPR , STR1.IDCDP1 , STR1.IDCD2R , STR1.IDCDPK , STR1.IDDEVI , STR1.TYPCPT , STR1.CPTETR , STR1.NCPTE , STR1.NUCPSU , STR1.IDCANA , STR1.IDRSB , STR1.IDELEX , STR1.IDCTRX , STR1.IDCLTF , STR1.IDPRS7 , STR1.DECT2 , STR1.LNDISP , STR1.DFEPSA , STR1.CBCLIA , STR1.CDSTAN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR2.DT_PLAN , CIR2.CD_DEVIS_ISO , CIR2.NB_SAL_CTR , CIR2.NB_SAL_EPRGN , CIR2.MT_VERS_BRUT_MP , CIR2.MT_VERS_ARBTR , CIR2.MT_RACHAT_BRUT_MP , CIR2.MT_RACHAT_ARBTR , CIR2.MT_COMSN_IN_RCED_CR , CIR2.MT_TRIM_COMSN_FRAIS_RCED_CR , CIR2.MT_FRAIS_CPTE_RCED_CR , CIR2.MT_ANL_COMSN_SAL_OUT , CIR2.MT_COMSN_IN_FILIALE , CIR2.MT_COMSN_FRAIS_IN_FILIALE , CIR2.MT_TRSF_OUT_CONC , CIR2.MT_TRSF_IN_CONC , CIR2.MT_COMSN_IN_AMUNDI , CIR2.MT_COMSN_FRAIS_AMUNDI , CIR2.MT_COMSN_FRAIS_CA_TITRES , CIR2.DT_ARRT , CIR2.DT_DERNIER_VERS , CIR2.MT_ENCRS_FIN_MP , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_EDC , Case When CIR1.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD') LEFT JOIN %SOC%.TYP_STATU_CTR_ASSU CIR1 ON ( STR1.CD_EDS_BNQ = CIR1.CD_BQE AND TRIM(STR1.CDSTAN) = TRIM(CIR1.CD_STATU_PRNCP) AND CIR1.DD_HISTO <= STR1.DT_ELIG AND STR1.DT_ELIG < CIR1.DF_HISTO) LEFT JOIN ( SELECT CD_BQE , ID_EDC_VEGA , ID_DWR_EDC , DT_PLAN , CD_DEVIS_ISO , NB_SAL_CTR , NB_SAL_EPRGN , MT_VERS_BRUT_MP , MT_VERS_ARBTR , MT_RACHAT_BRUT_MP , MT_RACHAT_ARBTR , MT_COMSN_IN_RCED_CR , MT_TRIM_COMSN_FRAIS_RCED_CR , MT_FRAIS_CPTE_RCED_CR , MT_ANL_COMSN_SAL_OUT , MT_COMSN_IN_FILIALE , MT_COMSN_FRAIS_IN_FILIALE , MT_TRSF_OUT_CONC , MT_TRSF_IN_CONC , MT_COMSN_IN_AMUNDI , MT_COMSN_FRAIS_AMUNDI , MT_COMSN_FRAIS_CA_TITRES , DT_ARRT , DT_DERNIER_VERS , MT_ENCRS_FIN_MP , DD_HISTO , DF_HISTO FROM %SOC%.EPRGN_SALRL QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_BQE,ID_DWR_EDC ORDER BY DD_HISTO DESC,DF_HISTO DESC)=1 ) CIR2 ON ( STR1.CD_EDS_BNQ = CIR2.CD_BQE AND CAST( TCO1.ID_SOURCE1 AS VARCHAR(30))= CIR2.ID_EDC_VEGA AND CIR2.DD_HISTO <= STR1.DT_ELIG AND STR1.DT_ELIG < CIR2.DF_HISTO)
GRCO_TIERS_GP_RISQUE                              SELECT STR1.IDEXEY , STR1.IDGRRI , STR1.DFCOLT , STR1.IDPOCE , STR1.CBTEGR , STR1.CBTEGN , STR1.CDSTGO , STR1.DCARR7 , STR1.ZCNUFD FROM V%Adabo%GRCO_SOC_0.%ObjectNameFrom% STR1
LCLSTN_EDS                                        SELECT DISTINCT CD_EDS_BNQ , 'EDS' || STR1.IDADRE ID_SOURCE1, CAST(%PMU%.Char2Bin(SUBSTR(ID_SOURCE1,4,30)) AS BYTE(15)) BY_SOURCE1 FROM %DTA%.LCLSTN_EDS STR1 WHERE COALESCE(IDADRE,'') <>'' AND EXISTS (SELECT 1 FROM %SOC%.ELT_DE_STRUCT CIR1 WHERE STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELST=CIR1.ID_EDS ) AND EXISTS (SELECT 1 FROM %DE1%.ADRESSE_EDS CIR2 WHERE STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDADRE=CIR2.IDADRZ AND CIR2.TK_ACTION IN ('I','U'))
TYP_FINL_GRP_RISQ_CST                             SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ESPBDBDA                                          SELECT STR1.CD_EDS_BNQ , STR1.CDREGL , STR1.IDTPE , STR1.DDPER7 , STR1.CDRSY1 , STR1.CDRSY2 , STR1.CDRSY3 , STR1.CDRSY4 , STR1.CDRSY5 , STR1.CDRSY6 , STR1.CDRSY7 , STR1.CDRSY8 , STR1.MTAGG1 , STR1.MTAGG2 , STR1.MTAGG3 , STR1.MTAGG4 , STR1.RE_CYCLE , STR1.DT_ELIG , CASE WHEN CIR2.CD_BQE IS NULL THEN STR1.DT_ELIG ELSE CIR2.DD_HISTO END AS DD_HISTO_calc , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR2.CD_BQE IS NULL THEN STR2.MTAGG1_S ELSE CIR2.MT_DECLA_CR END AS MT_DECLA_CR , CASE WHEN CIR2.CD_BQE IS NULL THEN STR2.MTAGG2_S ELSE CIR2.MT_DECLA_TOUTE_CR END AS MT_DECLA_TOUTE_CR , STR2.MTAGG3_S , STR2.MTAGG4_S , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN ( SELECT CD_EDS_BNQ,CDRSY2,DDPER7,CDRSY1,CDRSY3, SUM(MTAGG1) AS MTAGG1_S , SUM(MTAGG2) AS MTAGG2_S , SUM(MTAGG3) AS MTAGG3_S , SUM(MTAGG4) AS MTAGG4_S FROM %DTA%.%ObjectNameFrom% GROUP BY CD_EDS_BNQ,CDRSY2,DDPER7,CDRSY1,CDRSY3 )STR2 ON STR1.CD_EDS_BNQ=STR2.CD_EDS_BNQ AND STR1.DDPER7=STR2.DDPER7 AND STR1.CDRSY2=STR2.CDRSY2 AND STR1.CDRSY3=STR2.CDRSY3 AND STR1 .CDRSY1=STR2.CDRSY1 LEFT JOIN %SOC%.TYP_AGT_ECON CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CDRSY2=CIR1.CD_AGT_ECON AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.A_BDF_MENS CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.DDPER7 = CIR2.DD_PE AND STR1.CDRSY2 = CIR2.CD_AGT_ECON AND SUBSTR(STR1.CDRSY1,3,3) = CIR2.CD_PROD_BDF AND STR1.CDRSY3 = CIR2.CD_DEPT_BDF)
MOTENT                                            SELECT CD_EDS_BNQ, CDEDFO, LIEDFO, LIEDF1, CDMOI1, DDVALM, DFVALM, RE_CYCLE, DT_ELIG, TK_CREATE, TK_CHANGE, TK_FLAG, TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
MISE_EN_MRCH                                      SELECT STR1.CD_EDS_BNQ , STR1.CD_ACTE_DSTRB , STR1.ID_CNL , STR1.ID_OFR_BQR , STR1.ID_DWR_EDS , STR1.DD_DSTRB , STR1.DF_DSTRB , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_ACTE_DSTRB is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.ID_CNL is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.ID_OFR_BQR is Null Then 0 Else 1 END Row_Found_CIR3 , Case WHEN CIR4.CD_STRUCT is Null Then 0 Else 1 END Row_Found_CIR4 FROM %DTA%.MISE_EN_MRCH STR1 LEFT JOIN (Select DISTINCT CD_ACTE_DSTRB FROM %SOC%.ACTE_DSTRB) CIR1 ON (STR1.CD_ACTE_DSTRB=CIR1.CD_ACTE_DSTRB) LEFT JOIN (Select DISTINCT CD_BQE, ID_CNL FROM %SOC%.CNL ) CIR2 ON (STR1.ID_DWR_EDS=CIR2.CD_BQE and trim(STR1.ID_CNL)=trim(CIR2.ID_CNL)) LEFT JOIN (Select DISTINCT ID_OFR_BQR FROM %SOC%.OFR ) CIR3 ON (STR1.ID_OFR_BQR=CIR3.ID_OFR_BQR) LEFT JOIN (Select DISTINCT CD_STRUCT FROM %SOC%.STRUCT ) CIR4 ON (STR1.ID_DWR_EDS=CIR4.CD_STRUCT)
TIMTBO01                                          SELECT STR1.CD_EDS_BNQ , STR1.IDSUCA , STR1.CDFOOP , STR1.CDETB9 , STR1.DFVAS9 , STR1.CDREOP , STR1.NUREO9 , STR1.CDMOO9 , STR1.CDPVCC , STR1.DAPVS9 , STR1.HEPVS9 , STR1.DAD9PV , STR1.HED9PV , STR1.CDLID9 , STR1.NUAUO9 , STR1.MTFSOP , STR1.MCFAOP , STR1.CDCOCE , STR1.CDREM1 , STR1.CDREM2 , STR1.DAMLO9 , STR1.CDMOML , STR1.DIOPC9 , STR1.DMOPC9 , STR1.DGMVC9 , STR1.DMOPT9 , STR1.HEMOT9 , STR1.DIENF9 , STR1.HEIEF9 , STR1.DATRR9 , STR1.DAMLC9 , STR1.CDTOCE , STR1.HEMLO9 , STR1.CDMOCE , STR1.HEDIC9 , STR1.CDDPRP , STR1.CDPAPV , STR1.CDDPPV , STR1.CDIEEM , STR1.CDSAOP , STR1.DTRIOP , STR1.CTCOSC , STR1.CTFRDX , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.DF_VALID_SPRT_CB , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.SPRT_CB CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDSUCA = CIR1.ID_SPRT_CB AND CIR1.DF_HISTO = '9999-12-31 00:00:00')
DGXG57                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPRS , STR1.DMRPS , STR1.DIRPS , STR1.PEVCM , STR1.DSPRS , STR1.CDOSM , STR1.NUBRM , STR1.TXMRB , STR1.CDOBJ , STR1.CDSYG , STR1.IDVP , STR1.IDSRV , STR1.LNCPS , STR1.LIPRS , STR1.CQBIP , STR1.MTTPE , STR1.CDPRIC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
UNICA_3F                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.IDCPG2 , STR1.IDECA1 , STR1.IDACTC , STR1.LNACTC , STR1.CBPOPT , STR1.LNPOPT , STR1.LNDIAG , STR1.DTEXEC , STR1.LIEXEC , STR1.NBRDEX , STR1.LIDCIB , STR1.LNACT1 , STR1.DDACT1 , STR1.DFACT1 , STR1.CTACTC , STR1.LIACN , STR1.LICACN , STR1.KFACT0 , STR1.CFEXE , STR1.LIFEXE , STR1.LMFEXE , STR1.CBACOP , STR1.CBCACA , STR1.IDCANA , STR1.IDTCN , STR1.IDMEST , STR1.CBICPT , STR1.CTPCS , STR1.CTCLG , STR1.CDOFFR , STR1.PEOBSE , STR1.PEDAFF , STR1.QPRME2 , STR1.CDREDA , STR1.MDOFF1 , STR1.MDFOF1 , STR1.MDEXE1 , STR1.MTMOY1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.PROJ_UNICA CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDCPG2 = CIR1.ID_CAMPGN_UNICA AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
UNICA_3H                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.CDOBJT , STR1.CDOBJN , STR1.CTATTC , STR1.LVATTB , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1 WHERE 1=1 and STR1.CD_EDS_BNQ > 0
ASSURE                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.NOOASS , STR1.LNNAS , STR1.LNPAS , STR1.CDCVAS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , TCO1.ID_DWR as ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1) LEFT Join %SOC%.EPRGN_ASSU_BQE_PRIVE CIR2 ON (TCO1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(TCO1.ID_SOURCE1 AS CHAR(30)) =CIR2.ID_EDC_VEGA AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
T6R27C                                            SELECT STR1.CD_EDS_BNQ , STR1.IDMESA IDMESA_BYTE , CAST(Case When TCO1.CD_EDS_BNQ is not null then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDMESA) End AS VARCHAR(30))AS IDMESA , STR1.IDELCO IDELCO_BYTE , CAST(Case When CIR1.CD_EDS_BNQ is not null then CIR1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDELCO) End AS VARCHAR(30)) IDELCO , STR1.MTBLEC , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_EVT , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC , CIR2.IDTYMS as IDTYMS , COALESCE(CIR3.ID_DWR_TYP_EVT,0) ID_DWR_TYP_EVT FROM %DTA%.T6R27C STR1 LEFT JOIN %TCO%.ID_EVT_TCO TCO1 ON(STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDMESA=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,1)='4') LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDELCO=CIR1.BY_SOURCE1 AND SUBSTR(CIR1.ID_SOURCE1,31,3)='ECD') LEFT JOIN %DE1%.MESAUV CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDMESA=CIR2.IDMESA AND CIR2.TK_ACTION IN ('I','U')) LEFT JOIN %SOC%.TYP_EVT CIR3 ON(CIR2.CD_EDS_BNQ=CIR3.CD_BQE AND CIR2.IDTYMS=CIR3.CT_EVT AND CIR3.CD_REGRP_EVT=4 AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
INDICCLI                                          SELECT STR1.CD_EDS_BNQ , STR1.IDINCL , STR1.LISOUR , STR1.LIINCL , STR1.CDCDO , STR1.CDPRC1 , STR1.CQINCL , STR1.IDTYIN , STR1.CDFAPC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
REF_PREUVES                                       SELECT STR1.CD_EDS_BNQ , STR1.PREUVE_ID , STR1.PREUVE_LIBELLE , STR1.PREUVE_IND_NATNL , STR1.PREUVE_DATE_DEBUT , STR1.PREUVE_DATE_FIN , STR1.PREUVE_IND_REN_DT_AN , STR1.PREUVE_MONTANT , STR1.TYPE_PREUVE_ID , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Coalesce(CIR1.CD_BQE,0) CD_BQE_TYP_TYP_PRVE , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_TYP_PRVE CIR1 ON (STR1.TYPE_PREUVE_ID = CIR1.ID_TYP_PRVE)
C2R04                                             SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IPOSTF , STR1.IDELST , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PST_FNCT , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDS , COALESCE(CIR3.ID_EXT_EDS,0) ID_EXT_EDS , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PST_FNCT_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IPOSTF = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDS_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDELST = CIR2.ID_SOURCE1) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE and STR1.IDELST=CIR3.ID_EDS and CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
HIERA_UTI                                         SELECT DISTINCT CT_HIERA_UTI , ID_HIERA_UTI , CD_BQE , 1 AS HIERA_EXIST FROM %WRK%.HIERA_UTI
TDSCK172                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.IDOPFN AS IDOPFN_BYTE , CAST(%PMU%.Bin2Char(STR1.IDOPFN) AS VARCHAR(30)) AS IDOPFN , STR1.FILLER235 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRP_RISQ_MENS                                     SELECT DISTINCT STR1.CD_BQE as CD_EDS_BNQ , STR1.DD_PE , STR1.ID_DWR_GRP_RISQ as ID_DWR , 1 AS REF_RISQ FROM %SOC%.%ObjectNameFrom% STR1
CLASSIFICATION                                    SELECT STR1.CD_EDS_BNQ , STR1.IDCRIT , STR1.IDCLAS , STR1.DTPLAN , STR1.LNCLAS , STR1.LCCLAS , STR1.IDSSCRIT , STR1.LNCRIT , STR1.DESCR , STR1.DDVAL , STR1.DFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION ,CASE WHEN STR1.TK_ACTION='D' THEN STR1.DT_ELIG ELSE CAST('9999-12-31 00:00:00' as Timestamp(0)) end DF_HISTO_CD FROM %DTA%.%ObjectNameFrom% STR1
PDI0VU01                                          SELECT STR1.CD_EDS_BNQ , STR1.CDENR2 , STR1.NUSEQ1 , STR1.CDOPE , STR1.CDBCF1 , STR1.CDBCF2 , STR1.CDAPPA , STR1.DTRA , STR1.CDENR5 , STR1.NUSEQ9 , STR1.FILLER , STR1.NUMCR1 , STR1.DEEFM1 , STR1.DADAC , STR1.CDTRT5 , STR1.IDCPR , STR1.CDBUR1 , STR1.LINTS3 , STR1.LNNPP4 , STR1.LNPATF , STR1.DANAI0 , STR1.MSTNC1 , STR1.MTETIC , STR1.MTTTC , STR1.FILLER_2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CAST(CAST(CAST(STR1.IDCPR AS DECIMAL(14,0))AS FORMAT'9(14)') AS CHAR(14)) IDCPR1 , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , CASE WHEN REJ1.CD_BQE IS NULL THEN 0 ELSE 1 END AS Row_found_Rej1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and CAST(CAST(CAST(STR1.IDCPR AS DECIMAL(14,0))AS FORMAT'9(14)') AS CHAR(14))=Trim(CIR1.ID_SOURCE1)) LEFT OUTER JOIN %REJ%.LIST_PART_ECART REJ1 ON (STR1.CD_EDS_BNQ = REJ1.CD_BQE AND STR1.IDCPR = TRIM(REJ1.ID_PART) AND REJ1.OBJECT_CODE ='D309610')
TYP_PROD_FRMUL_IARD_CST                           SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DGXG60                                            SELECT STR1.CD_EDS_BNQ , STR1.IDSGM , STR1.IDSGM0 , STR1.KPETS , STR1.IDSGN , STR1.LNCSG , STR1.LNSGM , STR1.DMSGM , STR1.LNRSG , STR1.QQREC , STR1.QQPOT , STR1.QQRIS , STR1.LMSGB , STR1.LMSGH , STR1.QCCSG , STR1.IDTYS , STR1.CPSPR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.DGXG61 CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDSGN=CIR1.IDSGN ) LEFT JOIN %SOC%.TYP_SGMTN_EMACO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDTYS=CIR2.CT_SGMTN AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
HRELTD                                            SELECT STR1.CD_EDS_BNQ , STR1.IDENV AS IDENV_BYTE , CAST(%PMU%.Bin2Char(STR1.IDENV) AS VARCHAR(30)) AS IDENV , STR1.IDTCCO , STR1.IDNUPA AS IDNUPA_BYTE , CAST(%PMU%.Bin2Char(STR1.IDNUPA) AS VARCHAR(30)) AS IDNUPA , STR1.DTSTA , STR1.CDPRI4 , STR1.CCENV , STR1.CDNPAI , STR1.DDNPA , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_COORD,CIR2.ID_DWR_COORD,0) ID_DWR_COORD , CIR3.DD_HISTO , Coalesce(CIR3.ID_CNL,' ') ID_CNL , CIR3.DD_VALID , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_EDS_BNQ Is Null Then 1 Else 0 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ADR CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CAST(%PMU%.Bin2Char(STR1.IDNUPA) AS VARCHAR(30))=CIR1.ID_DESTI_COM AND CAST(CIR1.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CNL_EMAIL CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(%PMU%.Bin2Char(STR1.IDNUPA) AS VARCHAR(30))=CIR2.ID_DESTI_COM AND CAST(CIR2.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %DTA%.ENVDCO CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_EDS_BNQ AND STR1.IDENV = CIR4.IDENV AND STR1.IDTCCO = CIR4.IDTCCO AND STR1.IDNUPA = CIR4.IDNUPA AND STR1.CDPRI4 = CIR4.CDPRI4 AND STR1.CCENV = CIR4.CCENV AND STR1.DELIEN = CIR4.DELIEN AND CIR4.TK_ACTION = 'I' AND TRUNC(CIR4.RE_CYCLE) = '1900-01-01') INNER JOIN ( select S1.CD_BQE , S1.ID_CNL ,S1.ID_DWR_COORD ,S1.ID_ENV ,S1.ID_TK_COM ,S1.CD_CATG_ENV ,S1.CD_PRIOR_ENV ,S1.DD_VALID ,S1.DD_HISTO ,S1.DF_HISTO from (Select Distinct CD_BQE , ID_CNL ,ID_DWR_COORD ,ID_ENV ,ID_TK_COM ,CD_CATG_ENV ,CD_PRIOR_ENV , DD_VALID ,DD_HISTO ,DF_HISTO ,'1' AS RECENT from %SOC%.ENV_DESTI_TK_COM Union Select Distinct CD_BQE , ID_CNL ,ID_DWR_COORD ,ID_ENV ,ID_TK_COM ,CD_CATG_ENV ,CD_PRIOR_ENV , DD_VALID ,DD_HISTO ,DF_HISTO ,'0' AS RECENT from %WRK%.ENV_DESTI_TK_COM) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_DWR_COORD,S1.ID_ENV,S1.ID_TK_COM,S1.CD_CATG_ENV,S1.CD_PRIOR_ENV,S1.DD_HISTO ORDER BY S1.CD_BQE,S1.ID_DWR_COORD,S1.ID_ENV,S1.ID_TK_COM,S1.CD_CATG_ENV,S1.CD_PRIOR_ENV,S1.DD_HISTO ,S1.RECENT)=1) CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND COALESCE(CIR1.ID_DWR_COORD,CIR2.ID_DWR_COORD,0)=CIR3.ID_DWR_COORD AND CAST(%PMU%.Bin2Char(STR1.IDENV) AS VARCHAR(30))=CIR3.ID_ENV and STR1.IDTCCO = CIR3.ID_TK_COM and STR1.CCENV=CIR3.CD_CATG_ENV and STR1.CDPRI4 = CIR3.CD_PRIOR_ENV and STR1.DELIEN = CIR3.DD_HISTO AND CAST(CIR3.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) where 1=1 and STR1.TK_ACTION <> 'D'
FDEPOE                                            SELECT STR1.CD_EDS_BNQ , STR1.LIBISP , STR1.NOMPRE , STR1.IDEXEF , STR1.NCPTEX , STR1.CRIB , STR1.CDETC , STR1.DTOUV , STR1.DADMA1 , STR1.DTCLOT , STR1.CDPROC , STR1.DT1CHQ , STR1.DTDCHQ , STR1.CPCPT , STR1.CDSUR1 , STR1.CDRLEX , STR1.IDPER0 , STR1.NBEXRL , STR1.CDTYOC , STR1.CCTAU5 , STR1.TXCPOC , STR1.DTDPOC , STR1.DTFPOC , STR1.MTPOCC , STR1.DTNPLD , STR1.DTAPLM , STR1.DTAPLD , STR1.CDOCFM , STR1.CDOCBF , STR1.MTESEC , STR1.MTESEM , STR1.DECAUT , STR1.DLVAL , STR1.CDDEC , STR1.DTOVP , STR1.DTMDD , STR1.CBMDE , STR1.DTDPAS , STR1.MSOLD1 , STR1.MSREL1 , STR1.IFAMP , STR1.CNATCP , STR1.CDDEV , STR1.CDSUSS , STR1.DDRINC , STR1.DTINJO , STR1.DFEXPA , STR1.DTDIB1 , STR1.DTREP1 , STR1.MTPLEU , STR1.CCTAU4 , STR1.TXEURO , STR1.TXCPEU , STR1.MSACIV , STR1.CDOPAP , STR1.CDOPCH , STR1.DDAPU1 , STR1.DFAPU1 , STR1.DDAPU2 , STR1.DFAPU2 , STR1.DDAPU3 , STR1.DFAPU3 , STR1.MPOCBF , STR1.DFOCBF , STR1.CDRBDF , STR1.MPOCFC , STR1.DFOCFC , STR1.CDRFC , STR1.MMYMDB , STR1.MMYMCR , STR1.CCTIRR , STR1.DTCESC , STR1.CDAUT , STR1.CDPDES , STR1.DDPDES , STR1.DFPDES , STR1.MTDAES , STR1.TXFREG , STR1.TXMJES , STR1.TX90NR , STR1.TXAENA , STR1.MTESEN , STR1.MTESNM , STR1.MTESMO , STR1.DDMVT , STR1.MTESFM , STR1.MTESFA , STR1.MPESFA , STR1.DCESFA , STR1.DTEFF , STR1.CBINC , STR1.DDOFIC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , CASE WHEN APROD.CD_FAM_PROD_1 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_2 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_3 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_4 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_5 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_6 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_7 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_8 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_9 = 'RGP10001' THEN 1 WHEN APROD.CD_FAM_PROD_10 = 'RGP10001' THEN 1 ELSE 0 END AS FAM_PROD_RGP10001 , CASE WHEN APROD.CD_FAM_PROD_1 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_2 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_3 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_4 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_5 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_6 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_7 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_8 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_9 = 'RGP10102' THEN 1 WHEN APROD.CD_FAM_PROD_10 = 'RGP10102' THEN 1 ELSE 0 END AS FAM_PROD_RGP10102 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ACCL_CTR_ECD CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTEX=CIR1.NU_CPTE AND CIR1.NU_CPTE IS NOT NULL) LEFT OUTER JOIN %SOC%.ACCL_PROD APROD ON (CIR1.CD_PROD_CIAL = APROD.CD_PROD_CIAL AND APROD.DF_HISTO = CAST('9999-12-31 00:00:00' AS TIMESTAMP(0) FORMAT 'YYYY-MM-DDBHH:MI:SS'))
ICNTRA                                            SELECT DISTINCT STR1.CD_EDS_BNQ, STR1.IDCTRT ID_SOURCE1, CAST(NULL AS BYTE(15)) AS BY_SOURCE1 FROM %DTA%.ICNTRA STR1 WHERE STR1.TK_FLAG IN ('*','R') AND EXISTS(SELECT 1 FROM %TCO%.ID_EDC_TCO CIR1 WHERE STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDELCO=CIR1.BY_SOURCE1) AND EXISTS(SELECT 1 FROM %SOC%.TYP_PROD_ASSU_IARD CIR5 WHERE STR1.CD_EDS_BNQ = CIR5.CD_BQE AND STR1.CDPROD=CIR5.CD_PROD_ASSU_IARD)
GRA012                                            SELECT STR1.CD_EDS_BNQ, STR1.IDGARA, STR1.IDTYGA, STR1.CDCOGA, STR1.DDEFGA, STR1.DFEFGA, STR1.MKGACA, STR1.MIGAIN, STR1.MFINGA, STR1.CDLIGA, STR1.DAINGA, STR1.IEINGA, STR1.NORGGA, STR1.DAREGA, STR1.DSMRGA, STR1.CTTMGA, STR1.MFLVGA, STR1.IDNOGA, STR1.DEEXGA, STR1.DREXGA, STR1.DESIGA, STR1.DRSIGA, STR1.MKVAGA, STR1.DAVAGA, STR1.QQGARA, STR1.CDTKAM, STR1.NOORNO, STR1.LNRED0, STR1.CCDEGA, STR1.CDELGA, STR1.CDCELG, STR1.DPVAGA, STR1.CDRASG, STR1.CTGAR2, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION ,Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 ,Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 ,Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 FROM %DTA%.GRA012 STR1 LEFT JOIN %SOC%.TYP_TYP_GRNT CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDTYGA=CIR1.ID_TYP_GRNT) LEFT JOIN %SOC%.TYP_TYP_DESC_GRNT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CCDEGA=CIR3.CT_DESC_GRNT) LEFT JOIN %SOC%.TYP_TYP_GRNT_BALE2 CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CTGAR2=CIR4.CT_GRNT_BALE2)
GRA228                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPRSC , STR1.CQPRSC , STR1.NOOPPR , STR1.NOPRPR , STR1.IDELCO , STR1.CTIPRE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR4a.ID_DWR_EDC, CIR4b.ID_DWR_EDC) ID_DWR_EDC , COALESCE(CIR5.CSTAVI,0) AS CSTAVI , COALESCE (CIR5.GRA702_IDELCO,'') AS GRA702_IDELCO , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4a.CD_BQE is null and CIR4b.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.GRA228 STR1 LEFT JOIN %SOC%.TYP_CT_PRSCRPTN CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CQPRSC=CIR1.CT_PRSCRPTN) LEFT JOIN %SOC%.TYP_CT_INTVTN_PRSCRPTR CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CTIPRE=CIR2.CT_INTVTN_PRSCRPTR) LEFT JOIN (SELECT DISTINCT CD_BQE, ID_PRSCRPTR FROM %SOC%.CNVNTN_PRSCRPTN ) CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDPRSC=CIR3.ID_PRSCRPTR) LEFT JOIN (SELECT DISTINCT CD_BQE, ID_EDC_CRED, ID_DWR_EDC FROM %SOC%.CRED WHERE TYP_SOURCE_CRED IN ('G', 'L') ) CIR4a ON (STR1.CD_EDS_BNQ=CIR4a.CD_BQE AND STR1.IDELCO=CIR4a.ID_EDC_CRED) LEFT JOIN (SELECT CD_BQE, ID_DWR_EDC, NU_OPERATION_NATIONAL, NU_PRET,ID_PART_GREEN FROM %SOC%.CRED WHERE TYP_SOURCE_CRED IN ('G', 'L') QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_BQE, NU_OPERATION_NATIONAL, NU_PRET,ID_PART_GREEN ORDER BY DF_HISTO desc, ID_DWR_EDC desc) = 1) CIR4b ON (STR1.CD_EDS_BNQ=CIR4b.CD_BQE AND STR1.NOOPPR = CIR4b.NU_OPERATION_NATIONAL AND STR1.NOPRPR = CIR4b.NU_PRET AND STR1.IDPART = CIR4b.ID_PART_GREEN) LEFT JOIN %DE1%.GRA702 CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ AND STR1.NOOPPR=CIR5.NOOPPR AND STR1.NOPRPR=CIR5.NOPRPR )
UNICA_2B                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.IDFLX , STR1.DACRE , STR1.IDCTRX , STR1.IDELCX , STR1.IDELEX , STR1.IDPART , STR1.NCCPTE , STR1.IDEVT , STR1.LIB60 , STR1.DAPASS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , COALESCE(CIR3.ID_DWR,0) ID_DWR_CTR , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.UNICA_2B STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDELCX || 'ECD' = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPART = CIR2.ID_SOURCE1) LEFT JOIN ( select CD_EDS_BNQ, ID_SOURCE1, ID_DWR from %TCO%.ID_CTR_TCO TCO1 Where EXISTS ( Select 1 From %SOC%.CTR_DETENU C Where C.CD_BQE = TCO1.CD_EDS_BNQ AND C.ID_DWR_CTR = TCO1.ID_DWR ) ) CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.IDCTRX = CIR3.ID_SOURCE1)
C818ACT                                           SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CTACO , STR1.IDECV , STR1.CPIMVP , STR1.IDACT , STR1.CGRAT , STR1.MVARF , STR1.MVRRF , STR1.CURAT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ELT_COVENANT CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDECV = CIR1.ID_ELT_COVENANT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ACTN_CRED_COMPLEXE CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDACT = CIR2.ID_ACTN AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_SENS_RATIO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CGRAT = CIR3.CD_SENS_RATIO AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_UNTE_RATIO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CURAT = CIR4.CD_UNTE_RATIO AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
ELCBAM                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(COALESCE(CIR1.ID_SOURCE1,'') AS VARCHAR(30)) AS IDELCO , STR1.DMODIF , STR1.LIBELU , STR1.IDBAM , STR1.CBECBA , STR1.LIEMLL , STR1.CBAMES , STR1.DAACMS , STR1.DADEMS , STR1.CTPRO1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) AS ID_DWR_EDC , COALESCE(CIR2.CFJRS,'') AS CFJRS , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDELCO=CIR1.BY_SOURCE1 AND SUBSTR(CIR1.ID_SOURCE1,31,3)='ECD') LEFT JOIN ( SELECT CD_EDS_BNQ, IDELCO, CFJRS FROM %DE1%.CALMJF WHERE TK_ACTION IN ('I','U') QUALIFY Row_Number() over(partition by CD_EDS_BNQ,IDELCO order by DELIEN desc )=1 ) CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDELCO=CIR2.IDELCO)
GRC816                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDCOV , STR1.CQCOV , STR1.CFCOV , STR1.CTCOV , STR1.IDCCA , STR1.CPOBJC , STR1.DDCOV , STR1.DFCOV , STR1.LNCOV , STR1.CPVCR , STR1.LMINC ,CIR1.LI_NATU_COVENANT , STR1.ZTEVER , STR1.IDACTC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_NATU_COVENANT CIR1 on STR1.CQCOV=CIR1.CD_NATU_COVENANT and STR1.CD_EDS_BNQ=CIR1.CD_BQE LEFT JOIN %SOC%.TYP_CD_PERD_COVENANT CIR2 on STR1.CFCOV=CIR2.CD_PERD_COVENANT and STR1.CD_EDS_BNQ=CIR2.CD_BQE LEFT JOIN %SOC%.TYP_COVENANT CIR3 on STR1.CTCOV=CIR3.CT_COVENANT and STR1.CD_EDS_BNQ=CIR3.CD_BQE LEFT JOIN ( SELECT S1.CD_BQE ,ID_CTR_CADRE ,DD_HISTO ,DF_HISTO FROM (SELECT DISTINCT CD_BQE ,ID_CTR_CADRE ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.CTR_CADRE UNION SELECT DISTINCT CD_BQE ,ID_CTR_CADRE ,DD_HISTO,DF_HISTO ,'0' AS RECENT FROM %WRK%.CTR_CADRE) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_CTR_CADRE ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 ) CIR4 on STR1.IDCCA=CIR4.ID_CTR_CADRE and STR1.CD_EDS_BNQ=CIR4.CD_BQE LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR5 on STR1.CPOBJC=CIR5.CD_STATU_CRED_COMPLEXE and STR1.CD_EDS_BNQ=CIR5.CD_BQE
ASBPRI                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(COALESCE(TCO1.ID_SOURCE1,'') AS VARCHAR(30)) AS IDELCO , STR1.IDASU1 , STR1.CDOFC , STR1.CTSCC , STR1.IDEXPC , STR1.IDPART , STR1.IDPOLA , STR1.LINTS4 , STR1.LNPATR , STR1.NCPTE , STR1.DASIC7 , STR1.CDSTAN , STR1.CDGDP , STR1.IDPRF1 , STR1.CDNAN1 , STR1.DMENCO , STR1.MCDEB2 , STR1.QOOPE1 , STR1.MTVER6 , STR1.MTVAN0 , STR1.DADMA2 , STR1.CADEVI , STR1.CDCRT1 , STR1.CDPRA , STR1.PEREC3 , STR1.DASIC9 , STR1.DHCT0 , STR1.DCLOCT , STR1.MTVINI , STR1.MCTVB , STR1.MCTVN , STR1.MCTVB1 , STR1.MCTVB2 , STR1.MCTVB3 , STR1.DAPRVP , STR1.CBIVP , STR1.CDPERV , STR1.MRPRP , STR1.DHPRO3 , STR1.CBRPP , STR1.MBRUTP , STR1.DHPRO4 , STR1.CDPERP , STR1.LCLAUA , STR1.CBPREB , STR1.CTBENA , STR1.CBAVMP , STR1.MTAVA6 , STR1.CDDEMB , STR1.CBOPTS , STR1.CBOPTD , STR1.CBGARP , STR1.MTARBP , STR1.CDPEAP , STR1.DHPRO5 , STR1.CBSTLO , STR1.DAMEP2 , STR1.MBVRB , STR1.MULATG , STR1.TXFRR5 , STR1.MDCOCM , STR1.NORIBP , STR1.NORIBR , STR1.IDTYOF , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC ,COALESCE(CIR2.ID_DWR_PART,0) ID_DWR_PART , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR5 , CASE WHEN CIR6.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR6 , CASE WHEN CIR7.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR7 , CASE WHEN CIR8.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR8 , CASE WHEN CIR9.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR9 , CASE WHEN CIR10.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR10 , CASE WHEN CIR11.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR11 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1) LEFT JOIN %SOC%.ACCL_CTR_ECD CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and CAST(TCO1.ID_SOURCE1 AS VARCHAR(30))=CIR1.ID_EDC_VEGA AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.PART CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.IDPART=CIR2.ID_PART AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.DEVIS CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE and STR1.CADEVI=CIR3.CD_DEVIS_ISO AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.CPTE CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE and STR1.NCPTE=CIR4.NU_CPTE AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_ASSUR CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE and STR1.IDASU1=CIR5.ID_ASSUR AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_OPTN_FISCAL_ASSU CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_BQE and STR1.IDTYOF=CIR6.ID_TYP_OPTN_FISCAL AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.PRODTR_ASSU_VIE CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_BQE and TRIM(STR1.CDPRA)=TRIM(CIR7.ID_PRODTR_ASSU_VIE) AND CAST(CIR7.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR7.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_MODE_GST_ASSU CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_BQE and STR1.CDGDP=CIR8.CD_MODE_GST AND CAST(CIR8.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR8.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_CATG_OFR_ASSU CIR9 ON (STR1.CD_EDS_BNQ=CIR9.CD_BQE and STR1.CDOFC=CIR9.CD_CATG_OFR_ASSU AND CAST(CIR9.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR9.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_STATU_CTR_ASSU CIR10 ON (STR1.CD_EDS_BNQ=CIR10.CD_BQE and STR1.CDSTAN=CIR10.CD_STATU_PRNCP AND CAST(CIR10.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR10.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_PRFL_GST_ASSU CIR11 ON (STR1.CD_EDS_BNQ=CIR11.CD_BQE and STR1.IDPRF1=CIR11.CD_PRFL_GST_ASSU AND CAST(CIR11.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR11.DF_HISTO AS DATE) )
TYP_MTF_IN_REL_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
PDI0VU13                                          SELECT STR1.CD_EDS_BNQ , STR1.CDENR2 , STR1.NUSEQ1 , STR1.CDOPE , STR1.CDBCF1 , STR1.CDBCF2 , STR1.CDAPPA , STR1.DTRA , STR1.CDENR5 , STR1.NUSEQ9 , STR1.FILLER_2 , STR1.NUMCR1 , STR1.DEEFM1 , STR1.DADAC , STR1.ZB001 , STR1.NUCOT , STR1.RFCCS , STR1.NBPAR6 , STR1.MTCVAA , STR1.MCBCAP , STR1.MTCVAB , STR1.MCROR , STR1.QCREX , STR1.FILLERA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(CIR2.DFCOM2,CAST('1900-01-01' AS DATE)) DFCOM2 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When REJ1.CD_BQE is null then 0 else 1 End Row_found_Rej1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NUCOT=CIR1.NU_CPTE) LEFT OUTER JOIN %DE1%.PDI0VU05 CIR2 ON (STR1.NUMCR1=CIR2.NUMCR1 and STR1.NUCOT=CIR2.NUCOT and CIR2.TK_ACTION in ('I','U')) LEFT OUTER JOIN %REJ%.LIST_NUCOT_ECART REJ1 ON (STR1.CD_EDS_BNQ = REJ1.CD_BQE AND STR1.NUCOT = REJ1.NU_COT AND REJ1.OBJECT_CODE ='D309770')
UNICA_4A                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.LISTS , STR1.CDOFFR , STR1.LNOFFR , STR1.CDUNIB , STR1.LIUNIB , STR1.CDBESO , STR1.LIBESO , STR1.CDRFM1 , STR1.LIRFM1 , STR1.CDRFM2 , STR1.LIRFM2 , STR1.CDRFM3 , STR1.LIRFM3 , STR1.CDFMOF , STR1.LIFMOF , Trim(STR1.CDCDO) CDCDO , STR1.LICDO , STR1.CDACDI , STR1.LIACTD , trim(leading '0' from STR1.CDPRC1) CDPRC1 , STR1.CDO1P1 , STR1.CDC1P1 , STR1.CDO2P1 , STR1.CDC2P1 , STR1.CDO3P1 , STR1.CDC3P1 , trim(leading '0' from STR1.CDPRC2) CDPRC2 , STR1.CDO1P2 , STR1.CDC1P2 , STR1.CDO2P2 , STR1.CDC2P2 , STR1.CDO3P2 , STR1.CDC3P2 , trim(leading '0' from STR1.CDPRC3) CDPRC3 , STR1.CDO1P3 , STR1.CDC1P3 , STR1.CDO2P3 , STR1.CDC2P3 , STR1.CDO3P3 , STR1.CDC3P3 , STR1.CDFMIG , STR1.LIFMIG , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
IARFKA10                                          SELECT DISTINCT STR1.CD_EDS_BNQ, STR1.KA10_IDCTRT ID_SOURCE1, CAST(NULL AS BYTE(15)) AS BY_SOURCE1 FROM %DTA%.IARFKA10 STR1 WHERE STR1.TK_FLAG IN ('*','R') AND EXISTS(SELECT 1 FROM %SOC%.TYP_PROD_ASSU_IARD CIR5 WHERE STR1.CD_EDS_BNQ = CIR5.CD_BQE AND STR1.CDPROD=CIR5.CD_PROD_ASSU_IARD)
CONCUR                                            SELECT STR1.CD_EDS_BNQ , STR1.IDETC , STR1.LIETCO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
CERPAR                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCCO AS IDCCO_BYTE , CAST(COALESCE(CIR1.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDCCO , STR1.IDPART , STR1.CDPRIA , STR1.DELIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , COALESCE(CIR1.ID_DWR,0) ID_DWR_CRCL_COM , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CRCL_COM_TCO CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDCCO =CIR1.BY_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART=CIR2.ID_SOURCE1) where 1=1 and STR1.TK_ACTION<>'D'
TIMTBA04                                          SELECT STR1.CD_EDS_BNQ , STR1.CEETB9 , STR1.SIRET9 , STR1.NUSQM9 , STR1.TYMAT9 , STR1.TYMIB9 , STR1.TYPAI9 , STR1.CEREM9 , STR1.CEAPP9 , STR1.DTINS9 , STR1.DTRET9 , STR1.NBFER9 , STR1.NBCER9 , STR1.LRMAT , STR1.NUSCM9 , STR1.DESEC9 , STR1.NURIB , STR1.NOBQE , STR1.TYTAL , STR1.MHLOM9 , STR1.DDLOC9 , STR1.DFLOC9 , STR1.TYRLM9 , STR1.PERCM , STR1.PERRM , STR1.PEDCM , STR1.NUMCM9 , STR1.DEACM9 , STR1.DMACM9 , STR1.NBJDS9 , STR1.NBJDS8 , STR1.DMENR9 , STR1.CDMAC , STR1.TYSEGF , STR1.CDTIGF , STR1.TYSEAC , STR1.CD3DS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.COMRC_TIM_ADHR CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.SIRET9 = CIR1.NU_SIRET AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
PROD_CIAL_GRP_CHOIX                               SELECT STR1.CD_EDS_BNQ , STR1.CD_PROD_CIAL , STR1.CD_GRP_CHOIX , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_PROD_CIAL is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_GRP_CHOIX is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_PROD_CIAL FROM %SOC%.PROD_CIAL) CIR1 ON (STR1.CD_PROD_CIAL=CIR1.CD_PROD_CIAL) LEFT JOIN (Select DISTINCT CD_GRP_CHOIX FROM %SOC%.GRP_CHOIX) CIR2 ON (STR1.CD_GRP_CHOIX=CIR2.CD_GRP_CHOIX)
BRUINA88                                          SELECT STR1.CD_EDS_BNQ , STR1.CDZDF , STR1.CDZIF , STR1.CDANUF , STR1.IDEXEF , STR1.CDBUR1 , STR1.NCPTEI , STR1.CDVSC , STR1.LIBVA2 , STR1.MTNOMA , STR1.FILLER_2 , STR1.QTTIT1 , STR1.DADCDD , STR1.MVDCO2 , STR1.MOVAL4 , STR1.DDECH3 , STR1.CTCOT , STR1.ZB002 , STR1.FILLERA , STR1.DASOU2 , STR1.DATCE , STR1.DFOPER , STR1.MTACQ4 , STR1.FILLERB , STR1.LNINC , STR1.NCPTEX , STR1.CADEVI , STR1.FILLERC , STR1.CCATVA , STR1.FILLERD , STR1.CSCDDC , STR1.CPRSP , STR1.CDNAN , STR1.CFORV1 , STR1.CDNANP , STR1.CUVAL , STR1.FILLERE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTEI=CIR1.NU_CPTE)
IARFKA1P                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.NCPTPA , STR1.KA10_IDCTRT , STR1.KA1P_CDTYHA , STR1.KA1P_CDTYRE , STR1.KA1P_NBPIR1 , STR1.KA1P_CDQUAL , STR1.KA1P_QTENC3 , STR1.KA1P_CBGDEL , STR1.KA1P_CDNVOL , STR1.KA1P_CPOST1 , STR1.KA1P_LNPAT4A , STR1.KA1P_LPENFSA , STR1.KA1P_DASTD0A , STR1.KA1P_LNPAT4B , STR1.KA1P_LPENFSB , STR1.KA1P_DASTD0B , STR1.KA1P_LNPAT4C , STR1.KA1P_LPENFSC , STR1.KA1P_DASTD0C , STR1.KA1P_LNPAT4D , STR1.KA1P_LPENFSD , STR1.KA1P_DASTD0D , STR1.KA1P_LNPAT4E , STR1.KA1P_LPENFSE , STR1.KA1P_DASTD0E , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CTR_IARD , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.KA10_IDCTRT = TCO1.ID_SOURCE1)
TDSCK109                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.NREM1 , STR1.LNDOR , STR1.NCPTE , STR1.IDELCK , STR1.NUALL , STR1.CDORG , STR1.CDBDES , STR1.FILLER171 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
COCL_CONSO                                        SELECT STR1.CD_EDS_BNQ , STR1.ID_STRUCT_CONSO , STR1.ID_TECHN_CONSO , STR1.ID_PART_DU_CONSO , STR1.SITE_INET_CONSO , STR1.DT_DER_PSAG_CAXC , STR1.TOP_ELIGB_CAXC , STR1.SOURCE_MAJ_CONSO , STR1.TS_MAJ_CONSO , STR1.ID_AGT_MAJ_CONSO , STR1.CD_CNL_DSTRB_MAJ_CONSO , STR1.ID_STRUCT_MAJ_CONSO , STR1.CD_MTF_HRS_CHAMP , STR1.LIB_MTF_HRS_CHAMP_COMPL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.ID_DWR AS ID_DWR_PART , CIR2.LI_HORS_CHAMP_ACTI , CIR2.CD_HORS_CHAMP_ACTI , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.ID_PART_DU_CONSO=CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_HORS_CHAMP_ACTI CIR2 ON (STR1.ID_STRUCT_CONSO=CIR2.CD_BQE AND STR1.CD_MTF_HRS_CHAMP=CIR2.CD_HORS_CHAMP_ACTI AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
GRP_CHOIX                                         SELECT STR1.CD_EDS_BNQ , STR1.CD_GRP_CHOIX , STR1.ID_OFR_BQR , STR1.APPLTN_CIALE_GRP_CHOIX , STR1.CD_PRES_GRP_CHOIX_OFR , STR1.NB_MINI_CHOIX_CLI_GRP , STR1.NB_MAXI_CHOIX_CLI_GRP , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.ID_OFR_BQR is Null Then 0 Else 1 END Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT ID_OFR_BQR FROM %SOC%.OFR) CIR1 ON ( STR1.ID_OFR_BQR=CIR1.ID_OFR_BQR)
T5R05P                                            SELECT STR1.CD_EDS_BNQ , STR1.IDLIMI IDLIMI_BYTE , CAST(%PMU%.Bin2Char(STR1.IDLIMI) AS VARCHAR(30)) AS IDLIMI , STR1.MPLIMI , STR1.DDVAL , STR1.DFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRCO_DELTA_CREANCE                                SELECT STR1.IDEXEY , STR1.DFCOLT , STR1.IDELCH , STR1.CQOPE , STR1.CQOPE2 , STR1.NOPPCA , STR1.NOPPCB , STR1.NOPPCC , STR1.NOPPCD , STR1.NOPPCE , STR1.NOPPCF , STR1.NOPPCG , STR1.NOPPCH , STR1.NOPPCJ , STR1.NOPPCK , STR1.DCARR7 , STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
CPTEBT                                            SELECT STR1.CD_EDS_BNQ , STR1.NCPTE , STR1.DDCOMP , STR1.DFCOMP , STR1.IDEXELST , STR1.TYPCPTE , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.CPTETRG , STR1.CUSACPTE , STR1.CDGDM1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.ID_DWR_EDS AS ID_DWR_EDS FROM %DTA%.CPTEBT STR1 LEFT JOIN %SOC%.ELT_DE_STRUCT CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDEXELST = CIR1.ID_EXT_EDS AND ID_TYP_EDS = 6 AND CIR1.DD_VALID <= STR1.DFCOMP AND STR1.DFCOMP <= CIR1.DF_VALID AND CIR1.DD_HISTO <= STR1.DT_ELIG AND STR1.DT_ELIG < CIR1.DF_HISTO)
DGCZ28                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.FILLER , STR1.LIACA , STR1.DADMAJ , STR1.DDVAL , STR1.HFVAL , STR1.DFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CLI_CIAL , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.DGCZ28 STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCLC= TCO1.ID_SOURCE1)
DGCZ15                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.LNCLC1 , STR1.CPMAN , STR1.CPCES , STR1.DICES , STR1.CPCCC , STR1.DICCC , STR1.IDTCC , STR1.CPCIB , STR1.IDPART , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.DADMAJ , STR1.CPPROS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_CLI_CIAL , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_BQE, CT_CLI_CIAL FROM %SOC%.TYP_CLI_CIAL) CIR1 ON(STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDTCC = CIR1.CT_CLI_CIAL) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON(STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPART= CIR2.ID_SOURCE1) LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON(STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCLC = TCO1.ID_SOURCE1)
GRA083                                            SELECT STR1.CD_EDS_BNQ ,STR1.NOOPPR ,STR1.NOPRPR ,STR1.IDGARA ,STR1.DDGARA ,STR1.DFGARA ,STR1.QQGARA ,STR1.MTGARA ,STR1.CSTAV6 ,STR1.CCPCAU ,STR1.ZTEVER ,STR1.CDMUBI ,STR1.IDGDEC ,STR1.DAVAGA ,STR1.DPVAGA ,STR1.MTASGA ,STR1.MTRVGA ,STR1.MVEXGA ,STR1.CDCVOR ,STR1.CTREVG ,STR1.CDREVG ,STR1.CDOPEX ,STR1.DMVEXP ,STR1.DFVEXP ,STR1.MTAVDC ,STR1.TXDCGA ,STR1.MTRVG1 ,STR1.MTRVG2 ,STR1.DBVAGA ,STR1.MPCAUT ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,CIR1.ID_DWR_EDC ,CIR1.ID_EDC_CRED ,CIR1.CD_STATU_PRET , COALESCE(CIR7.CSTAVI,0) AS CSTAVI , COALESCE(CIR7.GRA702_IDELCO,'') AS GRA702_IDELCO ,CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END as Row_Found_CIR1 ,CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END as Row_Found_CIR2 ,CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END as Row_Found_CIR3 ,CASE WHEN CIR4.CD_BQE IS NULL THEN 0 ELSE 1 END as Row_Found_CIR4 ,CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 END as Row_Found_CIR5 ,CASE WHEN CIR6.CD_BQE IS NULL THEN 0 ELSE 1 END as Row_Found_CIR6 ,CASE WHEN CIR7.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END as Row_Found_CIR7 FROM %DTA%.GRA083 STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.NOOPPR = CIR1.NU_OPERATION_NATIONAL AND STR1.NOPRPR = CIR1.NU_PRET AND CIR1.TYP_SOURCE_CRED IN ('G', 'L')) LEFT JOIN %SOC%.TYP_LIEN_PRT_CAUTION CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.CCPCAU = CIR2.CD_LIEN_PRT_CAUTION) LEFT JOIN %SOC%.TYP_AVNC_INSTRCTN_GRNT CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_BQE AND STR1.CSTAV6 = CIR3.CD_AVNC_INSTRCTN_GRNT) LEFT JOIN %SOC%.TYP_MODE_RVLRSN_GRNT CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_BQE AND STR1.CTREVG = CIR4.CD_MODE_RVLRSN_GRNT) LEFT JOIN %SOC%.TYP_REGLE_RVLRSN_GRNT CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_BQE AND STR1.CDREVG = CIR5.CD_REGLE_RVLRSN_GRNT) LEFT JOIN %SOC%.TYP_OPTN_VAL_EXPRT CIR6 ON (STR1.CD_EDS_BNQ = CIR6.CD_BQE AND STR1.CDOPEX = CIR6.CD_OPTN_VAL_EXPRT) LEFT JOIN %DE1%.GRA702 CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_EDS_BNQ AND STR1.NOOPPR=CIR7.NOOPPR AND STR1.NOPRPR=CIR7.NOPRPR )
EIACUD01                                          SELECT STR1.CD_EDS_BNQ , STR1.NOREGL, STR1.DFFCBL, STR1.NCPTKS, STR1.DDPER4, STR1.MIDEBF, STR1.MIDEBG, STR1.MIDEBH, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION, CASE WHEN (Substr(STR1.NCPTKS,1,1)) = 'F' THEN Substr(STR1.NCPTKS,2,11) ELSE Substr(STR1.NCPTKS,1,11) END AS NCPTKS_FORM, CIR1.ID_DWR_EDC, CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT CD_BQE, NU_CPTE, ID_DWR_EDC, DD_VALID, DF_VALID, DD_HISTO, DF_HISTO FROM %SOC%.ECD_CPTE ) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CAST(NCPTKS_FORM AS NUMERIC) =CIR1.NU_CPTE AND CIR1.DD_VALID <=STR1.DT_ELIG AND STR1.DT_ELIG < CIR1.DF_VALID AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) where 1=1 AND (Trim(Substr(STR1.NOREGL,4,1)))=2
OPTN_CHOIX_SUR_OPTN                               SELECT STR1.CD_EDS_BNQ , STR1.CD_OPTN , STR1.CD_CHOIX_SUR_OPTN , STR1.CD_PRES_CHOIX_OPTN , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_OPTN is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_CHOIX_SUR_OPTN is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_OPTN FROM %SOC%.OPTN ) CIR1 ON (STR1.CD_OPTN=CIR1.CD_OPTN) LEFT JOIN (Select DISTINCT CD_CHOIX_SUR_OPTN FROM %SOC%.CHOIX_SUR_OPTN) CIR2 ON (STR1.CD_CHOIX_SUR_OPTN=CIR2.CD_CHOIX_SUR_OPTN)
GRCO_ROMP_PROV                                    SELECT STR1.IDSTU, STR1.DTARRI, STR1.LNSYGS, STR1.IDPRET, STR1.CIDENW, STR1.CBBHB, STR1.CBARRP, STR1.ZAAPCO, STR1.CBACTD, STR1.CTCONR, STR1.CCTIT6, STR1.IDOMO, STR1.CDTPO7, STR1.CDTPO8, STR1.CDBUC, STR1.CDSCCL, STR1.TXPDDA, STR1.CDBUC2, STR1.MTPROF, STR1.MTPROI, STR1.MTPROT, STR1.CSPROV, STR1.IDELCH, STR1.IDEXEY, STR1.DCARR7, STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
DGXG33                                            SELECT STR1.CD_EDS_BNQ , STR1.IDMST , STR1.IDES , STR1.IDTYWO , STR1.IDSDC , STR1.NURIM , STR1.LNMST , STR1.IDTYPO , STR1.CPSTRT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDS,0) ID_DWR_EDS , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ELT_DE_STRUCT CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND trim(STR1.IDES) = trim(CIR1.ID_EXT_EDS) AND CIR1.ID_TYP_EDS = '6' AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
PARTP                                             SELECT STR1.CD_EDS_BNQ , STR1.DTMODS , STR1.DTCREA , STR1.DTMOD , STR1.IDUTIL , STR1.SBUTIL , STR1.CRABO1 , STR1.NOMMOD , STR1.NOMPAR , STR1.TYPPAR , STR1.DESPAR , STR1.VALNUM , STR1.VALCAR , STR1.CRABO2 , STR1.RE_CYCLE , STR1.DT_ELIG , CURRENT_TIMESTAMP(0) DD_HISTO , CURRENT_TIMESTAMP(0) DF_HISTO , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRCO_TIERS_GP_RISQUE                              SELECT STR1.CD_EDS_BNQ , STR1.IDGRRI , STR1.DFCOLT , STR1.IDPOCE , STR1.CBTEGR , STR1.CBTEGN , STR1.CDSTGO , STR1.DCARR7 , STR1.ZCNUFD , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_PART , CIR2.ID_DWR_GRP_RISQ ID_DWR_GRP_RISQ , CIR3.CTFIPE CTFIPE , CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_TCO1 , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN TCO2.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_TCO2 , CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDPOCE=TCO1.ID_SOURCE1) LEFT JOIN %SOC%.PART CIR1 ON (CIR1.CD_BQE=TCO1.CD_EDS_BNQ AND TCO1.ID_DWR=CIR1.ID_DWR_PART AND CIR1.DF_HISTO = '9999-12-31 00:00:00') AND CIR1.DT_CREAT_PART <= TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CIR1.DT_CLOT_PART LEFT JOIN %TCO%.ID_GRP_RISQ_TCO TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDGRRI=TCO2.ID_SOURCE1) LEFT JOIN %SOC%.GRP_RISQ_MENS CIR2 ON (CIR2.CD_BQE=TCO2.CD_EDS_BNQ AND TCO2.ID_DWR = CIR2.ID_DWR_GRP_RISQ) AND CIR2.DD_PE = TD_MONTH_BEGIN(ADD_MONTHS(STR1.DT_ELIG,-1)) LEFT JOIN %DTA%.GRCO_GP_RISQUE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDGRRI=CIR3.IDGRRI AND STR1.DCARR7 = CIR3.DCARR7 ) LEFT JOIN %SOC%.TYP_FINL_GRP_RISQ CIR4 ON (CIR4.CD_BQE=CIR3.CD_EDS_BNQ AND CIR3.CTFIPE=CIR4.CD_FINL_GRP_RISQ AND CAST(CIR4.DD_HISTO AS DATE)<= TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CAST (CIR4.DF_HISTO AS DATE))
TYP_COMPLEMENTARITE_CST                           SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
BRUXSM03                                          SELECT STR1.CD_EDS_BNQ , STR1.DICREV , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END AS Row_Found_CIR1 , CASE WHEN CIR5.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR5 , CASE WHEN substr(STR1.IDPART, LENGTH(STR1.IDPART) -3) = 'NIC' THEN 0 ELSE 1 END AS IDPART_NIC , CAST(STR1.CDBUR AS INTEGER) CDBUR1 , CASE WHEN APROD.CD_FAM_PROD_1 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_2 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_3 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_4 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_5 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_6 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_7 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_8 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_9 = 'RGP10021' THEN 1 WHEN APROD.CD_FAM_PROD_10 = 'RGP10021' THEN 1 ELSE 0 END AS FAM_PROD_RGP10021 , CIR2.CDTRTA , CIR2.CDTRTF , CIR2.CDTRTG , CIR2.DAPRE , CIR2.DATE8N , CIR2.DATRF1 , CIR2.DDSOU0 , CIR2.DDSOU1 , CIR2.DDSOU2 , CIR2.DDSOU3 , CIR2.DDSOU4 , CIR2.DIEVE1 , CIR2.IDEXEF , CIR2.MTSOU , CIR2.NBFEU , CIR2.NBFEU1 , CIR2.NBFEU2 , CIR2.NBFEU3 , CIR4.CADEVI , CIR4.CDETA8 , CIR4.CDETAP , CIR4.CDETAV , CIR4.CDETAZ , CIR4.CDETB9 , CIR4.CDGBDC , CIR4.CDGBDE , CIR4.CDGBDI , CIR4.CDGBDP , CIR4.CDGBDV , CIR4.CDMODA , CIR4.CLRIBI , CIR4.CLRIBP , CIR4.CLRIBV , CIR4.CQCONI , CIR4.CUECT1 , CIR4.DASOU1 , CIR4.DFBLV2 , CIR4.DHECH4 , CIR4.IDEXEC , CIR4.NCLERI AS NCLERI1 , CIR4.NCPTE2 , CIR4.NCPTE3 , CIR4.NCPTEI , CIR4.NCPTEX , CIR4.NCPTEY , CIR4.NUCOT1 AS NUCOT1 , CIR4.NUCRS9 , CIR4.PECONC , CIR5.MKCAQ2_S , CIR5.MICAPA_S , CIR6.CDANUF , CIR6.IDEXEF AS IDEXEF_89 , CIR6.MCCES3 , CIR6.MOVAL4 , CIR6.MSPEA6 , CIR6.MSPMV5 , CIR6.MSPMV6 , CIR6.MTVERQ , COALESCE(CIR1.CD_PROD_CIAL,0) CD_PROD_CIAL , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(CIR3.MT_VERS_PRIODQ_CUMUL,0) AS MT_VERS_PRIODQ_CUMUL , STR1.CDBLV , STR1.CDBUR , STR1.DT_ELIG , STR1.IDCTR5 , STR1.NUADHA , STR1.RE_CYCLE , STR1.TK_ACTION , STR1.TK_CHANGE , STR1.TK_CREATE , STR1.TK_FLAG , trim(STR1.DDDOSP) DDDOSP , trim(STR1.DFCOM1) DFCOM1 FROM %DTA%.BRUXSM03 STR1 LEFT OUTER JOIN %SOC%.ACCL_CTR_ECD CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDCTR5=CIR1.NU_CPTE) LEFT OUTER JOIN %SOC%.ACCL_PROD APROD ON (CIR1.CD_PROD_CIAL = APROD.CD_PROD_CIAL AND APROD.DF_HISTO = CAST('9999-12-31 00:00:00' AS TIMESTAMP(0) FORMAT 'YYYY-MM-DDBHH:MI:SS')) LEFT OUTER JOIN %DE1%.BRUIK602 CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDCTR5=CIR2.NCPTEI and CIR2.TK_ACTION in ('I','U')) LEFT OUTER JOIN (SELECT CD_BQE, ID_DWR_EDC,DD_PE, SUM(MT_VERS_PRIODQ) AS MT_VERS_PRIODQ_CUMUL FROM %SOC%.EPRGN_BQR_FEUILT GROUP BY CD_BQE, ID_DWR_EDC,DD_PE) CIR3 ON (CIR1.CD_BQE=CIR3.CD_BQE and CIR1.ID_DWR_EDC=CIR3.ID_DWR_EDC and TD_MONTH_BEGIN(ADD_MONTHS(CAST (STR1.DT_ELIG AS DATE),-1))=CIR3.DD_PE) LEFT OUTER JOIN %DE1%.FREMLO03 CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ and STR1.IDCTR5=CIR4.NUCOT1 and CIR4.TK_ACTION in ('I','U') AND TD_MONTH_BEGIN(CIR4.DCARR1)=TD_MONTH_BEGIN(ADD_MONTHS(CAST(STR1.DT_ELIG AS DATE),-1))) LEFT OUTER JOIN (SELECT CD_EDS_BNQ,NUCOT1,IDEXEC,DCARR1,SUM(CASE WHEN (TRYCAST(SUBSTR(MKCAQ2,5,18) as FLOAT))IS NOT NULL THEN SUBSTR(MKCAQ2,5,18)*10**(-SUBSTR(MKCAQ2,4,1))*(CASE WHEN SUBSTR(MKCAQ2,23,1)='C' THEN 1 WHEN SUBSTR(MKCAQ2,23,1)='D' THEN -1 ELSE 0 END) ELSE 0 END ) AS MKCAQ2_S, SUM(CASE WHEN (TRYCAST(SUBSTR(MICAPA,5,18) as FLOAT))IS NOT NULL THEN SUBSTR(MICAPA,5,18)*10**(-SUBSTR(MICAPA,4,1))*(CASE WHEN SUBSTR(MICAPA,23,1)='C' THEN 1 WHEN SUBSTR(MICAPA,23,1)='D' THEN -1 ELSE 0 END) ELSE 0 END ) AS MICAPA_S FROM %DE1%.FREMLO04 GROUP BY CD_EDS_BNQ,NUCOT1,IDEXEC,DCARR1 WHERE NUCOT1 IS NOT NULL and TK_ACTION in ('I','U')) CIR5 ON (CIR4.CD_EDS_BNQ=CIR5.CD_EDS_BNQ and CIR4.NUCOT1=CIR5.NUCOT1 AND CIR4.IDEXEC=CIR5.IDEXEC AND TD_MONTH_BEGIN(cast ( CIR5.DCARR1 - 19000000 as date))=TD_MONTH_BEGIN(ADD_MONTHS(CAST(STR1.DT_ELIG AS DATE),-1))) LEFT OUTER JOIN %DE1%.BRUINA89 CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_EDS_BNQ and STR1.IDCTR5=CIR6.NCPTEI and CIR6.TK_ACTION in ('I','U'))
EDC_CRED_EXPOSE_MENS                              SELECT DISTINCT STR1.CD_BQE AS CD_EDS_BNQ , STR1.DD_PE , STR1.ID_DWR_CREANC_EXPOSE , STR1.CD_NATU_RISQ_CONTREPARTIE as CD_NATU_RISQ_CONTREPARTIE_ED , 1 AS REF_EDC FROM %WRK%.%ObjectNameFrom% STR1 Order by CD_EDS_BNQ,DD_PE,ID_DWR_CREANC_EXPOSE
PORTFL                                            SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDPORT , STR1.DPORT , STR1.DDVAL , STR1.DFVAL , STR1.LND2PO , STR1.IDTYPO , STR1.IDPO , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_PORTEF , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN TCO1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN %DE1%.TYPORT CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDTYPO=CIR1.IDTYPO and CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_PORTEF_TCO TCO1 ON(STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDPORT=TCO1.ID_SOURCE1)
FAIT_UTI                                          SELECT DISTINCT ID_LIST_IMPORT , CD_BQE , 1 AS FAIT_EXIST FROM %WRK%.FAIT_UTI
D2R13                                             SELECT STR1.CD_EDS_BNQ , STR1.NCPTE , STR1.IDLIMI IDLIMI_BYTE , CAST(%PMU%.Bin2Char(STR1.IDLIMI) AS VARCHAR(30)) AS IDLIMI , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.LIM_DCVT_CSCA CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CAST(%PMU%.Bin2Char(STR1.IDLIMI) AS VARCHAR(30))=CIR1.ID_LIM_DCVT ) LEFT JOIN %SOC%.CPTE CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(STR1.NCPTE AS BIGINT)=CIR2.NU_CPTE AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
ESPBDBDF                                          SELECT Distinct STR1.CD_EDS_BNQ , STR1.CDREGL , STR1.IDTPE , STR1.DDPER7 , STR1.CDRSY1 , STR1.CDRSY2 , STR1.CDRSY3 , STR1.CDRSY4 , STR1.CDRSY5 , STR1.CDRSY6 , STR1.CDRSY7 , STR1.CDRSY8 , STR1.MTAGG1 , STR1.MTAGG2 , STR1.MTAGG3 , STR1.MTAGG4 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , STR2.MTAGG1_S , STR2.MTAGG2_S , STR2.MTAGG3_S , STR2.MTAGG4_S , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 Inner join ( Select CD_EDS_BNQ,CDRSY2,DDPER7,CDRSY1,CDRSY3, SUM(MTAGG1) AS MTAGG1_S , SUM(MTAGG2) AS MTAGG2_S , SUM(MTAGG3) AS MTAGG3_S , SUM(MTAGG4) AS MTAGG4_S From %DTA%.%ObjectNameFrom% Group by CD_EDS_BNQ,CDRSY2,DDPER7,CDRSY1,CDRSY3 ) STR2 On STR1.CD_EDS_BNQ=STR2.CD_EDS_BNQ AND STR1.DDPER7=STR2.DDPER7 AND STR1.CDRSY2=STR2.CDRSY2 AND STR1.CDRSY3=STR2.CDRSY3 AND STR1 .CDRSY1=STR2.CDRSY1 LEFT JOIN %SOC%.TYP_AGT_ECON CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CDRSY2=CIR1.CD_AGT_ECON AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
TYP_MTF_SORT_DFT_CST_2                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
HISBT2                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDGRRI , STR1.IDENTR IDENTR_BYTE , CAST(CASE WHEN CIR5.CD_EDS_BNQ is not null Then CIR5.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDENTR) end AS VARCHAR(30)) AS IDENTR , STR1.NOSIRI , STR1.IDPART , STR1.DCARRC , STR1.DANOT3 , STR1.DAHEU6 , STR1.NOTNOR , STR1.MTCR51 , STR1.QTEFF5 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR, 0) ID_DWR_PART_CIR1 , COALESCE(CIR2.ID_DWR_PART, 0) ID_DWR_PART_CIR2 , COALESCE(CIR3.ID_DWR_ENTR, 0) ID_DWR_ENTR_CIR3 , CAST(COALESCE(CIR4.ID_SOURCE1, '') AS CHAR(30)) ID_SOURCE1_CIR4 , COALESCE(CIR5.ID_DWR, 0) ID_DWR_ENTR_CIR5 , COALESCE(CIR6.ID_DWR_ENTR, 0) ID_DWR_ENTR_CIR6 , COALESCE(CIR7.ID_DWR_PART, 0) ID_DWR_PART_CIR7 , CAST(COALESCE(CIR8.ID_SOURCE1, '') AS CHAR(15)) ID_SOURCE1_CIR8 , CASE WHEN TRIM(IDPART) = '' THEN 1 ELSE 0 END IDPART_VIDE , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 , Case When CIR7.CD_BQE is null then 0 else 1 End Row_Found_CIR7 , Case When CIR8.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR8 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT OUTER JOIN %SOC%.PART CIR2 ON ( CIR2.ID_DWR_PART=CIR1.ID_DWR AND CIR1.CD_EDS_BNQ = CIR2.CD_BQE AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.PART_POSSED_ENTR CIR3 ON (CIR1.CD_EDS_BNQ = CIR3.CD_BQE AND CIR1.ID_DWR = CIR3.ID_DWR_PART AND CIR3.DD_HISTO <= STR1.DCARRC AND CIR3.DF_HISTO > STR1.DCARRC) LEFT OUTER JOIN %TCO%.ID_ENTR_TCO CIR4 ON (CIR3.CD_BQE = CIR4.CD_EDS_BNQ AND CIR3.ID_DWR_ENTR = CIR4.ID_DWR ) LEFT OUTER JOIN %TCO%.ID_ENTR_TCO CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_EDS_BNQ AND STR1.IDENTR = CIR5.BY_SOURCE1) LEFT OUTER JOIN %SOC%.ENTR CIR6 ON ( CIR6.ID_DWR_ENTR=CIR5.ID_DWR AND CIR5.CD_EDS_BNQ = CIR6.CD_BQE AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.PART_POSSED_ENTR CIR7 ON(CIR5.CD_EDS_BNQ = CIR7.CD_BQE AND CIR5.ID_DWR = CIR7.ID_DWR_ENTR AND CIR7.DD_HISTO <= STR1.DCARRC AND CIR7.DF_HISTO > STR1.DCARRC) LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR8 ON (CIR7.CD_BQE = CIR8.CD_EDS_BNQ AND CIR7.ID_DWR_PART = CIR8.ID_DWR)
PARTEL                                            Select DISTINCT CD_EDS_BNQ , case when CIR3.CD_BQE is not null and CIR4.CD_BQE is not null then 'TEL'||Trim(CAST(CAST(CAST(STR1.CTYTEL AS format 'Z(I)') AS format '9(1)') AS CHAR(1)))||Trim(CAST(CAST(CAST(STR1.CSITEL AS format 'Z(I)') AS format '9(1)') AS CHAR(1)))||trim(STR1.NUTEPA) Else case when CIR3.CD_BQE is not null and CIR4.CD_BQE is null then 'TEL'||'1'||Trim(CAST(CAST(CAST(STR1.CSITEL AS format 'Z(I)') AS format '9(1)') AS CHAR(1)))||trim(STR1.NUTEPA) Else case when CIR3.CD_BQE is null and CIR4.CD_BQE is not null then 'TEL'||Trim(CAST(CAST(CAST(STR1.CTYTEL AS format 'Z(I)') AS format '9(1)') AS CHAR(1)))||'1'||trim(STR1.NUTEPA) Else 'TEL'||'1'||'1'||trim(STR1.NUTEPA) End end end ID_SOURCE1 ,CAST(null AS BYTE(15))BY_SOURCE1 FROM %DTA%.PARTEL STR1 LEFT JOIN %SOC%.TYP_SITUA_TEL CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE and STR1.CSITEL=CIR3.CD_SITUA_TEL AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_TEL CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE and STR1.CTYTEL=CIR4.CT_TEL AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
TYP_NATO_CST                                      SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_CLASS_RISQ_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TIMTBA12                                          SELECT distinct STR1.CD_EDS_BNQ , STR1.CEETB9 , STR1.SIRET9 , STR1.NUSQM9 , STR1.DTSTA9 , STR1.NBTRA9 , STR1.MTTRAK , STR1.NBTRA8 , STR1.MTTRAC , STR1.MTCMR9 , STR1.MTCMJ9 , STR1.MTCMM9 , STR1.NBPCI9 , STR1.MTPCI2 , STR1.NBPCI8 , STR1.MTPCI4 , STR1.NBPCE9 , STR1.MTPCE , STR1.MTRCE , STR1.NBPCM9 , STR1.MTPCM , STR1.MTRCM , STR1.NBPBB9 , STR1.MTPBB , STR1.MTRBB , STR1.NBPBE9 , STR1.MTPBE , STR1.MTRBE , STR1.MTRCEA , STR1.MTRCMA , STR1.MTRBBA , STR1.MTRBEA , STR1.TYPAI9 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When (ADD_MONTHS( STR1.DT_ELIG, +3)) < current_date then 0 else 1 End Row_Flag , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.COMRC_TIM_ADHR CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.SIRET9 = CIR1.NU_SIRET AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) >=CIR1.DD_HISTO AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) <= (Case when CIR1.DF_HISTO= '9999-12-31 00:00:00' Then CIR1.DF_HISTO Else TD_MONTH_END(CIR1.DF_HISTO) End )) LEFT JOIN %SOC%.MATRL_CB CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.NUSQM9 = CIR2.NU_SEQC_MATRL and STR1.SIRET9 = CIR2.NU_SIRET AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) >=CIR2.DD_HISTO AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) <= (Case when CIR2.DF_HISTO= '9999-12-31 00:00:00' Then CIR2.DF_HISTO Else TD_MONTH_END(CIR2.DF_HISTO) End ))
SIDODS                                            SELECT STR1.CD_EDS_BNQ , STR1.IDDMDSIG , STR1.IDSTRUCT , STR1.IDEDS , STR1.IDAGT , STR1.LIDMSIG , STR1.APPLISOU , STR1.IDTCOM , STR1.IDTSIGN , STR1.IDSTATU , STR1. IDCLI , STR1.DTHRSI , STR1.DTHRDM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 , CASE WHEN CIR4.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR5 , CIR1.ID_DWR as ID_DWR_AGT , CIR2.CT_SIGNER , CIR3.CD_TECHN_COM_VNT , CIR4.ID_DWR as ID_DWR_PART , CIR5.ID_DWR_EDS , CIR1.ID_SOURCE1 as ID_AGT_SOURCE , CIR4.ID_SOURCE1 as ID_PART_SOURCE , CIR5.ID_EXT_EDS FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_AGT_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDAGT = CIR1.ID_SOURCE1) LEFT OUTER JOIN %SOC%.TYP_CT_SIGNER CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.IDTSIGN = CIR2.CT_SIGNER) LEFT OUTER JOIN %SOC%.TYP_TECHN_COM_VNT CIR3 ON(STR1.CD_EDS_BNQ = CIR3.CD_BQE AND STR1.IDTCOM = CIR3.CD_TECHN_COM_VNT) LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_EDS_BNQ AND STR1.IDCLI = CIR4.ID_SOURCE1) LEFT OUTER JOIN %SOC%.ELT_DE_STRUCT CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_BQE AND (SUBSTR(STR1.IDEDS,1,5)) = CIR5.ID_EXT_EDS AND (SUBSTR(STR1.IDEDS,6,2)) = CIR5.ID_TYP_EDS)
TYP_PORTEF_BALE_TIERS_CST                         SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
FEPAVE02                                          SELECT STR1.CD_EDS_BNQ , STR1.CDENRG , STR1.CINT , STR1.LIBISP , STR1.NOMPRE , STR1.IDEXEF , STR1.NCPTEX , STR1.CRIB , STR1.CDETC , STR1.DTOUV , STR1.DADMA1 , STR1.DTCLOT , STR1.CDPROC , STR1.CDSOC2 , STR1.IFAMP , STR1.CNATCP , STR1.CDDEV , STR1.CDSUSS , STR1.TYPCP , STR1.CPTECL , STR1.USCPTE , STR1.CDSUR1 , STR1.CMARC1 , STR1.CDOMEP , STR1.DTOVP , STR1.CDPRLI , STR1.CDFIPB , STR1.CADEV7 , STR1.MICAP2 , STR1.DIKAN , STR1.MCIKAN , STR1.MSARCV , STR1.DSARCV , STR1.CPCPT , STR1.DDAFF1 , STR1.BGEST2 , STR1.BGEST1 , STR1.DDAFF2 , STR1.BGFMBF , STR1.CDCTX1 , STR1.CDRBDF , STR1.CDCTX2 , STR1.CDRFAN , STR1.CPCPT2 , STR1.CDOPAP , STR1.CDCTX4 , STR1.CPETRG , STR1.DCDRLV , STR1.DTNBOP , STR1.CDJRH , STR1.CREL , STR1.NERLV , STR1.MSOLD1 , STR1.DTSOJD , STR1.LICMT , STR1.DSSOLJ , STR1.MSMBDF , STR1.DSMBDF , STR1.MSMCIV , STR1.DSMCIV , STR1.MSACIV , STR1.DSACIV , STR1.MSABDF , STR1.DSABDF , STR1.MSRELV , STR1.DSRELV , STR1.MSFMC1 , STR1.DSFMC1 , STR1.POCSCD , STR1.CINTFM , STR1.CDETC2 , STR1.CINTBF , STR1.CDETC1 , STR1.CDEXO , STR1.DEFCEL , STR1.DEFPEL , STR1.DDMVT , STR1.MTBLO0 , STR1.DABLE1 , STR1.MTVOUV , STR1.MIKTRS , STR1.MTDEP8 , STR1.DADMAJ , STR1.COFCEL , STR1.DAFCEL , STR1.NCFCEL , STR1.IDEXEY , STR1.DADMA1_2 , STR1.DDOFIC , STR1.MINRDS , STR1.DDMVTR , STR1.IDCDPR , STR1.IDCDPK , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTEX=CIR1.NU_CPTE)
T3R05                                             SELECT STR1.CD_EDS_BNQ, STR1.IDPACO, STR1.IDPORT, STR1.DAAFPO, STR1.DELIEN, STR1.DFLIEN, STR1.IDTYPO, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION, COALESCE(TCO1.ID_DWR,0) ID_DWR_PART, COALESCE(TCO2.ID_DWR,0) ID_DWR_PORTEF, Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1, Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1, Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2, CIR1.ID_CT_PORTEF AS CIR1_ID_CT_PORTEF FROM %DTA%.T3R05 STR1 LEFT JOIN %SOC%.TYP_PORTEF CIR1 ON (CIR1.CD_BQE=STR1.CD_EDS_BNQ and CIR1.ID_CT_PORTEF=STR1.IDTYPO AND CIR1.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDPACO= TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_PORTEF_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.IDPORT= CAST ( TCO2.ID_SOURCE1 as DECIMAL(4,0)))
MOTCON                                            SELECT STR1.CD_EDS_BNQ , STR1.IDMDC , STR1.LIMDC , STR1.IDCPG2 , STR1.IDACTC , STR1.IDTCN , STR1.IDCANA , STR1.CTMCN1 , STR1.IDOPOR , STR1.CDOFFR , STR1.IDCTAC , STR1.IDCAF , STR1.IDTRT , STR1.IDPART , STR1.IDELEX , STR1.IDCTRA IDCTRA_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRA) end AS VARCHAR(30)) AS IDCTRA , STR1.NCPTE , STR1.CTACTC , STR1.CPSIMO , STR1.CPMOC , STR1.CPSOMO , STR1.NOETP , STR1.DIMDC , STR1.DFMDC , STR1.DDMDC , STR1.KFMOC , STR1.DMMDC , STR1.DMMDCS , STR1.DMSMDC , STR1.COCHST , STR1.CTRAIS , STR1.CDRAIS , STR1.QPRMC , STR1.QCLIC1 , STR1.QCRMC , STR1.IDARGU , STR1.CDTRTJ , STR1.NUCMP , STR1.MTZAC , STR1.LMZAC , STR1.DEMDCP , STR1.CQTRAV , STR1.CBPOPP , STR1.MDOFFR , STR1.MDFOFR , STR1.MDEXEC , STR1.MTMOYR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_CTR , COALESCE(CIR3.ID_DWR_EDC,0) ID_DWR_EDC , CAST(COALESCE(CIR4.IDCRE,'') AS CHAR(8)) IDCRE , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDCTRA= CIR2.BY_SOURCE1) LEFT JOIN %SOC%.ECD_DETENU CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDELEX = CIR3.ID_EDC_EXT AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %DE1%.CORREA CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND STR1.IDCTAC = CIR4.IDCTAC AND CIR4.TK_ACTION IN ('I','U')) LEFT JOIN %SOC%.TECHN_CNTCT CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE AND STR1.IDTCN = CIR5.ID_TECHN_CNTCT AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE))
COMMUNES                                          SELECT STR1.CD_EDS_BNQ , STR1.NCOMMU , STR1.PARTLOCA , STR1.LICOMMU , STR1.CPOST , STR1.CBURDIST , STR1.BURDIST , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_EVT_EDC_EXPOSE_CST                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
CENTRINT                                          SELECT STR1.CD_EDS_BNQ , STR1.CDCINT , STR1.CTCINT , STR1.LICINT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
PAKPPA                                            SELECT STR1.CD_EDS_BNQ ,STR1.IDCTR1 ,STR1.DURPL1 ,STR1.MTCRC7 ,STR1.CLEBA5 ,STR1.TXTAUX ,STR1.MKRDR ,STR1.MINNET ,CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO ,STR1.MECHEF ,STR1.NBECHE ,STR1.CBVEGA ,STR1.CBCAUT ,STR1.TXINR1 ,STR1.MTECF4 ,STR1.DADMAJ ,STR1.TKTCI1 ,STR1.DDARTX ,STR1.CPRSP ,STR1.DADMAC ,STR1.HEDMAS ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,CAST(CASE WHEN TCO2.CD_EDS_BNQ is not null Then TCO2.ID_SOURCE1 else %PMU%.Bin2Char(CIR2.IDCTRA) end AS VARCHAR(30)) AS IDCTRA ,CIR2.NCPTE ,CIR2.DPROD1 ,CIR2.CSSIT3 ,CIR2.CATTE ,CIR2.CDACCO ,CIR2.CMRGLT ,CIR2.DTRSI1 ,CIR2.DA1ECH ,CIR2.MTMONF ,CIR2.DHJJ1 ,CIR2.PAKCGE_IAGENT ,CIR2.IOFFRE ,CIR3.MTCOTS MT_COTIS_ASSIST ,CIR3.MTECF4 MT_ECHU_IMPAYE_ASSIST ,CIR4.MTCOTS MT_COTIS_DCOT ,CIR4.MTECF4 MT_ECHU_IMPAYE_DCOT ,CIR5.MTCOTS MT_COTIS_CART ,CIR5.MTECF4 MT_ECHU_IMPAYE_CART , COALESCE(CIR6W.CD_DOMN_INTVTN ,CIR6S.CD_DOMN_INTVTN ) CD_DOMN_INTVTN , COALESCE(CIR6W.CD_SOCIETARIAT_CRED ,CIR6S.CD_SOCIETARIAT_CRED ) CD_SOCIETARIAT_CRED , COALESCE(CIR6W.CD_BIEN_FINANCE ,CIR6S.CD_BIEN_FINANCE ) CD_BIEN_FINANCE , COALESCE(CIR6W.CD_DESTN_FINCT ,CIR6S.CD_DESTN_FINCT ) CD_DESTN_FINCT , COALESCE(CIR6W.CD_CATG_PRET ,CIR6S.CD_CATG_PRET ) CD_CATG_PRET , COALESCE(CIR6W.CD_CATG_FINCT ,CIR6S.CD_CATG_FINCT ) CD_CATG_FINCT , COALESCE(CIR6W.CD_COMPLEMENTARITE ,CIR6S.CD_COMPLEMENTARITE ) CD_COMPLEMENTARITE , COALESCE(CIR6W.CD_TECHN_CRED_NOYAU_PRET ,CIR6S.CD_TECHN_CRED_NOYAU_PRET) CD_TECHN_CRED_NOYAU_PRET , COALESCE(CIR6W.CT_LOI_AMRTSM ,CIR6S.CT_LOI_AMRTSM ) CT_LOI_AMRTSM , COALESCE(CIR6W.CD_PRIOD_RBT ,CIR6S.CD_PRIOD_RBT ) CD_PRIOD_RBT , COALESCE(CIR6W.DD_AMRTSM ,CIR6S.DD_AMRTSM ) DD_AMRTSM , COALESCE(CIR6W.DT_DER_ECHCE_THRQ ,CIR6S.DT_DER_ECHCE_THRQ ) DT_DER_ECHCE_THRQ , COALESCE(CIR6W.DT_SIGNER_CTR_CRED ,CIR6S.DT_SIGNER_CTR_CRED ) DT_SIGNER_CTR_CRED , COALESCE(CIR6W.TX_CRED ,CIR6S.TX_CRED ) TX_CRED , COALESCE(CIR6W.CD_NATU_TAUX ,CIR6S.CD_NATU_TAUX ) CD_NATU_TAUX , COALESCE(CIR6W.NU_OPERATION_NATIONAL ,CIR6S.NU_OPERATION_NATIONAL ) NU_OPERATION_NATIONAL , COALESCE(CIR6W.NU_PRET ,CIR6S.NU_PRET ) NU_PRET , COALESCE(CIR6W.CLE_ID_NATIONAL ,CIR6S.CLE_ID_NATIONAL ) CLE_ID_NATIONAL , COALESCE(CIR6W.CD_DEVIS_ISO ,CIR6S.CD_DEVIS_ISO ) CD_DEVIS_ISO , COALESCE(CIR6W.LIEU_INVESTISSEMENT ,CIR6S.LIEU_INVESTISSEMENT ) LIEU_INVESTISSEMENT , COALESCE(CIR6W.DUR_INITL_PRET ,CIR6S.DUR_INITL_PRET ) DUR_INITL_PRET , COALESCE(CIR6W.DT_PROCH_REVIS ,CIR6S.DT_PROCH_REVIS ) DT_PROCH_REVIS , COALESCE(CIR6W.DT_DECHCE_TERME ,CIR6S.DT_DECHCE_TERME ) DT_DECHCE_TERME , COALESCE(CIR6W.CD_DTX_LTGX ,CIR6S.CD_DTX_LTGX ) CD_DTX_LTGX , COALESCE(TCO1.ID_DWR,0) ID_DWR_EDC_TCO , Case When substr(TCO1.ID_SOURCE1, character(TCO1.ID_SOURCE1)-2)='ECD' then 1 else 0 End Row_Found_TCO1 , COALESCE(CIR7.CDEXI7,'') CDEXI7 , COALESCE(CIR8.ID_DWR_AGT,-1) AS ID_DWR_AGT , COALESCE(CIR6W.DT_EMISSON_OFR_CRED ,CIR6S.DT_EMISSON_OFR_CRED ) DT_EMISSON_OFR_CRED , COALESCE(CIR6W.DT_RCPTN_OFR_CRED_GED ,CIR6S.DT_RCPTN_OFR_CRED_GED ) DT_RCPTN_OFR_CRED_GED , COALESCE(CIR6W.DT_TRT_REALN_CRED ,CIR6S.DT_TRT_REALN_CRED ) DT_TRT_REALN_CRED , COALESCE(CIR6W.DT_DECI_AP ,CIR6S.DT_DECI_AP ) DT_DECI_AP , CIR2.MTFDOA , 0 CD_SOLTN_HAB , '-1' CD_DEPT_INVSTMNT FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN %DE1%.PAKCGE CIR2 ON (CIR2.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR2.IDCTR1=STR1.IDCTR1 AND CIR2.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.PAKASS CIR3 ON (CIR3.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR3.IDCTR1=STR1.IDCTR1 AND CIR3.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.PAKDCO CIR4 ON (CIR4.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR4.IDCTR1=STR1.IDCTR1 AND CIR4.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.PAKCAR CIR5 ON (CIR5.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR5.IDCTR1=STR1.IDCTR1 AND CIR5.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDELCO= TCO1.BY_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO TCO2 ON (CIR2.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND CIR2.IDCTRA= TCO2.BY_SOURCE1) LEFT JOIN %SOC%.CRED CIR6S ON ( CIR6S.ID_DWR_EDC=TCO1.ID_DWR AND CIR6S.CD_BQE=TCO1.CD_EDS_BNQ AND CAST(CIR6S.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6S.DF_HISTO AS DATE) ) LEFT JOIN ( SELECT CD_BQE ,ID_DWR_EDC ,DD_HISTO ,DF_HISTO ,CD_DOMN_INTVTN ,CD_SOCIETARIAT_CRED ,CD_BIEN_FINANCE ,CD_DESTN_FINCT ,CD_CATG_PRET ,CD_CATG_FINCT ,CD_COMPLEMENTARITE ,CD_TECHN_CRED_NOYAU_PRET ,CT_LOI_AMRTSM ,CD_PRIOD_RBT ,DD_AMRTSM ,DT_DER_ECHCE_THRQ ,DT_SIGNER_CTR_CRED ,TX_CRED ,CD_NATU_TAUX ,NU_OPERATION_NATIONAL ,NU_PRET ,CLE_ID_NATIONAL ,CD_DEVIS_ISO ,LIEU_INVESTISSEMENT ,DUR_INITL_PRET ,DT_PROCH_REVIS ,DT_DECHCE_TERME ,CD_DTX_LTGX ,DT_EMISSON_OFR_CRED ,DT_RCPTN_OFR_CRED_GED ,DT_TRT_REALN_CRED ,DT_DECI_AP FROM %WRK%.CRED QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_BQE,ID_DWR_EDC ORDER BY DD_HISTO DESC , DF_HISTO DESC)=1 ) CIR6W ON ( CIR6W.ID_DWR_EDC=TCO1.ID_DWR AND CIR6W.CD_BQE=TCO1.CD_EDS_BNQ AND CAST(CIR6W.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6W.DF_HISTO AS DATE) ) LEFT JOIN %DE1%.PAKADI CIR7 ON (CIR7.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR7.IDCTR1=STR1.IDCTR1 AND CIR7.TK_ACTION in ('I','U')) LEFT JOIN %SOC%.AGT CIR8 ON (CIR2.CD_EDS_BNQ=CIR8.CD_BQE AND CIR8.ID_AGT=CIR2.PAKCGE_IAGENT AND CAST(CIR8.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR8.DF_HISTO AS DATE) AND CIR8.ID_AGT IS NOT NULL)
T1R02P                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCTRA IDCTRA_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRA) end AS VARCHAR(30)) AS IDCTRA , STR1.IDCOSE IDCOSE_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCOSE) end AS VARCHAR(30)) AS IDCOSE , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CTR , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR3.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDCTRA= CIR1.BY_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDCOSE= CIR2.BY_SOURCE1 and Substr(CIR2.ID_SOURCE1,31,3) = 'SCE') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND CIR3.CDTABO='T1R02P')
ADIAD10                                           SELECT STR1.CD_EDS_BNQ , STR1.IASSE , STR1.IPRET , STR1.SGEST2 , STR1.CCONT , STR1.CASSR , STR1.CGTIE2 , STR1.CPOUR2 , STR1.QUOTI2 , STR1.CPOUR3 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC, 0) ID_DWR_EDC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN(SELECT DISTINCT CD_BQE,ID_EDC_CRED,ID_DWR_EDC FROM %SOC%.CRED WHERE TYP_SOURCE_CRED in('G','L')) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IPRET=CIR1.ID_EDC_CRED )
ID_TYP_EVT_TCO                                    SELECT ID_DWR , CD_EDS_BNQ , ID_SOURCE1 FROM %TCO%.%ObjectNameFrom%
COCL_INTRL_CONSO                                  SELECT STR1.CD_EDS_BNQ , STR1.ID_STRUCT_CONSO , STR1.ID_TECHN_INTRL_CONSO , STR1.ID_TECHN_CONSO_DE_L_INTRL , STR1.CD_TYP_INTRL_CONSO , STR1.CD_CVLT_INTRL_CONSO , STR1.NOM_INTRL_CONSO , STR1.PRN_INTRL_CONSO , STR1.CD_FNCTN_INTRL_CONSO , STR1.TEL_PRTBL_INTRL_CONSO , STR1.TEL_FIX_INTRL_CONSO , STR1.COURL_INTRL_CONSO , STR1.FAX_INTRL_CONSO , STR1.SOURCE_MAJ_INTRL_CONSO , STR1.TS_MAJ_INTRL_CONSO , STR1.ID_AGT_MAJ_INTRL_CONSO , STR1.ID_STRUCT_MAJ_INTRL_CONSO , STR1.CD_CNL_DSTRB_MAJ_INTRL_CONSO , STR1.ID_TECHN_CONSO_LIE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_FNCTN_INTRL CIR1 on (STR1.ID_STRUCT_CONSO=CIR1.CD_BQE and STR1.CD_FNCTN_INTRL_CONSO=CIR1.CD_FNCTN_INTRL AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CONSO CIR2 on (STR1.ID_STRUCT_CONSO=CIR2.CD_BQE and STR1.ID_TECHN_CONSO_DE_L_INTRL=CIR2.ID_TK_CONSO AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_INTRL CIR3 on (STR1.ID_STRUCT_CONSO=CIR3.CD_BQE and STR1.CD_TYP_INTRL_CONSO=CIR3.CT_INTRL AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_ABRG_CVLT CIR4 on (STR1.ID_STRUCT_CONSO=CIR4.CD_BQE and STR1.CD_CVLT_INTRL_CONSO=CAST(CIR4.CD_ABRG_CVLT AS CHAR(2)) AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
ELTDOC                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELTD , CAST(trim(STR1.CDJHR) as decimal(2,0)) CDJHR , STR1.CDENV , STR1.DEEFF , STR1.CBEDI1 , STR1.IDCCO IDCCO_BYTE , CAST(COALESCE(CIR1.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDCCO , STR1.IDENV IDENV_BYTE , CAST(%PMU%.Bin2Char(STR1.IDENV) AS VARCHAR(30)) AS IDENV , STR1.CDFDA , STR1.CDLAN5 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CRCL_COM , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CRCL_COM_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDCCO= CIR1.BY_SOURCE1)
TYP_STATU_4BRNC_CST                               SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
SYNCHROSQUOTD                                     SELECT STR1.CD_EDS_BNQ ,TCO1.ID_DWR AS ID_DWR_PRFL_MABQE ,CIR1.ID_DWR_PART ,STR1.CPTEBAM ,STR1.CDBQE ,STR1.IDCAEL ,STR1.DTSYNC ,STR1.HSYNC ,STR1.APPLI ,STR1.OS ,STR1.OSVN ,STR1.FABTERM ,STR1.MODTERM ,STR1.SCALE ,STR1.DT_ELIG ,STR1.RE_CYCLE ,STR1.IDPROFIL ,STR1.IDPART ,STR1.APPLIVN ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END AS Row_Found_TCO1 ,CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END AS Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PRFL_MABQE_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDPROFIL = TCO1.ID_SOURCE1) LEFT JOIN %SOC%.PART CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDPART = CIR1.ID_PART AND STR1.DT_ELIG >= CIR1.DD_HISTO AND STR1.DT_ELIG < CIR1.DF_HISTO)
IARFKA10                                          SELECT STR1.CD_EDS_BNQ, STR1.IDCLC, STR1.IDPACO, STR1.IDBANC, STR1.CDDOMI, STR1.CDPROD, STR1.CDBUR1, STR1.LNMARI, STR1.LNPRUS, STR1. DNAISA, STR1.CDDRTF, STR1.NCPTPA, STR1.CBSOU1, STR1.CBSOU2, STR1.CBSOU3, STR1.CBSOU, STR1.CBSOU4, STR1.CBSOU5, STR1.FILLERA, STR1.KA10_IDCTRT, STR1.KA10_CDBURO, STR1.KA10_CDVEND, STR1.KA10_NUIMAG, STR1.KA10_CDFOIC, STR1.KA10_CPEFAC, STR1.KA10_CDSICT, STR1.KA10_DEDIMC, STR1.KA10_DEFIMC, STR1.KA10_DEDAFN, STR1.KA10_DECHC1, STR1.KA10_DPRECH, STR1.KA10_DRESC1, STR1.KA10_MOTRS1, STR1.KA10_KMRM, STR1.KA10_CDMTCO, STR1.KA10_CDITRF, STR1.KA10_MTITRF, STR1.KA10_CDDTRF, STR1.KA10_CDDTR1, STR1.KA10_KMDTRF, STR1.KA10_MTTAXE, STR1.KA10_MTCOMA, STR1.KA10_MTCOTI, STR1.KA10_CDAPPT, STR1.KA10_CBREPD, STR1.KA10_DERSPR, STR1.KA10_CDMORP, STR1.KA10_DADERS, STR1.KA10_DACRE, STR1.KA10_CTDOJA, STR1.KA10_CTDOJB, STR1.KA10_CTDOJC, STR1.KA10_CTDOJD, STR1.KA10_CTDOJE, STR1.KA10_CTDOJF, STR1.KA10_CBINDG, STR1.KA10_KFSUR, STR1.KA10_CDTOP1, STR1.KA10_CDTOP2, STR1.KA10_IDPERC, STR1.KA10_CDETAX, STR1.KA10_CDGBD1, STR1.KA10_NCPTDF, STR1.KA10_CLRIBP, STR1.KA10_CDETA5, STR1.KA10_CDBGD3, STR1.KA10_NCPTDG, STR1.KA10_CLRIBI, STR1.KA10_DHECH1, STR1.KA10_DAPASS, STR1.KA10_MTAAB1, STR1.KA10_CDGAM, STR1.KA10_CBPOP, STR1.KA10_CDPCO, STR1.KA10_CSSITU, STR1.KA10_DATSUP, STR1.KA10_CDTIM, STR1.KA10_MTDRG, STR1.KA10_DDECH3, STR1.KA10_CDINIT, STR1.KA10_CDVOP1, STR1.KA10_IDBAN7, STR1.KA10_IDPERD, STR1.KA10_NOVER4, STR1.KA10_IDRFIN, STR1.KA10_IDRFI1, STR1.KA10_CDNTU, STR1.KA10_IDBAN9, STR1.KA10_IDRFI2, STR1.KA10_CDNTU1, STR1.KA10_IDBANA, STR1.KA10_IDRFI3, STR1.KA10_CDNTU2, STR1.KA10_CDNTU3, STR1.KA10_CQAEAG, STR1.KA10_CDORCO, STR1.KA10_CTSOU1, STR1.KA09_CBHST, STR1.KA09_IDCTRT, STR1.KA09_CTPRS0, STR1.KA09_NBMV2, STR1.KA09_MFRAID, STR1.KA09_CMEDI, STR1.KA09_IDTYOQ, STR1.KA09_CDPRCT, STR1.FILLERB, STR1.KA10_ZB014, STR1.KA1A_IDCTRT, STR1.KA1A_NUIMAG, STR1.KA1A_CBSOU1, STR1.KA1A_DADESS, STR1.KA1A_CTSOU2, STR1.KA1A_CDTOP, STR1.KA1A_IDCTRH, STR1.KA1A_DGAREF, STR1.KA1A_CDMOCC, STR1.KA1A_IDCTRG, STR1.FILLERC, STR1.KA10_DASIEM, STR1.KA10_CDTOP3, STR1.FILLERD, STR1.FILLERE, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION, TCO1.ID_DWR ID_DWR_CTR_IARD, CIR1.ID_DWR as ID_DWR_PART, CASE WHEN CIR1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR1, CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2, CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON ( STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.KA10_IDCTRT=TCO1.ID_SOURCE1 ) LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON ( STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPACO =CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_PROD_ASSU_IARD CIR2 ON ( STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.CDPROD = CIR2.CD_PROD_ASSU_IARD) LEFT JOIN %SOC%.TYP_PROD_FRMUL_IARD CIR3 ON ( STR1.CD_EDS_BNQ = CIR3.CD_BQE AND STR1.CDPROD = CIR3.CD_PROD_ASSU_IARD AND STR1.KA10_CDFOIC = CIR3.CD_FRMUL_CTR_IARD)
LCLSTN_EDS                                        SELECT STR1.CD_EDS_BNQ, STR1.NOMTAB, STR1.IDELST, STR1.IDADRE , STR1.DELIEN, STR1.DFLIEN, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE , STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION , COALESCE(CIR1.LIGAD3,' ') LIGAD3 , COALESCE(CIR1.LIGAD4,' ') LIGAD4 , COALESCE(CIR1.LIGAD5,' ') LIGAD5 , COALESCE(CIR1.LIGAD6,' ') LIGAD6 , CIR1.DDVAL , CIR1.DFVAL , CIR1.HFVAL , COALESCE(CIR2.LI_EDS,' ') LI_EDS , COALESCE(CIR3.IDNUPA,' ') IDNUPA , COALESCE(CIR4.ID_DWR,0) ID_DWR_EDS , COALESCE(TCO1.ID_DWR,0) ID_DWR_COORD , 'EDS'||STR1.IDADRE EDSIDELST , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR3 , Case WHEN CIR4.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR4 , Case WHEN TCO1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_TCO1 FROM %DTA%.LCLSTN_EDS STR1 Left JOIN %DE1%.ADRESSE_EDS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDADRE=CIR1.IDADRZ and CIR1.TK_ACTION in ('I','U')) Left JOIN %SOC%.ELT_DE_STRUCT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.IDELST=CIR2.ID_EDS and CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) Left JOIN %DE1%.DESTN_COM_DESIGNE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.IDELST=CIR3.IDELST) Left JOIN %TCO%.ID_EDS_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ and STR1.IDELST=CIR4.ID_SOURCE1) Left JOIN %TCO%.ID_COORD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ and 'EDS'||STR1.IDADRE=TCO1.ID_SOURCE1)
ELCAFF                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.EDELCP , STR1.DDFONC , STR1.DFFONC , STR1.MAENTU , STR1.QTPRBP , STR1.TXCOB1 , STR1.TXCOA1 , STR1.MATPR1 , STR1.MATPC1 , STR1.TXRTS2 , STR1.CPREST , STR1.IDCDPN , STR1.DDDMAR , STR1.DASICO , STR1.DTRSI1 , STR1.CDINMA , STR1.QOCGC1 , STR1.PLACT1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_ACTION , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , COALESCE(TCO1.ID_DWR,0) AS ID_DWR FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD'
TYP_CAP_CST                                       SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
C2R05                                             SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDELST , STR1.IPOSTF , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PST_FNCT , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDS , COALESCE(CIR3.ID_EXT_EDS,0) ID_EXT_EDS , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PST_FNCT_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IPOSTF = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDS_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDELST = CIR2.ID_SOURCE1) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE and STR1.IDELST = CIR3.ID_EDS AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
CONFRM                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCONF , STR1.IDPART , STR1.CDCFRM , STR1.DADMA2 , STR1.CDCONN , STR1.DADM10 , STR1.CBINDI , STR1.CBINDJ , STR1.CBINDD , STR1.CBINDH , STR1.CBINDG , STR1.CBINDK , STR1.CBINDF , STR1.CBINDN , STR1.CBINDE , STR1.CDVLDC , STR1.LICOM1 , STR1.IAGEN1 , STR1.DASTDZ , STR1.CDEROG , STR1.DFVALF , STR1.LICOM2 , STR1.IAGENT , STR1.DADM11 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Coalesce(CIR1.ID_DWR_PART,0) ID_DWR_PART , Coalesce(CIR2.ID_DWR_PERSON,0) ID_DWR_PERSON , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Coalesce(TCO1.ID_DWR,0) ID_DWR_AGT_VALDT , Coalesce(TCO2.ID_DWR,0) ID_DWR_AGT_DEROGT FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.PART CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDPART=CIR1.ID_PART AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PERSON_CMPS_PART CIR2 ON (CIR1.CD_BQE =CIR2.CD_BQE AND CIR1.ID_DWR_PART=CIR2.ID_DWR_PART AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) AND CIR2.DF_VALID = '9999-12-31' and CIR2.CD_GRP ='0') LEFT JOIN %TCO%.ID_AGT_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND TRIM(STR1.IAGEN1) = TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_AGT_TCO TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND TRIM(STR1.IAGENT) = TCO2.ID_SOURCE1)
INFICA                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.DFVAL , STR1.CQSOC , STR1.CBTEND , STR1.DDVAL , STR1.PECUM , STR1.DTMOIS , STR1.CBTENE , STR1.CDTOPB , STR1.CDTOPD , STR1.CDTOPO , STR1.CDTOPE , STR1.CDTOPL , STR1.CDTOPQ , STR1.CDTOPS , STR1.CDTOPT , STR1.CDTOPW , STR1.CDTOPM , STR1.CDTOP0 , STR1.CDTOPN , STR1.CDTOP1 , STR1.PEVIPM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_CLI_CIAL FROM %DTA%.INFICA STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCLC= TCO1.ID_SOURCE1)
IARFKA78                                          SELECT STR1.CD_EDS_BNQ , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.IDCLC , STR1.NCPTPA , STR1.KA10_IDCTRT , STR1.KA68_NCOMMU , STR1.KA71_CBGDEL , STR1.KA71_CDTOP3 , STR1.KA68_CDQUAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR AS ID_DWR_CTR_IARD , CASE WHEN TCO1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ and STR1.KA10_IDCTRT=TCO1.ID_SOURCE1)
TYP_METHD_CALC_BALE_CST                           SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ELEPAT                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELP , STR1.MTPATR , STR1.IDTEP , STR1.DADMA2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_ELT_PATRIM , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_ELT_PATRIM CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDTEP = CIR1.CT_ELT_PATRIM) LEFT JOIN %TCO%.ID_ELT_PATRIM_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND CAST(CAST(STR1.IDELP as format 'Z(I)') as VARCHAR(9)) = TCO1.ID_SOURCE1)
IARPROD                                           SELECT STR1.CD_EDS_BNQ , STR1.CDPROD , CIR1.APPLTN_CIALE_PROD_CIAL , CIR1.CD_PROD_CIAL , CIR2.ID_OFR_BQR , STR1.IDCDPL , STR1.IOFFR6 , trim(CAST((IDCDPL (FORMAT '9(05)')) AS CHAR(05))) as IDCDPL_CONV , trim(CAST((IOFFR6 (FORMAT '9(05)')) AS CHAR(05))) as IOFFR6_CONV , STR1.LNPROD , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End as ROW_FOUND_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 END as ROW_FOUND_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 left join %SOC%.PROD_CIAL CIR1 ON (trim(CAST((STR1.IDCDPL (FORMAT '9(05)')) AS CHAR(05))) = CIR1.CD_PROD_CIAL) left join %SOC%.ofr CIR2 ON (trim(CAST((STR1.IOFFR6 (FORMAT '9(05)')) AS CHAR(05))) = CIR2.ID_OFR_BQR)
EXCFLUTI                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ IS NOT NULL THEN TCO1.ID_SOURCE1 ELSE Bin2Char(STR1.IDELCO) END AS VARCHAR(30)) AS IDELCO , STR1.IDCTRA AS IDCTRA_BYTE , CAST(Bin2Char(STR1.IDCTRA) AS VARCHAR(30)) AS IDCTRA , STR1.CDENR1 , STR1.IDCLI1 , STR1.IDPACO , STR1.CPELC , STR1.IDPRB2 , STR1.IDPRB4 , STR1.IDCDP3 , STR1.IDCDP4 , STR1.IOFFR2 , STR1.DASICO , STR1.DEFCON , STR1.DFINCO , STR1.CDMOOC , STR1.CDMOFC , STR1.DDFONC , STR1.DFFONC , STR1.LIAPUS , STR1.NCPTEX , STR1.IDFPR0 , STR1.IDFPR1 , STR1.DDCOMP , STR1.DFCOMP , STR1.TYPCP4 , STR1.CPTET0 , STR1.CUSAC1 , STR1.CBTAE , STR1.CBTAR , STR1.IDEXE1 , STR1.IDEXE6 , STR1.IDDEVI , STR1.IDSEC1 , STR1.ITSPPA , STR1.ITSPPE , STR1.CDAGEC , STR1.CTACV , STR1.DDINPA , STR1.CDRSY3 , STR1.IDPROD , STR1.COPER2 , STR1.CDANU , STR1.IDVAL5 , STR1.QTITR7 , STR1.IDCNL , STR1.CMNEV1 , STR1.LICANA , STR1.CSTAT , STR1.MOOPFG , STR1.MTNETE , STR1.MTIEL2 , STR1.LIB14 , STR1.CTSOU , STR1.DTEFFE , STR1.DVMVE7 , STR1.CDEVF1 , STR1.DOOPFG , STR1.LIBVA2 , STR1.CVALC , STR1.CCVLR , STR1.CCTIT3 , STR1.IDCDPN , CAST(STR1.NBLIG AS smallint) AS NBLIG_INT , STR1.RE_CYCLE , TD_MONTH_BEGIN(cast (STR1.DT_ELIG as date) - INTERVAL '1' month )AS DD_PE_ELIG , cast (TD_MONTH_END(cast (STR1.DT_ELIG as date) - INTERVAL '1' month )as TIMESTAMP(0) ) AS DDT_ELIG , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , TCO1.ID_DWR , 'MC' as CT_PE FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD')
PRODUCAS                                          SELECT STR1.CD_EDS_BNQ , STR1.CDPRA , STR1.LIPRA , STR1.CBCRT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
DTWHES05                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCTRA , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ IS NOT NULL THEN CIR1.ID_SOURCE1 ELSE %PMU%.Bin2Char(STR1.IDELCO) END AS VARCHAR(30)) AS IDELCO , STR1.IDPACO , STR1.DDFONC , STR1.DFFONC , STR1.IDCDPR , STR1.IDCDP1 , STR1.IDCD2R , STR1.IDCDPK , STR1.IDDEVI , STR1.TYPCPT , STR1.CPTETR , STR1.NCPTE , STR1.NUCPSU , STR1.IDCANA , STR1.IDRSB , STR1.IDELEX , STR1.IDCTRX , STR1.DADERS , STR1.LNDISP , STR1.CBCLIA , STR1.CDSTAN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) AS ID_DWR_EDC , CIR1.DT_EFFT_CTR , CIR1.CT_DSPSTF , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN ( SELECT TCO1.CD_EDS_BNQ , TCO1.ID_SOURCE1 , TCO1.BY_SOURCE1 , CIR1.ID_DWR_EDC , CIR1.DT_EFFT_CTR , CIR1.CT_DSPSTF , CIR1.DD_HISTO , CIR1.DF_HISTO FROM %SOC%.EPRGN_SALRL CIR1 INNER JOIN %TCO%.ID_EDC_TCO TCO1 ON (CIR1.CD_BQE=TCO1.CD_EDS_BNQ AND CIR1.ID_EDC_VEGA||'ECD'= TCO1.ID_SOURCE1)) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDELCO=CIR1.BY_SOURCE1 AND STR1.DT_ELIG >=CIR1.DD_HISTO AND STR1.DT_ELIG < CIR1.DF_HISTO) LEFT JOIN %SOC%.TYP_STATU_CTR_ASSU CIR2 ON ( STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.CDSTAN = CIR2.CD_STATU_PRNCP)
ENVOI                                             SELECT STR1.CD_EDS_BNQ , STR1.IDENV AS IDENV_BYTE , CAST(%PMU%.Bin2Char(STR1.IDENV) AS VARCHAR(30)) AS IDENV , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
T6R10                                             SELECT STR1.CD_EDS_BNQ , STR1.IDMESA IDMESA_BYTE , CAST(Case When TCO1.ID_SOURCE1 is not null Then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDMESA) End AS VARCHAR(30)) AS IDMESA , STR1.IDINPE IDINPE_BYTE , CAST(Case When TCO2.ID_SOURCE1 is not null then TCO2.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDINPE) End AS VARCHAR(30)) AS IDINPE , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_EVT , TCO2.ID_DWR EVT_ID_DWR_EVT , TCO3.ID_DWR ID_DWR_SITUA_PARTC , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , Case When TCO3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO3 , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.T6R10 STR1 LEFT JOIN %TCO%.ID_EVT_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDMESA= TCO1.BY_SOURCE1 AND substr(TCO1.ID_SOURCE1, character(TCO1.ID_SOURCE1))='4') LEFT JOIN %TCO%.ID_EVT_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.IDINPE= TCO2.BY_SOURCE1 AND substr(TCO2.ID_SOURCE1, character(TCO2.ID_SOURCE1))='1') LEFT JOIN %TCO%.ID_SITUA_PARTC_TCO TCO3 ON(STR1.CD_EDS_BNQ=TCO3.CD_EDS_BNQ AND STR1.IDINPE=TCO3.BY_SOURCE1 AND SUBSTR(TCO3.ID_SOURCE1,31,1)='1') LEFT JOIN %DE1%.MESAUV CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDMESA=CIR1.IDMESA AND CIR1.TK_ACTION IN ('I','U'))
DGXG48                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPRC , STR1.DHPRC , STR1.IDCNT , STR1.IDOFB , STR1.IDCRE , STR1.CPPRO , STR1.DDPRO , STR1.DMPRO , STR1.LIPRC , STR1.CPPSI , STR1.IDPN , STR1.LMPRO , STR1.IDRAA , STR1.IDEVN , STR1.DDVALC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_PART,0) ID_DWR_PART , COALESCE(CIR2.ID_SOURCE1,'') ID_PART , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.PART_PART_EMACO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDPN = CIR1.ID_PART_EMACO AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN (SELECT CD_EDS_BNQ, ID_SOURCE1, ID_DWR FROM %TCO%.ID_PART_TCO AS TCO1 WHERE EXISTS (SELECT 1 FROM %SOC%.PART AS P WHERE P.CD_BQE = TCO1.CD_EDS_BNQ AND P.ID_DWR_PART = TCO1.ID_DWR) ) AS CIR2 ON (CIR1.CD_BQE = CIR2.CD_EDS_BNQ AND CIR1.ID_DWR_PART = CIR2.ID_DWR)
TYP_NIV_RISQ_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
HIERA_UTI                                         SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CT_HIERA_UTI , STR1.ID_HIERA_UTI , STR1.LI_HIERA_UTI , CAST(oreplace(STR1.LI_HIERA_UTI,'+','_') AS VARCHAR(150)) AS LI_HIERA_UTI_VBA , STR1.NU_LIGNE , STR1.ID_ELT_DE_NIV_1 , STR1.LI_ELT_DE_NIV_1 , STR1.ID_ELT_DE_NIV_2 , STR1.LI_ELT_DE_NIV_2 , STR1.ID_ELT_DE_NIV_3 , STR1.LI_ELT_DE_NIV_3 , STR1.ID_ELT_DE_NIV_4 , STR1.LI_ELT_DE_NIV_4 , STR1.ID_ELT_DE_NIV_5 , STR1.LI_ELT_DE_NIV_5 , STR1.ID_ELT_DE_NIV_6 , STR1.LI_ELT_DE_NIV_6 , STR1.ID_ELT_DE_NIV_7 , STR1.LI_ELT_DE_NIV_7 , STR1.ID_ELT_DE_NIV_8 , STR1.LI_ELT_DE_NIV_8 , STR1.ID_ELT_DE_NIV_9 , STR1.LI_ELT_DE_NIV_9 , STR1.ID_ELT_DE_NIV_10 , STR1.LI_ELT_DE_NIV_10 , STR1.ID_SIO , STR1.CD_NIV_HIERA , STR1.ID_UTI_ORIG , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.TABLE_SOURCE , CIR1.ID_SOURCE AS COLUMN_SOURCE , CASE WHEN CIR1.TABLE_SOURCE= 'ELT_DE_STRUCT' OR CIR1.TABLE_SOURCE= 'PROD_CIAL' OR CIR1.TABLE_SOURCE= 'OFR' OR CIR1.TABLE_SOURCE= 'PORTEF' OR CIR1.TABLE_SOURCE= 'TYP_OPERN_FACTN' OR CIR1.TABLE_SOURCE= 'FNCTN' OR CIR1.TABLE_SOURCE= 'TYP_TRCH_AGE' OR CIR1.TABLE_SOURCE= 'TYP_PROD_BDF' OR CIR1.TABLE_SOURCE= 'MRCH' OR CIR1.TABLE_SOURCE= 'SEGM_MRCH_CIAL' OR CIR1.TABLE_SOURCE= 'TYP_DUR_INITL_PRET' OR CIR1.TABLE_SOURCE= 'TYP_NATU_CRED' OR CIR1.TABLE_SOURCE= 'TYP_PART' OR CIR1.TABLE_SOURCE= 'TYP_TRCH_NB_OPERN' OR CIR1.TABLE_SOURCE= 'TYP_SEGM_NOTATN_BALE2' OR CIR1.TABLE_SOURCE= 'MTF_CLOT'OR CIR1.TABLE_SOURCE= 'SEGM_EMACO'OR CIR1.TABLE_SOURCE= 'PST_FNCT' OR CIR1.TABLE_SOURCE= 'TYP_CD_PROD_PLTAGE' OR CIR1.TABLE_SOURCE='TYP_TRCH_ANO_RISQ' THEN 1 ELSE 0 END AS TABLE_CONNUE , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END ROW_FOUND_R1 , CASE WHEN TRIM(STR1.ID_SIO)='-1' AND CIR1.TABLE_SOURCE='ELT_DE_STRUCT' THEN 1 WHEN CIR2.ID_EXT_EDS IS NULL THEN 0 WHEN TO_NUMBER(STR1.ID_SIO) IS NULL AND CIR2.ID_EXT_EDS IS NOT NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR2 , CASE WHEN TRIM(STR1.ID_SIO)='-1' AND CIR1.TABLE_SOURCE='PROD_CIAL' THEN 1 WHEN CIR3.CD_PROD_CIAL IS NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR3 , CASE WHEN TRIM(STR1.ID_SIO)='-1' AND CIR1.TABLE_SOURCE='OFR' THEN 1 WHEN CIR4.ID_OFR_BQR IS NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR4 , CASE WHEN TRIM(STR1.ID_SIO)='-1' AND CIR1.TABLE_SOURCE='PORTEF' THEN 1 WHEN CIR5.ID_PORTEF IS NULL THEN 0 WHEN TO_NUMBER(STR1.ID_SIO) IS NULL AND CIR5.ID_PORTEF IS NOT NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR5 , CASE WHEN TRIM(STR1.ID_SIO)='-1' AND CIR1.TABLE_SOURCE='TYP_OPERN_FACTN' THEN 1 WHEN CIR6.ID_OPERN_FACTN IS NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR6 , CASE WHEN TRIM(STR1.ID_SIO)='-1' AND CIR1.TABLE_SOURCE='FNCTN' THEN 1 WHEN CIR7.ID_FNCTN IS NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR7 , CASE WHEN CIR9.CD_PROD_BDF IS NULL THEN 0 WHEN TO_NUMBER(STR1.ID_SIO) IS NULL AND CIR9.CD_PROD_BDF IS NOT NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR9 , CASE WHEN CIR10.ID_MRCH IS NULL THEN 0 WHEN TO_NUMBER(STR1.ID_SIO) IS NULL AND CIR10.ID_MRCH IS NOT NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR10 , CASE WHEN TRIM(STR1.ID_SIO)='-1' AND CIR1.TABLE_SOURCE= 'SEGM_MRCH_CIAL'THEN 1 WHEN CIR11.ID_SEGM_CIAL IS NULL THEN 0 WHEN TO_NUMBER(STR1.ID_SIO) IS NULL AND CIR11.ID_SEGM_CIAL IS NOT NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR11 , CASE WHEN CIR12.CD_TRCH_DUR_INITL_PRET IS NULL THEN 0 WHEN TO_NUMBER(STR1.ID_SIO) IS NULL AND CIR12.CD_TRCH_DUR_INITL_PRET IS NOT NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR12 , CASE WHEN TRIM(STR1.ID_SIO)='-1' AND CIR1.TABLE_SOURCE='SEGM_EMACO' THEN 1 WHEN CIR18.ID_EMACO IS NULL THEN 0 ELSE 1 END AS ROW_FOUND_CIR18 , CASE WHEN STR1.ID_SIO <> '-9999' AND ROW_FOUND_CIR2=0 AND ROW_FOUND_CIR3=0 AND ROW_FOUND_CIR4=0 AND ROW_FOUND_CIR5=0 AND ROW_FOUND_CIR6=0 AND ROW_FOUND_CIR7=0 AND CIR8.CD_TRCH_AGE IS NULL AND ROW_FOUND_CIR9=0 AND ROW_FOUND_CIR10=0 AND ROW_FOUND_CIR11=0 AND ROW_FOUND_CIR12=0 AND CIR13.CD_BQE IS NULL AND CIR14.CD_BQE IS NULL AND CIR15.CD_BQE IS NULL AND CIR16.CD_BQE IS NULL AND CIR17.CD_BQE IS NULL AND ROW_FOUND_CIR18=0 AND CIR19.CD_BQE IS NULL AND CIR20.CD_BQE IS NULL AND CIR21.CD_BQE IS NULL THEN 0 ELSE 1 END ROW_FOUND_R2 , CASE WHEN COALESCE(TRIM(STR1.ID_ELT_DE_NIV_1),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_1),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_2),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_2),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_3),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_3),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_4),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_4),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_5),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_5),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_6),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_6),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_7),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_7),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_8),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_8),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_9),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_9),'')='' OR COALESCE(TRIM(STR1.ID_ELT_DE_NIV_10),'')='' OR COALESCE(TRIM(STR1.LI_ELT_DE_NIV_10),'')='' OR COALESCE(TRIM(STR1.CD_NIV_HIERA),'')='' OR COALESCE(TRIM(STR1.ID_UTI_ORIG),'')='' THEN 0 ELSE 1 END ROW_FOUND_R3 , MIN(CASE WHEN ROW_FOUND_R1=0 OR ROW_FOUND_R2=0 OR ROW_FOUND_R3=0 THEN 0 ELSE 1 END) OVER (PARTITION BY STR1.CD_EDS_BNQ,STR1.ID_HIERA_UTI) RESULTAT_GLOBAL FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_HIERA_UTI CIR1 ON STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CT_HIERA_UTI=CIR1.CT_HIERA_UTI AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR2 ON STR1.CD_EDS_BNQ=CIR2.CD_BQE AND TRIM(STR1.ID_SIO)=TRIM(CAST(CIR2.ID_EXT_EDS AS VARCHAR(10))) AND CIR1.TABLE_SOURCE='ELT_DE_STRUCT' AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) LEFT JOIN %SOC%.PROD_CIAL CIR3 ON TRIM(STR1.ID_SIO)=TRIM(CIR3.CD_PROD_CIAL) AND CIR1.TABLE_SOURCE='PROD_CIAL' AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE) LEFT JOIN %SOC%.OFR CIR4 ON TRIM(STR1.ID_SIO)=TRIM(CIR4.ID_OFR_BQR) AND CIR1.TABLE_SOURCE='OFR' AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE) LEFT JOIN %SOC%.PORTEF CIR5 ON STR1.CD_EDS_BNQ=CIR5.CD_BQE AND CIR1.TABLE_SOURCE='PORTEF' AND TRIM(STR1.ID_SIO)=TRIM(CAST(CAST(CIR5.ID_PORTEF AS format 'Z(I)') AS VARCHAR(10))) AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE) LEFT JOIN %SOC%.TYP_OPERN_FACTN CIR6 ON STR1.CD_EDS_BNQ=CIR6.CD_BQE AND CIR1.TABLE_SOURCE='TYP_OPERN_FACTN' AND STR1.ID_SIO=CIR6.ID_OPERN_FACTN AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE) LEFT JOIN %SOC%.FNCTN CIR7 ON STR1.CD_EDS_BNQ=CIR7.CD_BQE AND CIR1.TABLE_SOURCE='FNCTN' AND TRIM(STR1.ID_SIO)=TRIM(CAST(CAST(CIR7.ID_FNCTN AS format 'Z(I)') AS VARCHAR(10))) AND CAST(CIR7.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR7.DF_HISTO AS DATE) LEFT JOIN %SOC%.TYP_TRCH_AGE CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_BQE AND CIR1.TABLE_SOURCE='TYP_TRCH_AGE' AND TRIM(STR1.ID_SIO) =TRIM(CIR8.CD_TRCH_AGE) AND CAST(CIR8.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR8.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_PROD_BDF CIR9 ON (STR1.CD_EDS_BNQ=CIR9.CD_BQE AND CIR1.TABLE_SOURCE='TYP_PROD_BDF' AND TRIM(STR1.ID_SIO)=TRIM(CAST(CIR9.CD_PROD_BDF AS VARCHAR(10))) AND CAST(CIR9.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR9.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.MRCH CIR10 ON (STR1.CD_EDS_BNQ=CIR10.CD_BQE AND CIR1.TABLE_SOURCE='MRCH' AND TRIM(STR1.ID_SIO)=TRIM(CAST(CIR10.ID_MRCH AS VARCHAR(10))) AND CAST(CIR10.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR10.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.SEGM_MRCH_CIAL CIR11 ON (STR1.CD_EDS_BNQ=CIR11.CD_BQE AND CIR11.CT_SEGM_CIAL = 9 AND CIR1.TABLE_SOURCE='SEGM_MRCH_CIAL' AND TRIM(STR1.ID_SIO)=TRIM(CAST(CIR11.ID_SEGM_CIAL AS VARCHAR(10))) AND CAST(CIR11.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR11.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_DUR_INITL_PRET CIR12 ON (STR1.CD_EDS_BNQ=CIR12.CD_BQE AND CIR1.TABLE_SOURCE='TYP_DUR_INITL_PRET' AND TRIM(STR1.ID_SIO)=TRIM(CAST(CIR12.CD_TRCH_DUR_INITL_PRET AS VARCHAR(10))) AND CAST(CIR12.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR12.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_NATU_CRED CIR13 ON (STR1.CD_EDS_BNQ=CIR13.CD_BQE AND CIR1.TABLE_SOURCE='TYP_NATU_CRED' AND TRIM(STR1.ID_SIO) =TRIM(CIR13.CD_NATU_CRED) AND CAST(CIR13.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR13.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_PART CIR14 ON (STR1.CD_EDS_BNQ=CIR14.CD_BQE AND CIR1.TABLE_SOURCE='TYP_PART' AND TRIM(STR1.ID_SIO) =TRIM(CIR14.CT_PART) AND CAST(CIR14.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR14.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_TRCH_NB_OPERN CIR15 ON (STR1.CD_EDS_BNQ=CIR15.CD_BQE AND CIR1.TABLE_SOURCE='TYP_TRCH_NB_OPERN' AND TRIM(STR1.ID_SIO) =TRIM(CIR15.CD_TRCH_NB_OPERN) AND CAST(CIR15.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR15.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_SEGM_NOTATN_BALE2 CIR16 ON (STR1.CD_EDS_BNQ=CIR16.CD_BQE AND CIR1.TABLE_SOURCE='TYP_SEGM_NOTATN_BALE2' AND TRIM(STR1.ID_SIO) =TRIM(CIR16.ID_SEGM_NOTATN_BALE2) AND CAST(CIR16.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR16.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.MTF_CLOT CIR17 ON (STR1.CD_EDS_BNQ=CIR17.CD_BQE AND CIR1.TABLE_SOURCE='MTF_CLOT' AND TRIM(STR1.ID_SIO) =TRIM(CIR17.CD_MTF_CLOT) AND CAST(CIR17.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR17.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.SEGM_EMACO CIR18 ON (STR1.CD_EDS_BNQ=CIR18.CD_BQE AND CIR1.TABLE_SOURCE='SEGM_EMACO' AND TRIM(STR1.ID_SIO) =TRIM(CIR18.ID_EMACO) AND CAST(CIR18.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR18.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.PST_FNCT CIR19 ON (STR1.CD_EDS_BNQ=CIR19.CD_BQE AND CIR1.TABLE_SOURCE='PST_FNCT' AND TRIM(STR1.ID_SIO) =TRIM(CIR19.CD_PST_FNCT) AND CAST(CIR19.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR19.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_CD_PROD_PLTAGE CIR20 ON (STR1.CD_EDS_BNQ=CIR20.CD_BQE AND CIR1.TABLE_SOURCE='TYP_CD_PROD_PLTAGE' AND TRIM(STR1.ID_SIO) =TRIM(CIR20.CD_PROD_PLTAGE)) LEFT JOIN %SOC%.TYP_TRCH_ANO_RISQ CIR21 ON (CIR1.TABLE_SOURCE='TYP_TRCH_ANO_RISQ' AND TRIM(STR1.ID_SIO) = TRIM (CIR21.CD_TRCH_ANO_RISQ) AND CAST(CIR21.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR21.DF_HISTO AS DATE) )
TYP_APPLI_ORIG_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
BAC000PR                                          select STR1.CD_EDS_BNQ , STR1.IDELC2 , CIR9.ID_DWR_EDC , STR1.CPFIB1 , CASE WHEN CIR9.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION from %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED CIR9 ON ( CIR9.CD_BQE=STR1.CD_EDS_BNQ AND CIR9.ID_EDC_CRED=STR1.IDELC2 AND CAST(CIR9.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR9.DF_HISTO AS DATE) ) WHERE 1=1 AND (STR1.CINTR0 >= '20' AND STR1.CINTR0 <= '28')
TYP_CNL_TECC_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
T1R52C                                            SELECT STR1.CD_EDS_BNQ , STR1.CDACTE , STR1.IDENTR IDENTR_BYTE ,CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDENTR) end AS VARCHAR(30)) AS IDENTR , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_ENTR , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_ENTR_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDENTR = CIR1.BY_SOURCE1) LEFT JOIN %DE1%.ACTECO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.CDACTE = CIR2.CDACTE)
PDI0VU12                                          SELECT STR1.CD_EDS_BNQ , STR1.CDENR2 , STR1.NUSEQ1 , STR1.CDOPE , STR1.CDBCF1 , STR1.CDBCF2 , STR1.CDAPPA , STR1.DTRA , STR1.CDENR5 , STR1.NUSEQ9 , STR1.FILLER_2 , STR1.NUMCR1 , STR1.DEEFM1 , STR1.DADAC , STR1.ZB001 , STR1.IDCDPA , STR1.IDVERP , STR1.RFCCS , STR1.ZB010 , STR1.MTCOU0 , STR1.ZB140 , STR1.ZB006 , STR1.ZB004 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_TECHN_COM_VNT                                 SELECT CD_BQE, CD_TECHN_COM_VNT, DD_HISTO, DF_HISTO FROM %SOC%.%ObjectNameFrom% WHERE DF_HISTO = '9999-12-31 00:00:00'
T1R19                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.CDPAYS , STR1.DDRESI , STR1.DFRESI , STR1.CDSTPR , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %SOC%.PAYS CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CDPAYS = CIR2.ID_CD_PAYS)
CTACAF                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCAF , STR1.IDMEST , STR1.IDES , STR1.IDWO , STR1.IDPARZ , STR1.IDPART , STR1.LNCRP , STR1.DICAF , STR1.DDTCAF , STR1.DFTCAF , STR1.CDROLL , STR1.CPCAF , STR1.DMCAF , STR1.CPCAFP , STR1.DMCAFP , STR1.CPECAF , STR1.DMECAF , STR1.CDOCN , STR1.IDRAA , STR1.CCDAC , STR1.LIACP , STR1.KFCNT7 , STR1.QCMDCR , STR1.DERDV , STR1.QTAPP4 , STR1.CTACF , STR1.IDTCN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART_COM , COALESCE(CIR3.ID_DWR_PST_FNCT,0) ID_DWR_PST_FNCT , COALESCE(CIR4.IDCNT,0) IDCNT , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPARZ = CIR2.ID_SOURCE1) LEFT JOIN (SELECT CD_BQE, CD_PST_FNCT, MAX(ID_DWR_PST_FNCT) AS ID_DWR_PST_FNCT FROM %SOC%.PST_FNCT GROUP BY 1, 2) CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_BQE AND STR1.IDWO = CIR3.CD_PST_FNCT) LEFT JOIN %DE1%.CORCAF CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_EDS_BNQ AND STR1.IDCAF = CIR4.IDCAF) LEFT JOIN (SELECT DISTINCT CD_BQE, ID_TECHN_CNTCT FROM %SOC%.TECHN_CNTCT) AS CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_BQE AND STR1.IDTCN = CIR5.ID_TECHN_CNTCT)
GRCO_PNA_FIL_CTR_M                                SELECT STR1.CDOEPA, STR1.IDSTU, STR1.DFCOLT, STR1.DCARR3, STR1.CDFIL2, STR1.IDPRET, STR1.IDELCH, STR1.CCONT4, STR1.IDPOCE, STR1.ICLAN, STR1.ISEGN, STR1.GRAPDE, STR1.CDSTGO, STR1.GRAGDR, STR1.CTOPA7, STR1.DDFON4, STR1.DURACB, STR1.CDNIVR, STR1.CDNIVE, STR1.CDNMOB, STR1.TG19, STR1.MTENCA, STR1.MTHEN1, STR1.MTEADC, STR1.MTEXL, STR1.KFMAT1, STR1.MTEXLB, STR1.IDPOBT, STR1.CDPOB, STR1.MTPRV, STR1.CDMPNA, STR1.NOPPC1, STR1.IDEXEY, STR1.DCARR7, STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
OPERN_DE_MRCH_EXPOSE_MENS                         SELECT DISTINCT STR1.CD_BQE AS CD_EDS_BNQ , STR1.DD_PE , STR1.ID_DWR_CREANC_EXPOSE , STR1.CD_NATU_RISQ_CONTREPARTIE as CD_NATU_RISQ_CONTREPARTIE_OP , 1 AS REF_OPERN FROM %WRK%.%ObjectNameFrom% STR1 Order by CD_EDS_BNQ,DD_PE,ID_DWR_CREANC_EXPOSE
TYP_CD_OBJ_RDV_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRC817                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDECV , STR1.DTECO , STR1.DLECO , STR1.DRECO , STR1.CPOBJE , STR1.CPPIJ , STR1.ZTEVER , STR1.IDACTD , STR1.IDCOV , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_CD_PRES_PCE_JUSTIF CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CPPIJ = CIR1.CD_PRES_PCE_JUSTIF) LEFT JOIN (SELECT S1.CD_BQE , ID_COVENANT ,DD_HISTO ,DF_HISTO FROM (SELECT DISTINCT CD_BQE ,ID_COVENANT ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.COVENANT UNION SELECT DISTINCT CD_BQE ,ID_COVENANT ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.COVENANT) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_COVENANT ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 ) CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDCOV = CIR2.ID_COVENANT) LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CPOBJE = CIR3.CD_STATU_CRED_COMPLEXE)
GRCO_GARANTIE                                     SELECT STR1.IDEXEY ,STR1.DFCOLT ,STR1.IDELCH ,STR1.IDGARP ,STR1.IDPRET ,STR1.IDPOCE ,STR1.MKVAG1 ,STR1.NM684 ,STR1.NMTGAR ,STR1.DCARR7 FROM %BRL%.%ObjectNameFrom% STR1
MTF_OUV_CST                                       SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ACTION                                            SELECT STR1.CD_EDS_BNQ , STR1.ACTION_ID , STR1.ACTION_LIBELLE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TDSCK106                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.NCHQ , STR1.NOLOT4 , STR1.NOMIF9 , STR1.CORIG , STR1.LNBQE , STR1.CDPRV , STR1.REFEXT , STR1.CDRFO1 , STR1.DTARCH , STR1.FILLER128 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
DB2CIVIL                                          SELECT STR1.CD_EDS_BNQ , STR1.CLIBISPE , STR1.LIBISPE , STR1.CDRGCIV , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.LIBISPLG , STR1.CDTCISCT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
HISPRO                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDGRRI , STR1.IDENTR IDENTR_BYTE , CAST(CASE WHEN CIR5.CD_EDS_BNQ is not null Then CIR5.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDENTR) end AS VARCHAR(30)) AS IDENTR , STR1.CDGRNO , STR1.NOSIRI , STR1.IDPART , STR1.DACRE9 , STR1.NOVER7 , STR1.IDVERN , STR1.DCARRD , STR1.MAENT5 , STR1.QTEFF5 , STR1.NBJOU , STR1.MTEBE , STR1.NBMOIK , STR1.MTIMP0 , STR1.MTBIRE , STR1.MTPRD , STR1.MTREPR , STR1.MTENGA , STR1.MTVAA0 , STR1.MTCAF , STR1.MTCAFA , STR1.MTTREN , STR1.MTEBE1 , STR1.MTVAAJ , STR1.MCCRE4 , STR1.MTDRS3 , STR1.MTLIQU , STR1.MTREAS , STR1.MKCAQ0 , STR1.MTACHM , STR1.NOTPTP , STR1.NOTCPC , STR1.GRAEDC , STR1.MTFOPR , STR1.MTFOR0 , STR1.MTBEF0 , STR1.MJENDQ , STR1.MICAL0 , STR1.MTACCI , STR1.MJENDR , STR1.MICAL1 , STR1.MJENDS , STR1.MTVAA1 , STR1.MTCHA0 , STR1.MTEBE0 , STR1.MTPCHE , STR1.MTFOP0 , STR1.MTLIQ0 , STR1.MTAVA3 , STR1.MJENDT , STR1.NOTFI0 , STR1.NOTFI1 , STR1.NOTFRA , STR1.NOTREF , STR1.NOTDET , STR1.MTEMPR , STR1.MJENDU , STR1.MTCHAD , STR1.MTMOND , STR1.MTMONE , STR1.NOTFI2 , STR1.NOTPRE , STR1.NOTDEL , STR1.NOTPSO , STR1.CDRASO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR, 0) ID_DWR_PART_CIR1 , COALESCE(CIR2.ID_DWR_PART, 0) ID_DWR_PART_CIR2 , COALESCE(CIR3.ID_DWR_ENTR, 0) ID_DWR_ENTR_CIR3 , CAST(COALESCE(CIR4.ID_SOURCE1, '') AS CHAR(30)) ID_SOURCE1_CIR4 , COALESCE(CIR5.ID_DWR, 0) ID_DWR_ENTR_CIR5 , COALESCE(CIR6.ID_DWR_ENTR, 0) ID_DWR_ENTR_CIR6 , COALESCE(CIR7.ID_DWR_PART, 0) ID_DWR_PART_CIR7 , CAST(COALESCE(CIR8.ID_SOURCE1, '') AS CHAR(15)) ID_SOURCE1_CIR8 , CASE WHEN TRIM(IDPART) = '' THEN 1 ELSE 0 END IDPART_VIDE , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 , Case When CIR7.CD_BQE is null then 0 else 1 End Row_Found_CIR7 , Case When CIR8.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR8 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT OUTER JOIN %SOC%.PART CIR2 ON ( CIR2.ID_DWR_PART=CIR1.ID_DWR AND CIR1.CD_EDS_BNQ = CIR2.CD_BQE AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.PART_POSSED_ENTR CIR3 ON (CIR1.CD_EDS_BNQ = CIR3.CD_BQE AND CIR1.ID_DWR = CIR3.ID_DWR_PART AND CIR3.DD_VALID <= STR1.DCARRD AND CIR3.DF_VALID > STR1.DCARRD) LEFT OUTER JOIN %TCO%.ID_ENTR_TCO CIR4 ON (CIR3.CD_BQE = CIR4.CD_EDS_BNQ AND CIR3.ID_DWR_ENTR = CIR4.ID_DWR ) LEFT OUTER JOIN %TCO%.ID_ENTR_TCO CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_EDS_BNQ AND STR1.IDENTR = CIR5.BY_SOURCE1) LEFT OUTER JOIN %SOC%.ENTR CIR6 ON ( CIR6.ID_DWR_ENTR=CIR5.ID_DWR AND CIR5.CD_EDS_BNQ = CIR6.CD_BQE AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.PART_POSSED_ENTR CIR7 ON(CIR5.CD_EDS_BNQ = CIR7.CD_BQE AND CIR5.ID_DWR = CIR7.ID_DWR_ENTR AND CIR7.DD_VALID <= STR1.DCARRD AND CIR7.DF_VALID > STR1.DCARRD) LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR8 ON (CIR7.CD_BQE = CIR8.CD_EDS_BNQ AND CIR7.ID_DWR_PART = CIR8.ID_DWR)
DGXG45                                            SELECT STR1.CD_EDS_BNQ , STR1.IDAGT , STR1.DJPLA , STR1.HEDPA , STR1.HEFPA , STR1.IDWO , STR1.IDTAC , STR1.CTSRV , TRIM(CAST(STR1.LMRVS AS VARCHAR(50))) AS LMRVS , STR1.CPIBP , STR1.IDES , CAST(STR1.IDES AS INTEGER) IDES_INT , STR1.IDPN , TRIM(CAST(STR1.LMPRV AS VARCHAR(50))) AS LMPRV , STR1.DMDAC , STR1.QCPAG , STR1.IDAGT1 , STR1.IDESD3 , STR1.CPMYP , STR1.IDESD4 , STR1.CDTHE3 , STR1.CDOBJT , TRIM(CAST(STR1.NUTEPA AS VARCHAR(17))) AS NUTEPA , STR1.CBCHLU , STR1.CBEDIT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.ID_DWR_PST_FNCT , CIR2.ID_DWR_AGT , CIR3.ID_DWR_AGT AS AGT_ID_DWR_AGT , CIR4.ID_DWR_EDS , CIR9.ID_DWR_PART , CIR5.ID_PART , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 , Case When CIR7.CD_BQE is null then 0 else 1 End Row_Found_CIR7 , Case When CIR8.CD_BQE is null then 0 else 1 End Row_Found_CIR8 , Case When CIR9.CD_BQE is null then 0 else 1 End Row_Found_CIR9 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.PST_FNCT CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDWO = CIR1.CD_PST_FNCT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.AGT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDAGT = CIR2.ID_AGT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.AGT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDAGT1= CIR3.ID_AGT AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN ( SELECT CD_BQE, ID_EXT_EDS, ID_DWR_EDS, DD_VALID, DF_VALID, DD_HISTO, DF_HISTO FROM %SOC%.ELT_DE_STRUCT ELT INNER JOIN (SELECT CD_BQE AS CD_BQE_MIN ,ID_EXT_EDS AS ID_EXT_EDS_MIN ,MIN(ID_TYP_EDS) AS ID_TYP_EDS_MIN FROM %SOC%.ELT_DE_STRUCT GROUP BY CD_BQE,ID_EXT_EDS) AS ELT_MIN ON (ELT.CD_BQE=ELT_MIN.CD_BQE_MIN AND ELT.ID_EXT_EDS=ELT_MIN.ID_EXT_EDS_MIN AND ELT.ID_TYP_EDS=ELT_MIN.ID_TYP_EDS_MIN) )CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND CAST(STR1.IDES AS INTEGER) = CIR4.ID_EXT_EDS AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE) AND CAST(CIR4.DD_VALID AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_VALID AS DATE) ) LEFT JOIN %SOC%.TYP_CD_OBJ_RDV CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_BQE AND STR1.CDOBJT= CIR6.CD_OBJ_RDV AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_ACTI_AGT CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_BQE AND STR1.IDTAC = CIR7.ID_TYP_ACTI AND CAST(CIR7.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR7.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_CD_THEME CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_BQE AND STR1.CDTHE3= CIR8.CD_THEME AND CAST(CIR8.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR8.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PART_PART_EMACO CIR9 ON (STR1.CD_EDS_BNQ=CIR9.CD_BQE AND STR1.IDPN = CIR9.ID_PART_EMACO) LEFT JOIN %SOC%.PART CIR5 ON (CIR9.CD_BQE=CIR5.CD_BQE AND CIR9.ID_DWR_PART=CIR5.ID_DWR_PART AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE))
TYP_MTF_DECI_RCESN_CST                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
PROFILSQUOTD                                      SELECT STR1.CD_EDS_BNQ ,TCO1.ID_DWR as ID_DWR_PRFL_MABQE ,COALESCE(CIR1.ID_DWR_PART,-1) AS ID_DWR_PART ,STR1.CPTEBAM ,STR1.IDCAEL ,STR1.CDBQE ,STR1.DTCREAT ,STR1.DT_ELIG ,STR1.RE_CYCLE ,STR1.IDPROFIL ,STR1.IDPART ,STR1.DTSYNC ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END AS Row_Found_TCO1 ,CASE WHEN CIR1.CD_BQE IS NULL AND COALESCE(TRIM(STR1.IDPART),'')<>'' THEN 0 ELSE 1 END AS Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PRFL_MABQE_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDPROFIL = TCO1.ID_SOURCE1) LEFT JOIN %SOC%.PART CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDPART = CIR1.ID_PART AND STR1.DT_ELIG >= CIR1.DD_HISTO AND STR1.DT_ELIG < CIR1.DF_HISTO)
GRCO_TIERS                                        SELECT STR1.CD_EDS_BNQ ,STR1.DFCOLT ,STR1.IDPOCE ,STR1.ISEGN ,STR1.IDPOBT ,STR1.CDACTN ,STR1.DCARR7 ,STR1.CDMC4 ,STR1.NTIER0 ,STR1.CCONTR ,STR1.NOSIR4 ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,COALESCE(CIR1.ID_DWR_PART,0) AS ID_DWR_PART ,CIR1.CT_PART ,CIR1.ID_PART ,CIR1.ID_MRCH ,CIR1.CD_RESDT_FISCAL ,CIR1.CD_ABRG_CVLT ,CIR1.DD_HISTO ,CIR1.DF_HISTO ,COALESCE (CIR9.CD_FLIER_CALCL,'0') AS CD_FLIER_CALCL ,COALESCE (CIR2.CD_PORTEF_BALE_TIERS,'0') AS CD_PORTEF_BALE_TIERS ,COALESCE (CIR3.CD_SEGM_NOTATN_BALE,'0') AS CD_SEGM_NOTATN_BALE ,CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_TCO1 ,CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 ,CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 ,CASE WHEN CIR21.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR21 ,CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 ,CASE WHEN CIR31.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR31 ,CASE WHEN CIR4.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR4 ,CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR5 ,CASE WHEN CIR6.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR6 ,CASE WHEN CIR7.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR7 ,CASE WHEN CIR8.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR8 ,CASE WHEN CIR9.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR9 ,CASE WHEN TRIM(STR1.CDACTN) NOT IN ('00000','0000Z','') AND STR1.CDACTN IS NOT NULL THEN STR1.CDACTN ELSE CASE WHEN CIR1.CT_PART='ET' AND CIR8.CD_ACTI_ECON IS NOT NULL THEN CIR8.CD_ACTI_ECON ELSE CASE WHEN CIR1.CT_PART <>'ET' AND CIR6.CD_ACTI_ECON IS NOT NULL THEN CIR6.CD_ACTI_ECON ELSE '99999' END END END AS CD_FLIER_CALCL1 ,CASE WHEN CIR6.DD_VALID IS NULL THEN CAST('1900-01-01' as DATE) ELSE CIR6.DD_VALID END as DD_VALID_CIR6 ,CASE WHEN CIR8.DD_VALID IS NULL THEN CAST('1900-01-01' as DATE) ELSE CIR8.DD_VALID END as DD_VALID_CIR8 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDPOCE=TCO1.ID_SOURCE1) LEFT JOIN %SOC%.PART CIR1 ON (CIR1.CD_BQE=TCO1.CD_EDS_BNQ AND TCO1.ID_DWR=CIR1.ID_DWR_PART AND CIR1.DF_HISTO = '9999-12-31 00:00:00') AND CIR1.DT_CREAT_PART <= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CIR1.DT_CLOT_PART LEFT JOIN %SOC%.TYP_PORTEF_BALE_TIERS CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDPOBT = CIR2.CD_PORTEF_BALE_TIERS AND CAST(CIR2.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_CATG_CONTREPARTIE CIR21 ON(STR1.CD_EDS_BNQ=CIR21.CD_BQE AND STR1.CCONTR = CIR21.CD_CATG_CONTREPARTIE AND CAST(CIR21.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR21.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_SEGM_NOTATN_BALE CIR3 ON(STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.ISEGN = CIR3.CD_SEGM_NOTATN_BALE AND CAST(CIR3.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_METHD_NOTATN_PART CIR31 ON(STR1.CD_EDS_BNQ=CIR31.CD_BQE AND STR1.CDMC4 = CIR31.CD_METHD_NOTATN_PART AND CAST(CIR31.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR31.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PART_POSSED_ENTR CIR4 ON (CIR4.CD_BQE=CIR1.CD_BQE AND CIR4.ID_DWR_PART=CIR1.ID_DWR_PART AND CAST(CIR4.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ENTR CIR5 ON (CIR5.CD_BQE=CIR4.CD_BQE AND CIR5.ID_DWR_ENTR=CIR4.ID_DWR_ENTR AND CAST(CIR5.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ENTR_ACTI_ECON CIR6 ON (CIR6.CD_BQE=CIR5.CD_BQE AND TRIM(CIR6.CD_ACTI_ECON) NOT IN('00000','0000Z','') AND CIR6.ID_DWR_ENTR=CIR5.ID_DWR_ENTR AND CAST(CIR6.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR6.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ETS CIR7 ON (CIR7.CD_BQE=CIR1.CD_BQE AND CIR7.ID_ETS=CIR1.ID_PART AND CAST(CIR7.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR7.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ETS_ACTI_ECON CIR8 ON (CIR8.CD_BQE=CIR7.CD_BQE AND CIR8 .CD_ACTI_PRINCIPAL_SECD = 'P' AND TRIM(CIR8.CD_ACTI_ECON) NOT IN('00000','0000Z','') AND CIR8.ID_DWR_ETS=CIR7.ID_DWR_ETS AND CAST(CIR8.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR8.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_FLIER_CALCL CIR9 ON (CIR9.CD_FLIER_CALCL=CD_FLIER_CALCL1 AND CIR9.CD_BQE=STR1.CD_EDS_BNQ AND CAST(CIR9.DD_HISTO AS DATE)<= TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) AND TD_MONTH_END( ADD_MONTHS (DT_ELIG,-1)) < CAST (CIR9.DF_HISTO AS DATE))
CNL_CST                                           SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DTWHES06                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ IS NOT NULL THEN TCO1.ID_SOURCE1 ELSE %PMU%.Bin2Char(STR1.IDELCO) END AS VARCHAR(30)) AS IDELCO , STR1.IDCTRX , STR1.IDCDPN , STR1.IDPART , STR1.DCARR8 , STR1.CADEVI , STR1.QTEFFA , STR1.QTEFFB , STR1.MTVERN , STR1.MTVERO , STR1.MCRET4 , STR1.MCRET5 , STR1.DADEV , STR1.MSTNC4 , STR1.MTCMNA , STR1.MTCMNB , STR1.MFDIV2 , STR1.MTCMNC , STR1.MTCMND , STR1.MTCMNE , STR1.IDELCF , STR1.NOSIR5 , STR1.NUSRT , STR1.LNPART , STR1.IDPRS7 , STR1.MXTRPC , STR1.MXTRVC , STR1.MTCMNL , STR1.MTCMNM , STR1.MTCMNN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR2.CT_CLI , COALESCE(CIR2.ID_DWR_EDC,0) AS ID_DWR_EDC , CIR2.CD_STATU_PRNCP , CIR2.DT_EFFT_CTR , CIR2.DT_FERM , CIR2.CT_DSPSTF , CIR2.LI_TYP_DSPSTF , CIR2.DT_PLAN , Case When CIR1.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD') LEFT JOIN %SOC%.DEVIS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CADEVI = CIR1.CD_DEVIS_ISO AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT OUTER JOIN ( SELECT S1.CD_BQE, S1.ID_DWR_EDC, S1.ID_EDC_VEGA, S1.CT_CLI, S1.CD_STATU_PRNCP, S1.DT_EFFT_CTR, S1.DT_FERM, S1.CT_DSPSTF, S1.LI_TYP_DSPSTF, S1.DT_PLAN, S1.DD_HISTO, S1.DF_HISTO FROM ( SELECT DISTINCT CD_BQE, ID_DWR_EDC, ID_EDC_VEGA, CT_CLI, CD_STATU_PRNCP, DT_EFFT_CTR, DT_FERM, CT_DSPSTF, LI_TYP_DSPSTF, DT_PLAN, DD_HISTO, DF_HISTO, '1' AS RECENT FROM %SOC%.EPRGN_SALRL UNION SELECT DISTINCT CD_BQE, ID_DWR_EDC, ID_EDC_VEGA, CT_CLI, CD_STATU_PRNCP, DT_EFFT_CTR, DT_FERM, CT_DSPSTF, LI_TYP_DSPSTF, DT_PLAN, DD_HISTO, DF_HISTO, '0' AS RECENT FROM %WRK%.EPRGN_SALRL ) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_DWR_EDC ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 ) CIR2 ON ( STR1.CD_EDS_BNQ = CIR2.CD_BQE AND CAST( TCO1.ID_SOURCE1 AS VARCHAR(30))= CIR2.ID_EDC_VEGA)
FACILIT                                           SELECT STR1.CD_EDS_BNQ , STR1.IDNDO9 , STR1. IDSTUC , STR1.IDPACC , STR1.NCPTD1 , STR1.IDSTUA , cast (STR1.IDSTUA as integer) as IDSTUA_int , IDSTUA_int * 100 as IDSTUA100 , case when IDSTUA_int <> '00764' then ( IDSTUA_int * 100) else '86803' end CD_BQE_ACCLNT , cast (CD_BQE_ACCLNT as integer ) as IDSTUA1 , STR1.IDPACA , STR1.RE_CYCLE , TD_MONTH_BEGIN(cast (STR1.DT_ELIG as date) )AS DD_PE_ELIG , cast (TD_MONTH_END(cast (STR1.DT_ELIG as date) )as TIMESTAMP(0) ) AS DD_HISTO , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , 'MC' as CT_PE , TCO1.ID_DWR AS ID_DWR_PART_CED , TCO2.ID_DWR AS ID_DWR_PART_ACC FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDPACC=TCO1.ID_SOURCE1) LEFT OUTER JOIN %TCO%.ID_PART_TCO TCO2 ON (IDSTUA1=TCO2.CD_EDS_BNQ AND STR1.IDPACA=TCO2.ID_SOURCE1)
GRA001                                            SELECT distinct STR1.CD_EDS_BNQ , STR1.GRA001_IDELCO , STR1.IDPART , STR1.PDURPR , STR1.DHZEPR , STR1.DHDNPR , STR1.CFPEPR , STR1.CQTXPR , STR1.MKUTPR , STR1.CDLDAI , STR1.DFPRET , STR1.DADOCR , STR1.DA1ECH , STR1.NOOPPR , STR1.NOPRPR , STR1.NOCLIN , STR1.CCATPR , STR1.CCATFI , STR1.CDCOMP , STR1.CDLAPR , STR1.CDTECR , STR1.MTPACR , STR1.MTFGPR , STR1.TXACPR , STR1.MKDEBL , STR1.MKDURE , STR1.MKDUTH , STR1.DA1REA , STR1.MKRAPR , STR1.DAREPR , STR1.CDSUPR , STR1.QTPACS , STR1.CDBIPR , STR1.CDLINV , STR1.DDTPPR , STR1.CDTKCR , STR1.CDOMIN , STR1.CDESFI , STR1.CDSOPR , STR1.CDLCPR , STR1.CDPEXT , STR1.CDDEPR , STR1.CDLIPR , STR1.CDGSPR , STR1.CDAPPR , STR1.DAIELC , STR1.MTTHPR , STR1.MTECFX , STR1.DAMJEC , STR1.ZTEVER , CIR8.CDSSMA , CIR8.CDSINS , STR1.CT1DPR , STR1.CT2DPR , STR1.CT3DPR , STR1.DHPPR , STR1.DAGATA , STR1.PD3DPR , STR1.CDANPR , STR1.CDELPR , STR1.CQPJPR , STR1.CDSPAR , STR1.PD1DPR , STR1.PD2DPR , STR1.CTINDX , STR1.CDIFCG , STR1.CDAEFI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR3.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_PLFD_UTIL , CIR1.GRA610_IDLIMI GRA610_IDLIMI , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , COALESCE(CIR2.CTLIMI,0) AS CTLIMI_FILTR , COALESCE(CIR4.CDDOM3,'') AS CDDOM3_FILTR , CIR5.CDDOM3 AS CDDOM3 , CAST(CASE WHEN TCO2.CD_EDS_BNQ is not null Then TCO2.ID_SOURCE1 else %PMU%.Bin2Char(CIR5.IDELCO) end AS VARCHAR(30)) AS IDELCO , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , COALESCE(TCO2.ID_DWR,0) AS ID_DWR_EDC_CRED , CIR6.CTECH1 AS CTECH1 , CIR6.CETCO3 AS CETCO3 , Case When CIR6.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR6 , Case When CIR7.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR7 , Case When CIR10.CD_BQE is null then 0 else 1 End Row_Found_CIR10 , Case When CIR11.CD_BQE is null then 0 else 1 End Row_Found_CIR11 , Case When CIR12.CD_BQE is null then 0 else 1 End Row_Found_CIR12 , COALESCE(CIR8.IDPRJT,'') AS IDPRJT , CIR8.CDSSCR AS CDSSCR , CIR8.CTDFIN AS CTDFIN , STR1.PDINPR AS PDINPR , CIR8.CTCRST AS CTCRST , COALESCE(CIR14.CD_SOLTN_HAB,0) AS CD_SOLTN_HAB , CAST(Case when ( CIR13.IDPRJT) is null THEN 0 Else Case when CIR13.CDSLHA is null OR trim(CIR13.CDSLHA) ='' THEN 0 Else Case when CIR14.CD_SOLTN_HAB is not null THEN CIR13.CDSLHA Else 0 END END END as BYTEINT) CD_SOLTN_HAB_CALC , CAST(Case when STR1.CDLINV is null or STR1.CDLINV ='' then '-1' when SUBSTR(STR1.CDLINV,1,2)='97' or SUBSTR(STR1.CDLINV,1,2)='98' then SUBSTR(STR1.CDLINV,1,3) else SUBSTR(STR1.CDLINV,1,2) END as char(3)) CD_DEPT_INVSTMNT , COALESCE(CIR9W.CD_AMRTSM,CIR9S.CD_AMRTSM) CD_AMRTSM , COALESCE(CIR9W.ID_AGT,CIR9S.ID_AGT) ID_AGT , COALESCE(CIR9W.ID_DWR_AGT,CIR9S.ID_DWR_AGT) ID_DWR_AGT , COALESCE(CIR9W.CD_REFERENCE_TX,CIR9S.CD_REFERENCE_TX) CD_REFERENCE_TX , COALESCE(CIR9W.TX_MAJORATION_MINORATION,CIR9S.TX_MAJORATION_MINORATION) TX_MAJORATION_MINORATION , COALESCE(CIR9W.DT_EDT,CIR9S.DT_EDT) DT_EDT , COALESCE(CIR9W.SECTEUR_FINCT,CIR9S.SECTEUR_FINCT) SECTEUR_FINCT , COALESCE(CIR9W.CD_STADE_AVANCEMENT,CIR9S.CD_STADE_AVANCEMENT) CD_STADE_AVANCEMENT , COALESCE(CIR9W.DT_EMISSON_OFR_CRED,CIR9S.DT_EMISSON_OFR_CRED) DT_EMISSON_OFR_CRED , COALESCE(CIR9W.DT_RCPTN_OFR_CRED_GED,CIR9S.DT_RCPTN_OFR_CRED_GED) DT_RCPTN_OFR_CRED_GED , COALESCE(CIR9W.DT_TRT_REALN_CRED,CIR9S.DT_TRT_REALN_CRED) DT_TRT_REALN_CRED , COALESCE(CIR9W.DT_DECI_AP,CIR9S.DT_DECI_AP) DT_DECI_AP , COALESCE(CIR9W.MT_FRAIS_DOSS_ABND,CIR9S.MT_FRAIS_DOSS_ABND) MT_FRAIS_DOSS_ABND , COALESCE(CIR9W.MT_FRAIS_DOSS_INTL,CIR9S.MT_FRAIS_DOSS_INTL) MT_FRAIS_DOSS_INTL , COALESCE(CIR9W.DUR_MAX_CRED,CIR9S.DUR_MAX_CRED) DUR_MAX_CRED , COALESCE(CIR9W.DUR_ANTCPTN_CRED,CIR9S.DUR_ANTCPTN_CRED) DUR_ANTCPTN_CRED , COALESCE(CIR9W.DT_DER_REALN,CIR9S.DT_DER_REALN) DT_DER_REALN , COALESCE(CIR9W.DT_ARCHIVG_CRED,CIR9S.DT_ARCHIVG_CRED) DT_ARCHIVG_CRED , COALESCE(CIR9W.CD_CATG_JUR,CIR9S.CD_CATG_JUR) CD_CATG_JUR FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.GRA610 CIR1 ON (CIR1.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR1.GRA610_IDELCO=STR1.GRA001_IDELCO AND CIR1.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.GRA606 CIR2 ON (CIR2.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and CIR2.GRA606_IDLIMI=CIR1.GRA610_IDLIMI AND CIR2.TK_ACTION in ('I','U')) LEFT JOIN %SOC%.ECD_DETENU CIR3 ON (CIR2.CD_EDS_BNQ=CIR3.CD_BQE AND CIR2.GRA606_IDELCO IS NOT NULL AND CIR2.GRA606_IDELCO=CIR3.ID_EDC_CRED AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE) AND CIR3.ID_EDC_CRED IS NOT NULL) LEFT JOIN %TCO%.ID_PLFD_UTIL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.GRA001_IDELCO||'0'= TCO1.ID_SOURCE1) LEFT JOIN %DE1%.E2R19G CIR4 ON (CIR4.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and CIR4.IDELC2=CIR2.GRA606_IDELCO AND CIR4.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.E2R19G CIR5 ON (CIR5.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR5.IDELC2=STR1.GRA001_IDELCO AND CIR5.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_EDC_TCO TCO2 ON (CIR5.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND CIR5.IDELCO= TCO2.BY_SOURCE1 AND substr(TCO2.ID_SOURCE1, character(TCO2.ID_SOURCE1)-2)='ECD') LEFT JOIN %DE1%.COMPGR CIR6 ON (CIR6.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR6.IDELC2=STR1.GRA001_IDELCO AND CIR6.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.GRA470 CIR7 ON (CIR7.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR7.GRA470_IDELCO=STR1.GRA001_IDELCO AND CIR7.TK_ACTION in ('I','U') AND CIR7.CTSPEC=1) LEFT JOIN %DE1%.GRA011 CIR8 ON (CIR8.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR8.GRA011_IDELCO=STR1.GRA001_IDELCO AND CIR8.TK_ACTION in ('I','U')) LEFT JOIN %SOC%.TYP_TYP_DESTN_FINCT CIR10 ON (CIR8.CD_EDS_BNQ =CIR10.CD_BQE and CIR8.CTDFIN=CIR10.CT_DESTN_FINCT AND CAST(CIR10.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR10.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_DUR_INITL_PRET CIR11 ON (STR1.CD_EDS_BNQ =CIR11.CD_BQE and STR1.PDINPR=CIR11.DUR_INITL_PRET AND CAST(CIR11.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR11.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_CT_RESTRICTION_CRED CIR12 ON (CIR8.CD_EDS_BNQ =CIR12.CD_BQE and CIR8.CTCRST=CIR12.CT_RESTRCTRTN_CRED AND CAST(CIR12.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR12.DF_HISTO AS DATE) ) LEFT JOIN %DE1%.GRC560 CIR13 ON(CIR8.CD_EDS_BNQ =CIR13.CD_EDS_BNQ AND CIR8.IDPRJT=CIR13.IDPRJT ) LEFT JOIN %SOC%.TYP_SOLTN_HAB CIR14 ON(CIR13.CD_EDS_BNQ =CIR14.CD_BQE AND CIR13.CDSLHA=CIR14.CD_SOLTN_HAB AND CAST(CIR14.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR14.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CRED CIR9S ON ( CIR9S.ID_DWR_EDC=TCO2.ID_DWR AND CIR9S.CD_BQE=TCO2.CD_EDS_BNQ AND CAST(CIR9S.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR9S.DF_HISTO AS DATE) ) LEFT JOIN ( SELECT CD_BQE ,ID_DWR_EDC ,DD_HISTO ,DF_HISTO ,CD_AMRTSM ,ID_AGT ,ID_DWR_AGT ,CD_REFERENCE_TX ,TX_MAJORATION_MINORATION ,DT_EDT ,SECTEUR_FINCT ,CD_STADE_AVANCEMENT ,DT_EMISSON_OFR_CRED ,DT_RCPTN_OFR_CRED_GED ,DT_TRT_REALN_CRED ,DT_DECI_AP ,MT_FRAIS_DOSS_ABND ,MT_FRAIS_DOSS_INTL ,DUR_MAX_CRED ,DUR_ANTCPTN_CRED ,DT_DER_REALN ,DT_ARCHIVG_CRED ,CD_CATG_JUR FROM %WRK%.CRED QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_BQE,ID_DWR_EDC ORDER BY DD_HISTO DESC,DF_HISTO DESC)=1 ) CIR9W ON ( CIR9W.ID_DWR_EDC=TCO2.ID_DWR AND CIR9W.CD_BQE=TCO2.CD_EDS_BNQ AND CAST(CIR9W.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR9W.DF_HISTO AS DATE) )
ID_TYP_SITUA_PARTC_TCO                            SELECT ID_DWR , CD_EDS_BNQ , ID_SOURCE1 FROM %TCO%.%ObjectNameFrom%
EXCCRDVX                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.IDCTRA IDCTRA_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCTRA) AS VARCHAR(30)) AS IDCTRA , STR1.IDCLI1 , STR1.IDPACO , STR1.DDFONC , STR1.DFFONC , STR1.IDELCK , STR1.CPPCR6 , STR1.DA1RU , STR1.MKRDR , STR1.MTCRDT , STR1.TXAVA0 , STR1.NBERE0 , STR1.MTRETA , STR1.MTRNO1 , STR1.MTRNO2 , STR1.MTRAN2 , STR1.MTRAN3 , STR1.MTREA6 , STR1.IDPROD , STR1.MTECH4 , STR1.MTRAN1 , STR1.MKRBP1 , STR1.MRASSA , STR1.MTRSTA , STR1.MTADI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR_EDC, (COALESCE(CIR1.ID_DWR_EDC,0))) AS ID_DWR_EDC , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_TCO1 , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND substr(TCO1.ID_SOURCE1, character(TCO1.ID_SOURCE1)-2)='ECD') LEFT JOIN %SOC%.CRED CIR2 ON (CIR2.CD_BQE=TCO1.CD_EDS_BNQ AND TCO1.ID_DWR=CIR2.ID_DWR_EDC AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PLFD_UTIL CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELCK=CIR1.ID_EDC_ECHCE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_NATU_CRED CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDPROD=CIR3.CD_NATU_CRED AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
PROFILSHEBDO                                      SELECT STR1.CD_EDS_BNQ ,TCO1.ID_DWR as ID_DWR_PRFL_MABQE ,COALESCE(CIR1.ID_DWR_PART ,-1) AS ID_DWR_PART ,STR1.CPTEBAM ,STR1.IDCAEL ,STR1.CDBQE ,STR1.DTCREAT ,STR1.DT_ELIG ,STR1.RE_CYCLE ,STR1.IDPROFIL ,STR1.IDPART ,STR1.DTSYNC ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END AS Row_Found_TCO1 ,CASE WHEN CIR1.CD_BQE IS NULL AND COALESCE(TRIM(STR1.IDPART),'')<>'' THEN 0 ELSE 1 END AS Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PRFL_MABQE_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDPROFIL = TCO1.ID_SOURCE1) LEFT JOIN %SOC%.PART CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDPART = CIR1.ID_PART AND STR1.DT_ELIG >= CIR1.DD_HISTO AND STR1.DT_ELIG < CIR1.DF_HISTO)
TYP_OPERN_FACTN_CST                               SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
CHOIX_SUR_OPTN                                    SELECT STR1.CD_EDS_BNQ , STR1.CD_CHOIX_SUR_OPTN , STR1.APPLTN_CIALE_CHOIX_SUR_OPTN , STR1.LI_CHOIX_SUR_OPTN , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
PDIVPIVP                                          SELECT STR1.CD_EDS_BNQ , STR1.CDENR2 , STR1.NUSEQ1 , STR1.CDOPE , STR1.CDBCF1 , STR1.CDBCF2 , STR1.CDAPPA , STR1.DTRA , STR1.CDENR5 , STR1.NUSEQ9 , STR1.FILLER_2 , STR1.NUMCR1 , STR1.FILLER_3 , STR1.DEEFM1 , STR1.DADAC , STR1.CDTRT5 , STR1.NUCOT , STR1.CDPAS , STR1.IDVERP , STR1.IDPOL1 , STR1.CCONV1 , STR1.DASIG1 , STR1.DEGAA , STR1.DFCOM2 , STR1.NUMCR1_NPU , STR1.IDEXEF , STR1.CDBUR , STR1.NORIB4 , STR1.CSTGAR , STR1.DADAC_2 , STR1.CDMIN , STR1.CDTXA , STR1.CFVER2 , STR1.DFVAL6 , STR1.DTPPR , STR1.MTPRE2 , STR1.CDTARI , STR1.CDTRC , STR1.CDIND , STR1.NBAGEA , STR1.CDOPG1 , STR1.CDOPG2 , STR1.CDOPG3 , STR1.CDSPR , STR1.MKCAP1 , STR1.MTIMPG , STR1.CDCLB , STR1.CDRIM , STR1.FILLER_4 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , Case WHEN CIR1.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ACCL_CTR_ECD_MENS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.NUCOT =CAST(CAST(CAST(CIR1.NU_CPTE AS format 'Z(I)') AS format '9(11)') AS CHAR(11)) AND CAST ((SUBSTR (ADD_MONTHS(CAST(STR1.DT_ELIG AS DATE FORMAT 'YYYY-MM-DD'), -1),1,7) || '-01') AS DATE FORMAT 'YYYY-MM-DD') =CIR1.DD_PE) LEFT JOIN %SOC%.ACCL_FAM_PROD CIR3 ON (CIR1.CD_PROD_CIAL = CIR3.CD_PROD_CIAL AND CD_FAM_PROD ='RGP10045') LEFT JOIN %SOC%.PROD_ASSU_PREDICA CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(STR1.CDPAS || STR1.IDVERP AS CHAR(6))=CIR2.ID_PROD_PREDICA AND CAST(CIR2.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
IARFKA13                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.NCPTPA , STR1.KA10_IDCTRT , STR1.KA13_CDTYHA , STR1.KA13_CDTYRE , STR1.KA13_NBPIRE , STR1.KA13_CDQUAL , STR1.KA13_CBGDEL , STR1.KA13_CDNVOL , STR1.KA13_NBENFS , STR1.KA13_LNPAT4A , STR1.KA13_LPENFSA , STR1.KA13_DNAISSA , STR1.KA13_LNPAT4B , STR1.KA13_LPENFSB , STR1.KA13_DNAISSB , STR1.KA13_LNPAT4C , STR1.KA13_LPENFSC , STR1.KA13_DNAISSC , STR1.KA13_LNPAT4D , STR1.KA13_LPENFSD , STR1.KA13_DNAISSD , STR1.KA13_LNPAT4E , STR1.KA13_LPENFSE , STR1.KA13_DNAISSE , STR1.KA13_CPOST1 , STR1.KA13_CDTOP , STR1.KA13_CDOPG6 , STR1.KA13_DAATT , STR1.KA13_DARES , STR1.KA13_CDICEF , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CTR_IARD , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.KA10_IDCTRT = TCO1.ID_SOURCE1)
CEMAFCDO                                          SELECT STR1.CD_EDS_BNQ , STR1.IDPRS , STR1.CDCDO , trim(leading '0' from STR1.IDCANA) IDCANA , STR1.CDACDI , trim(leading '0' from STR1.CDPRC1) CDPRC1 , STR1.CDO1P1 , STR1.CDC1P1 , STR1.CDO2P1 , STR1.CDC2P1 , STR1.CDO3P1 , STR1.CDC3P1 , trim(leading '0' from STR1.CDPRC2) CDPRC2 , STR1.CDO1P2 , STR1.CDC1P2 , STR1.CDO2P2 , STR1.CDC2P2 , STR1.CDO3P2 , STR1.CDC3P2 , trim(leading '0' from STR1.CDPRC3) CDPRC3 , STR1.CDO1P3 , STR1.CDC1P3 , STR1.CDO2P3 , STR1.CDC2P3 , STR1.CDO3P3 , STR1.CDC3P3 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
COCLICO_NUMER                                     SELECT STR1.CD_EDS_BNQ , STR1.CODENR , STR1.DATPRO , STR1.NATURE , STR1.IDENTI , STR1.IDTEC , STR1.DATAPL , STR1.CODANU , STR1.CODENR_2 , STR1.IDECAM , STR1.IDSUJE , STR1.VALIND , STR1.INFCOM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CLI_CIAL , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , TCO2.ID_DWR ID_DWR_CTR , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , TCO3.ID_DWR ID_DWR_EDC , Case When TCO3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO3 , TCO4.ID_DWR ID_DWR_PART , Case When TCO4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO4 , CIR1.TYPSUJ , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.COCLICO_NUMER STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDSUJE= TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.IDSUJE= TCO2.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO TCO3 ON (STR1.CD_EDS_BNQ = TCO3.CD_EDS_BNQ AND STR1.IDSUJE= CAST(TCO3.ID_SOURCE1 AS VARCHAR(30)) AND SUBSTR(TCO3.ID_SOURCE1,31,3)='ECD') LEFT JOIN %TCO%.ID_PART_TCO TCO4 ON (STR1.CD_EDS_BNQ = TCO4.CD_EDS_BNQ AND STR1.IDSUJE= TCO4.ID_SOURCE1) LEFT JOIN %DE1%.CRM_CARAC CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDTEC=CIR1.IDTEC AND CIR1.TK_ACTION IN ('I','U'))
DGXG78                                            SELECT distinct STR1.CD_EDS_BNQ , STR1.IDCRE , STR1.DTCNT , STR1.QTINT , STR1.IDTCN , STR1.IDWO , STR1.IDPN , STR1.IDCLC , STR1.CPCRE , STR1.LNCRE , STR1.IDCB , STR1.CPCEX , STR1.QTRES , STR1.DICRE , STR1.IDPART , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.ID_DWR_PART ID_DWR_PART_EMACO , CIR1.ID_PART ID_PART_EMACO , PCC1.ID_DWR_CLI_CIAL ID_DWR_CLI_CIAL_EMACO , TCO1.ID_SOURCE1 ID_CLI_CIAL_EMACO , CIR2.ID_DWR ID_DWR_PART , PCC2.ID_DWR_CLI_CIAL ID_DWR_CLI_CIAL_PART , TCO2.ID_SOURCE1 ID_CLI_CIAL_PART , CIR4.ID_DWR_PST_FNCT , CIR5.IDCTAC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When PCC1.CD_BQE is null then 0 else 1 End Row_Found_PCC1 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When PCC2.CD_BQE is null then 0 else 1 End Row_Found_PCC2 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 FROM %DTA%.DGXG78 STR1 LEFT JOIN %SOC%.PART AS CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDPN = CIR1.ID_PART_EMACO AND CAST(CIR1.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT OUTER JOIN (SELECT PCC.CD_BQE, PCC.ID_DWR_PART, PCC.ID_DWR_CLI_CIAL FROM %SOC%.PART_CLI_CIAL AS PCC WHERE EXISTS (SELECT 1 FROM %SOC%.NATU_LIEN AS NAL WHERE NAL.CD_BQE = PCC.CD_BQE AND NAL.CD_NATU_LIEN = PCC.CD_NATU_LIEN AND NAL.CD_REGRP_NATU_LIEN = 'DGCZ18XXCTPCC') AND PCC.DF_VALID = '9999-12-31' AND PCC.DF_HISTO='9999-12-31 00:00:00' ) AS PCC1 ON (PCC1.CD_BQE = CIR1.CD_BQE AND PCC1.ID_DWR_PART = CIR1.ID_DWR_PART) LEFT JOIN %TCO%.ID_CLI_CIAL_TCO AS TCO1 ON (PCC1.CD_BQE = TCO1.CD_EDS_BNQ AND PCC1.ID_DWR_CLI_CIAL = TCO1.ID_DWR) LEFT JOIN (SELECT CD_EDS_BNQ, ID_SOURCE1, ID_DWR FROM %TCO%.ID_PART_TCO AS TCO1 WHERE EXISTS (SELECT 1 FROM %SOC%.PART AS P WHERE P.CD_BQE = TCO1.CD_EDS_BNQ AND P.ID_DWR_PART = TCO1.ID_DWR) ) AS CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPART = CIR2.ID_SOURCE1) LEFT OUTER JOIN (SELECT PCC.CD_BQE, PCC.ID_DWR_PART, PCC.ID_DWR_CLI_CIAL FROM %SOC%.PART_CLI_CIAL AS PCC WHERE EXISTS (SELECT 1 FROM %SOC%.NATU_LIEN AS NAL WHERE NAL.CD_BQE = PCC.CD_BQE AND NAL.CD_NATU_LIEN = PCC.CD_NATU_LIEN AND NAL.CD_REGRP_NATU_LIEN = 'DGCZ18XXCTPCC') AND PCC.DF_VALID = '9999-12-31' AND PCC.DF_HISTO='9999-12-31 00:00:00' ) AS PCC2 ON (PCC2.CD_BQE = CIR2.CD_EDS_BNQ AND PCC2.ID_DWR_PART = CIR2.ID_DWR) LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO2 ON (PCC2.CD_BQE = TCO2.CD_EDS_BNQ AND PCC2.ID_DWR_CLI_CIAL = TCO2.ID_DWR) LEFT JOIN %SOC%.PST_FNCT AS CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_BQE AND STR1.IDWO = CIR4.CD_PST_FNCT AND (CIR4.DF_HISTO = '9999-12-31 00:00:00')) LEFT JOIN %DE1%.CORREA AS CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_EDS_BNQ AND STR1.IDCRE = CIR5.IDCRE) LEFT JOIN (SELECT DISTINCT CD_BQE, ID_TECHN_CNTCT FROM %SOC%.TECHN_CNTCT) AS CIR6 ON (STR1.CD_EDS_BNQ = CIR6.CD_BQE AND STR1.IDTCN = CIR6.ID_TECHN_CNTCT)
MS_AGT_TDB_MENS                                   SELECT CD_EDS_BNQ, ID_AGT_AD, ID_AGT, CD_PRFL, CD_PST_FNCT_CNX, ID_EXT_EDS_CNX, TK_ACTION, TK_FLAG FROM %DTA%.%ObjectNameFrom% STR1
DGCZ17                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDELST IDELST_BYTE , CAST(Coalesce(CIR2.ID_SOURCE1,'') AS VARCHAR(30)) AS IDELST , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CLI_COMCIAL , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDS , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ and STR1.IDCLC =CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDS_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ and STR1.IDELST=CIR2.BY_SOURCE1)
GRA606                                            SELECT STR1.CD_EDS_BNQ , STR1.GRA606_IDLIMI , STR1.GRA606_IDELCO , STR1.CTLIMI , STR1.CDLIMI , STR1.CDASL1 , STR1.CSLIMI , STR1.MTDEDE , STR1.DADEDE , STR1.QTJODE , STR1.DDUTDE , STR1.MKSOLI , STR1.CDCODE , STR1.CDPRFA , STR1.CTRELI , STR1.DADELI , STR1.DAPELI , STR1.CDPILI , STR1.CDDEPR , STR1.ZTEVER , STR1.DARELI , STR1.DADXLI , STR1.CDMIND , STR1.CPDCBI , STR1.CDCUNI , STR1.CPOCCC , STR1.MTINLI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_BQE,ID_EDC_CRED,ID_DWR_EDC FROM %SOC%.ECD_DETENU ) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.GRA606_IDELCO=CIR1.ID_EDC_CRED) WHERE 1=1 and (STR1.CTLIMI = 8 OR STR1.CTLIMI = 10 OR STR1.CTLIMI = 4) AND STR1.CDLIMI < 100
BRUMIPEP                                          SELECT STR1.CD_EDS_BNQ , STR1.CDART4 , STR1.NUSEQ1 , STR1.CDOPE , STR1.CDBCF1 , STR1.CDBCF2 , STR1.ZB005 , STR1.CDOPE2 , STR1.DOOPFG , STR1.NUORD2 , STR1.NUREG1 , STR1.CDZDF , STR1.CDZIF , STR1.CDANUF , STR1.IDEXEF , STR1.CDBUR1 , STR1.NCPTEI , STR1.CDVSC , STR1.LIBVA2 , STR1.MTNOMA , STR1.CFORVA , STR1.QTTIT1 , STR1.DADCDD , STR1.MVDCO2 , STR1.ZB024 , STR1.DDECH3 , STR1.ZB001 , STR1.ZB003 , STR1.CDNAN1 , STR1.DTEMI2 , STR1.DATCE , STR1.DFOPER , STR1.MTACQ4 , STR1.ZB032 , STR1.ZB040 , STR1.NUCRT1 , STR1.CDFIT3 , STR1.CDETLI , STR1.CBIND5 , STR1.CCATVA , STR1.CDFOPC , STR1.CDTAUB , STR1.CBIND6 , STR1.CBIND7 , STR1.ZB045 , STR1.FILLER_2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTEI=CIR1.NU_CPTE)
TDSCK142                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.CDOPE , STR1.CDCOP , STR1.CQCHQ , STR1.NCHQ , STR1.IDCED , STR1.NUARC0 , STR1.DTARC , STR1.CDGBD2 , STR1.CDBCF2 , STR1.CDANU , STR1.CDRFO1 , STR1.NOAMOP , STR1.DTTRT , STR1.CDCIR3 , STR1.FILLER176 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
BACTASOF                                          SELECT STR1.CD_EDS_BNQ, STR1.NCPTEA, STR1.IDEXEB, STR1.IDELC2, STR1.DECHE2, STR1.MECHC2, STR1.MKAEC3, STR1.MTECI5, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION, CIR1.ID_DWR_EDC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED_SOFINCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELC2=CIR1.CD_CTR_SOFINCO AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
TYP_CT_CREANC_EXPOSE_CST                          SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
OFR                                               SELECT STR1.CD_EDS_BNQ , STR1.ID_OFR_BQR , STR1.APPLTN_CIALE_OFR , STR1.LI_OFR , STR1.DESC_OFR , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
REF_FAMILLE_OFFRE                                 SELECT STR1.CD_EDS_BNQ , STR1.FAMILLE_OFFRE_ID , STR1.FAMILLE_OFFRE_LIBELLE , STR1.ENTITE_ID , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRC815                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDELCO , STR1.NOOPPR , STR1.NOPRPR , STR1.CPOBJL , STR1.DDLIEN , STR1.DFLIEN , STR1.ZTEVER , STR1.IDACTL , STR1.IDCCA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELCO = CIR1.ID_EDC_CRED AND CIR1.TYP_SOURCE_CRED='G' AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN ( SELECT S1.CD_BQE ,S1.ID_CTR_CADRE,S1.DD_HISTO ,S1.DF_HISTO FROM (SELECT DISTINCT CD_BQE ,ID_CTR_CADRE ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.CTR_CADRE UNION SELECT DISTINCT CD_BQE ,ID_CTR_CADRE ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.CTR_CADRE) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_CTR_CADRE ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 )CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDCCA = CIR2.ID_CTR_CADRE AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CPOBJL = CIR3.CD_STATU_CRED_COMPLEXE AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
TYP_STATU_SCNRIO_CST                              SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_NATU_CRED_CST                                 SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
A018DH06                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO , STR1.NUEVPR , STR1.CDMRBT , STR1.CTRBTA , STR1.MTRBT4 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.ID_DWR_EDC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT CD_BQE, ID_EDC_CRED,NU_EVT_PRET,ID_DWR_EDC, Min(DD_HISTO) DD_HISTO, max(DF_HISTO) DF_HISTO FROM %SOC%.EVT_PRET group by CD_BQE, ID_EDC_CRED,NU_EVT_PRET,ID_DWR_EDC) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELCO=CIR1.ID_EDC_CRED AND STR1.NUEVPR=CIR1.NU_EVT_PRET AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG <= CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_MTF_RBRT_AN CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CDMRBT=CIR2.CD_MTF_RBRT_AN) LEFT JOIN %SOC%.TYP_TYP_MTF_RBRT_AN CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CTRBTA=CIR3.CT_MTF_RBRT_AN)
TITXSD04                                          SELECT STR1.CD_EDS_BNQ , STR1.FILLER_2 , STR1.CDZDF , STR1.CDZIF , STR1.CDANU , STR1.IDEXEF , STR1.NCPTEI , STR1.IDPRS , STR1.NUSRC , STR1.CTTYPO , STR1.NUSQII , STR1.CDISIN , STR1.CSECHE , STR1.CFPERV , STR1.CADEVI , STR1.NBDEC1 , STR1.MTINVB , STR1.CSENS , STR1.FILLERA , STR1.NBDEC2 , STR1.QTITRK , STR1.DOPRLV , STR1.DDECHB , STR1.DHJJ1 , STR1.NOSEMI , STR1.NUJOUS , STR1.DDSUSO , STR1.NBECH3 , STR1.DFSUSO , STR1.DHFECH , STR1.DARES , STR1.CDBLV , STR1.CDSUCW , STR1.IDUSEK , STR1.DTSTA1 , STR1.CDSUCM , STR1.IDUSEJ , STR1.DTSTA2 , STR1.CDSUCS , STR1.IDUSEN , STR1.DTSTA3 , STR1.FILLERB , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(CIR1.ID_EDC_VEGA,0) ID_EDC_VEGA FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %SOC%.ACCL_CTR_ECD CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTEI=CIR1.NU_CPTE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
COCL_AF_SEGM                                      SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CD_ENT_CAM_AFFECT_A_SEGM , STR1.ID_TECHN_SGMTN ,CAST(CAST(STR1.ID_TECHN_SGMTN AS BIGINT) AS VARCHAR(10)) AS ID_TECHN_SGMTN_CHAR ,STR1.ID_SUJET_AFFECT_A_SEGM , STR1.DT_APPLI_AFFECT_A_SEGM , STR1.SOURCE_AFFECT_A_SEGM , STR1.CD_TYP_SUJET_SGMTN , STR1.DT_DEB_LIEN_AFFECT_A_SEGM , STR1.DT_FIN_LIEN_AFFECT_A_SEGM , STR1.CD_SEGM_AFFECT_A_SEGM , STR1.DT_PROD_AFFECT_A_SEGM , STR1.INFO_COMPL_AFFECT_A_SEGM , STR1.DT_MAJ_AFFECT_A_SEGM , STR1.DT_IN_AFFECT_A_SEGM , STR1.ID_AGT_MAJ_AFFECT_A_SEGM , STR1.HR_MAJ_AFFECT_A_SEGM , STR1.ID_SRUCT_MAJ_AFFECT_A_SEGM , STR1.CD_CNL_DSTRB_MAJ_AFFECT_A_SEGM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.ID_DWR_PART Is Null Then 0 Else CIR2.ID_DWR_PART End ID_DWR_PART , CASE WHEN CIR4.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR8.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR8 , CASE WHEN CIR5.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR5 , CASE WHEN CIR6.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR6 , CASE WHEN CIR7.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR7 ,COALESCE (CAST(CIR8.ID_SGMTN_REFC AS DECIMAL(10,0)),0) AS ID_SGMTN_REFC ,COALESCE(CIR4.ID_NOMCLTR_SGMTN,0) AS ID_NOMCLTR_SGMTN FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (select distinct CD_BQE, ID_TK_INTRL from %SOC%.INTRL_CONSO) CIR1 on (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND SUBSTR(STR1.ID_SUJET_AFFECT_A_SEGM,1,10)=CIR1.ID_TK_INTRL) LEFT JOIN %SOC%.PART CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND SUBSTR(TRIM(STR1.ID_SUJET_AFFECT_A_SEGM),1,14)=CIR2.ID_PART AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) ) LEFT JOIN %DE1%.COCL_SGMTN CIR4 ON (STR1.ID_TECHN_SGMTN=CIR4.ID_TECHN_SGMTN AND CIR4.CD_EDS_BNQ=99900) LEFT JOIN %SOC%.SEGM_REFC CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_BQE AND STR1.CD_SEGM_AFFECT_A_SEGM=CIR8.ID_SEGM_REFC ) LEFT JOIN %SOC%.SEGM_REFC CIR5 ON (CIR4.ID_NOMCLTR_SGMTN=CIR5.ID_SGMTN_REFC) LEFT JOIN %SOC%.SGMTN_REFC CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_BQE AND STR1.ID_TECHN_SGMTN=CIR6.ID_SGMTN_REFC) LEFT JOIN %SOC%.SGMTN_REFC CIR7 ON (CIR4.ID_NOMCLTR_SGMTN=CIR7.ID_SGMTN_REFC AND STR1.CD_EDS_BNQ=CIR7.CD_BQE)
T1R53C                                            SELECT STR1.CD_EDS_BNQ , STR1.CDACTE , STR1.IDPART , STR1.CDACPR , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_ETS , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_ETS_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1) LEFT JOIN %SOC%.ETS CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDPART=CIR2.ID_ETS) LEFT JOIN %SOC%.PART CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDPART=CIR3.ID_PART) LEFT JOIN %SOC%.TYP_ACTI_ECON CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CDACTE=CIR4.CD_ACTI_ECON)
DGXH15                                            SELECT STR1.CD_EDS_BNQ , STR1.IDRES , STR1.IDTYR , STR1.IDCLC , STR1.IDPN , STR1.DIRES , STR1.IDCRE , STR1.IDPRS , STR1.IDRF , STR1.DTRES , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR_PART,0) ID_DWR_PART , CAST(COALESCE(CIR3.ID_SOURCE1, ' ') AS CHAR(15)) ID_PART , PCC1.ID_DWR_CLI_CIAL ID_DWR_CLI_CIAL , TCO1.ID_SOURCE1 ID_CLI_CIAL , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When PCC1.CD_BQE is null then 0 else 1 End Row_Found_PCC1 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.DGXH15 STR1 LEFT JOIN %SOC%.PART_PART_EMACO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.IDPN = CIR2.ID_PART_EMACO AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN (SELECT CD_EDS_BNQ, ID_SOURCE1, ID_DWR FROM %TCO%.ID_PART_TCO AS TCO1 WHERE EXISTS (SELECT 1 FROM %SOC%.PART AS P WHERE P.CD_BQE = TCO1.CD_EDS_BNQ AND P.ID_DWR_PART = TCO1.ID_DWR) ) AS CIR3 ON (CIR2.CD_BQE = CIR3.CD_EDS_BNQ AND CIR2.ID_DWR_PART = CIR3.ID_DWR) LEFT OUTER JOIN (SELECT PCC.CD_BQE, PCC.ID_DWR_PART, PCC.ID_DWR_CLI_CIAL FROM %SOC%.PART_CLI_CIAL AS PCC WHERE EXISTS (SELECT 1 FROM %SOC%.NATU_LIEN AS NAL WHERE NAL.CD_BQE = PCC.CD_BQE AND NAL.CD_NATU_LIEN = PCC.CD_NATU_LIEN AND NAL.CD_REGRP_NATU_LIEN = 'DGCZ18XXCTPCC') AND PCC.DF_VALID = '9999-12-31' AND PCC.DF_HISTO='9999-12-31 00:00:00' ) AS PCC1 ON PCC1.CD_BQE = CIR2.CD_BQE AND PCC1.ID_DWR_PART = CIR2.ID_DWR_PART LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (PCC1.CD_BQE = TCO1.CD_EDS_BNQ AND PCC1.ID_DWR_CLI_CIAL = TCO1.ID_DWR)
TYP_PART_CST                                      SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
CATCHA                                            SELECT STR1.CD_EDS_BNQ , STR1.CTCHAR , STR1.LCCHAR , STR1.LICHAR , STR1.LIM200 , STR1.CDRGT6 , STR1.CTGES1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TDSCK145                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.CDOPE , STR1.CDCOP , STR1.NUEMN , STR1.LNEMET , STR1.IDCED , STR1.DOOPFH , STR1.LIBEL , STR1.LIBE2 , STR1.DOOPFK , STR1.CDANU , STR1.LICOM , STR1.LIB24 , STR1.CDOPEA , STR1.CDOAFB , STR1.NUECR , STR1.CDOPES , STR1.DTTRT , STR1.IDCTGT , STR1.IDEXP2 , STR1.FILLER63 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
POSTFC                                            SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IPOSTF , STR1.LPOSTF , STR1.LND2WO , STR1.QCCPI , STR1.QCCPJ , STR1.QPPRP , STR1.QPSYP , STR1.QPCRP , STR1.IDWO , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR , Case WHEN TCO1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PST_FNCT_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IPOSTF=TCO1.ID_SOURCE1)
ELCOPRET                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.NCPTE , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDELCO=CIR1.BY_SOURCE1 AND SUBSTR(CIR1.ID_SOURCE1,31,3) = 'ECD')
TYMOCO                                            SELECT STR1.CD_EDS_BNQ , STR1.CDMCO , STR1.LIMOC , STR1.CTMEN , STR1.CTCOD , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
IARFKA11                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.NCPTPA , STR1.KA10_IDCTRT , STR1.KA11_CDGROU , STR1. KA11_DACIRC , STR1.KA11_CDNPDC , STR1.KA11_CPOST4 , STR1.KA11_DAATT , STR1.KA11_DARES , STR1.KA11_CPETA , STR1.KA11_CDTOP , STR1. KA11_CDTOP0 , STR1.KA11_CDTOPD , STR1.KA11_CDTOPQ , STR1.KA11_CDOPG5 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_CTR_IARD , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.KA10_IDCTRT=TCO1.ID_SOURCE1)
TYP_PORTEF_CST                                    SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ELECON                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.DDFONC , STR1.DFFONC , STR1.CDSUSS , STR1.IDCDPR , STR1.IDCDPK , STR1.CDDEMA , STR1.IDELEX , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.IDTYOF,' ') AS IDTYOF , IDELC2 , IPART1 , IDCTR1 , COALESCE(CIR4.IDASPR,' ') AS IDASPR , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_EDC , CAST(CAST(Case When STR1.IDCDPR = 11 and STR1.IDCDPK > 0 Then STR1.IDCDPK Else STR1.IDCDPR end as format '99999') as CHAR(5)) IDCDPR_IDCDPK , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR6 FROM %DTA%.ELECON STR1 LEFT JOIN %DE1%.T2R05P CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDELCO=CIR1.IDELCO AND CIR1.TK_ACTION in ('I','U') AND CAST(CIR1.DELIEN AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DFLIEN AS DATE) ) LEFT JOIN %SOC%.PROD_CIAL CIR2 ON (99900=CIR2.CD_BQE and "IDCDPR_IDCDPK" = CAST(CIR2.CD_PROD_CIAL AS CHAR(5)) AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %DE1%.E2R19G CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.IDELCO=CIR3.IDELCO AND CIR3.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.ECTASP CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ and STR1.IDELCO=CIR4.IDELCO AND CIR4.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR (TCO1.ID_SOURCE1,31,3)='ECD') LEFT JOIN %DE1%.OPENEL CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ and STR1.IDELCO=CIR5.IDELCO AND CIR5.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.PAKPPA CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_EDS_BNQ and STR1.IDELCO=CIR6.IDELCO AND CIR6.TK_ACTION in ('I','U'))
BACTAGRE                                          SELECT STR1.CD_EDS_BNQ, STR1.NCPTEA, STR1.IDEXEB, STR1.IDELC2, STR1.DECHE2, STR1.MECHC2, STR1.MKAEC3, STR1.MTECI5, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION ,CIR1.ID_DWR_EDC ,Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELC2=CIR1.ID_EDC_CRED AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
TYP_CNL_SIGNER_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('N' AS VARCHAR(1)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ELSTELST                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDELST , STR1.IDELST1 , STR1.DELIEN , STR1.DFLIEN , STR1.IDTYXK , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Coalesce(CIR1.ID_DWR,0) ID_DWR_EDS_F , Coalesce(CIR2.ID_DWR,0) ID_DWR_EDS_P , Coalesce(CIR4.ID_EXT_EDS,0) ID_EXT_EDS , Coalesce(CIR5.ID_EXT_EDS,0) ELT_ID_EXT_EDS , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR3 , Case WHEN CIR4.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR4 , Case WHEN CIR5.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDS_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDELST = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDS_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDELST1 = CIR2.ID_SOURCE1) LEFT JOIN %DE1%.EDSNTEDS CIR3 ON (99900=CIR3.CD_EDS_BNQ and STR1.IDTYXK=CIR3.IDTYXK AND CIR3.TK_ACTION IN('I','U')) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE and STR1.IDELST=CIR4.ID_EDS AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE and STR1.IDELST1=CIR5.ID_EDS AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE)) WHERE 1=1 and STR1.IDTYXK IN('01','02')
DTWHFS09                                          SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ IS NOT NULL THEN TCO1.ID_SOURCE1 ELSE %PMU%.Bin2Char(STR1.IDELCO) END AS VARCHAR(30)) AS IDELCO , STR1.IDELCW , STR1.IDCDPN , STR1.DCARR8 , STR1.CPSTC2 , STR1.MFFCAC , STR1.MBRUTF , STR1.MSTNDF , STR1.MTFA01 , STR1.CADEVI , STR1.NOSIR5 , STR1.NUSRT , STR1.LIB64A , STR1.CPREST , STR1.CAETFI , STR1.MSCNTK , STR1.MTFNT1 , STR1.MTFNV1 , STR1.MTARA1 , STR1.MTARA3 , STR1.MTARA5 , STR1.MTARA7 , STR1.MTARA9 , STR1.MTROP7 , STR1.MTCCR8 , STR1.CADEVO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_EDC , Case When CIR1.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD') LEFT JOIN %SOC%.DEVIS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CIR1.CD_DEVIS_ISO = STR1.CADEVI AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.DEVIS CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CIR2.CD_DEVIS_ISO = STR1.CADEVO AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
IARFKA1V                                          SELECT STR1.CD_EDS_BNQ ,STR1.KA10_IDCTRT ,STR1.IDCLC ,STR1.IDPACO ,STR1.CDDOMI ,STR1.CDPROD ,STR1.NCPTPA ,STR1.KA1V_NBASS1 ,STR1.KA1V_NOASSU ,STR1.KA1V_LNPRUB ,STR1.KA1V_LNPATR ,STR1.KA1V_CCPAR ,STR1.KA1V_DNAISS ,STR1.KA1V_CDTOPB ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION , TCO1.ID_DWR AS ID_DWR_CTR_IARD , CASE WHEN TCO1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ and STR1.KA10_IDCTRT=TCO1.ID_SOURCE1)
UNVRS_DE_BSN                                      SELECT STR1.CD_EDS_BNQ , STR1.CD_UNVRS , STR1.LI_UNVRS , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
DOSVNT                                            SELECT STR1.CD_EDS_BNQ , STR1.IDDOSSVNT , STR1.IDSTRUCT , STR1.PSTFNCT , STR1.IDAGT , STR1.CDOFR , STR1.CDSCN , STR1.CDSCNL , STR1.IDTCOM , STR1.IDTSIGN , STR1.TOPPRINT , STR1.IDSTATU , STR1.IDCLI , STR1.IDDMNDSIG , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE is NULL THEN 0 ELSE 1 END Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR5 , CASE WHEN CIR6.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR6 , CASE WHEN CIR7.CD_BQE is NULL THEN 0 ELSE 1 END Row_Found_CIR7 , CASE WHEN CIR8.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR8 , CASE WHEN CIR9.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR9 , CIR1.ID_DWR as ID_DWR_AGT , CIR2.CT_SIGNER , CIR3.CD_TECHN_COM_VNT , CIR4.CD_SCNRIO_VNT , CIR5.ID_OFR_BQR , CIR6.ID_DWR as ID_DWR_PART , CIR7.ID_DWR_PST_FNCT , CIR8.CD_SCNRIO_VNT AS CD_SCNRIO_VNT_LIE , CIR9.CD_STATU_SCNRIO FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_AGT_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDAGT = CIR1.ID_SOURCE1) LEFT OUTER JOIN %SOC%.TYP_CT_SIGNER CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDTSIGN =CIR2.CT_SIGNER) LEFT OUTER JOIN %SOC%.TYP_TECHN_COM_VNT CIR3 ON(STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDTCOM =CIR3.CD_TECHN_COM_VNT) LEFT OUTER JOIN %SOC%.TYP_SCNRIO_VNT CIR4 ON(STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CDSCN =CIR4.CD_SCNRIO_VNT) LEFT OUTER JOIN %SOC%.OFR CIR5 ON(CIR5.CD_BQE='99900' AND STR1.CDOFR =CIR5.ID_OFR_BQR) LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR6 ON (STR1.CD_EDS_BNQ = CIR6.CD_EDS_BNQ AND STR1.IDCLI = CIR6.ID_SOURCE1) LEFT OUTER JOIN %SOC%.PST_FNCT CIR7 ON(STR1.CD_EDS_BNQ=CIR7.CD_BQE AND STR1.PSTFNCT =CIR7.CD_PST_FNCT) LEFT OUTER JOIN %SOC%.TYP_SCNRIO_VNT CIR8 ON(STR1.CD_EDS_BNQ=CIR8.CD_BQE AND STR1.CDSCNL =CIR8.CD_SCNRIO_VNT) LEFT OUTER JOIN %SOC%.TYP_STATU_SCNRIO CIR9 ON(STR1.CD_EDS_BNQ=CIR9.CD_BQE AND STR1.IDSTATU =CIR9.CD_STATU_SCNRIO)
INFPER                                            SELECT STR1.CD_EDS_BNQ , Trim(STR1.IDMDC) IDMDC , STR1.DDMDC , STR1.DFMDC , STR1.NBBREA , STR1.NBBREB , STR1.NBBREC , STR1.NBBRED , STR1.NBBREE , STR1.MTSTDA , STR1.MTSTDB , STR1.MTSTDC , STR1.MTSTDD , STR1.MTSTDE , STR1.DASTDM , STR1.DASTDN , STR1.DASTDO , STR1.DASTDP , STR1.DASTDV , STR1.IDCTRH IDCTRH_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRH) end AS VARCHAR(30)) AS IDCTRH , STR1.IDCTRG IDCTRG_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRG) end AS VARCHAR(30)) AS IDCTRG , STR1.IDPARH , STR1.IDPAR2 , STR1.LIBEL , STR1.LIBE1 , STR1.LIBE2 , STR1.LIB32 , STR1.LIB32A , STR1.LIBEL3 , STR1.LIB20 , STR1.LIB20A , STR1.LIBEL1 , STR1.LIB10 , STR1.LIB10A , STR1.LIB10B , STR1.NUTEPC , STR1.CBIN24 , STR1.LIB11 , STR1.LIEML , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CTR , COALESCE(CIR2.ID_DWR,0) ID_DWR_CTR_FNCT , COALESCE(CIR3.ID_DWR,0) ID_DWR_PART , COALESCE(CIR4.ID_DWR,0) ID_DWR_PART_FNCT , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDCTRH= CIR1.BY_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDCTRG= CIR2.BY_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.IDPARH=CIR3.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ and STR1.IDPAR2=CIR4.ID_SOURCE1) LEFT JOIN %SOC%.MTF_CNTCT CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_BQE AND Trim(STR1.IDMDC) = CIR5.ID_MTF_CNTCT AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE))
TYP_SECTR_INVSTMNT_CST                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRA702                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.NOOPPR , STR1.NOPRPR , STR1.NOCLIN , STR1.NUMATR , STR1.DADOCR , STR1.CDTAUX , STR1.TXMAJO , STR1.CDCLP3 , STR1.DAIELC , STR1.DEACTE , STR1.MTPACR , STR1.MTFGPR , STR1.PDURPR , STR1.CFPEPR , STR1.CDOMIN , STR1.CDAEFI , STR1.CCATPR , STR1.CDBIPR , STR1.CDESFI , STR1.CCATFI , STR1.CDCOMP , STR1.CDTECR , STR1.CDLAPR , STR1.CDSOPR , STR1.CDDEPR , STR1.CDLINV , STR1.DHDNPR , STR1.QTPACS , STR1.DBOFPR , STR1.DASIOF , STR1.DTREAL , STR1.DA1ECH , STR1.CDSEFI , STR1.ZTECH1 , STR1.CSTAVI , CASE WHEN STR1.GRA702_IDELCO = '00000000000' THEN COALESCE(CIR8.ID_EDC_CRED, STR1.GRA702_IDELCO) ELSE STR1.GRA702_IDELCO End GRA702_IDELCO , STR1.CDLCPR , STR1.DEDDAP , STR1.CDAMOR , STR1.CDPEXT , STR1.DAGATA , STR1.GRA702_IDLIMI , STR1.CQTXPR , STR1.CPAMFI , STR1.CDSSCR , STR1.IDPRJT , STR1.DAROFP , STR1.CDSSMA , STR1.CDSINS , STR1.CT1DPR , STR1.CT2DPR , STR1.PD1DPR , STR1.PD2DPR , STR1.CDELPR , STR1.NUBARE , STR1.CDANPR , STR1.PDANPR , STR1.CDIFCG , STR1.CDSPAR , STR1.CTINDX , STR1.DADREA , STR1.CCJURI , STR1.CQPJPR , STR1.DAARPR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(CIR2.IDELCO) end AS VARCHAR(30)) AS IDELCO , CIR2.CDDOM3 AS CDDOM3 , TCO1.ID_DWR ID_DWR_EDC , CASE WHEN TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , CASE WHEN CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 ,CIR4.SUM_MKUTPR ,CIR4.SUM_MKDURE ,CIR4.MIN_DA1REA ,A836.MFDOA4 AS MFDOA4 ,A836.MFDOI4 AS MFDOI4 ,CAST(CAST(CAST(STR1.NUMATR AS format 'Z(I)') AS format '9(5)') AS CHAR(7) ) AS ID_AGT ,COALESCE(CIR5.ID_DWR_AGT,-1) AS ID_DWR_AGT ,cast (Case when CIR6.IDPRJT is null THEN 0 Else Case when CIR6.CDSLHA is null OR trim(CIR6.CDSLHA) ='' THEN 0 Else Case when CIR7.CD_SOLTN_HAB is not null THEN CIR6.CDSLHA Else 0 END END END as BYTEINT) CD_SOLTN_HAB , CAST(Case when STR1.CDLINV is null or STR1.CDLINV ='' then '-1' when SUBSTR(STR1.CDLINV,1,2)='97' or SUBSTR(STR1.CDLINV,1,2)='98' then SUBSTR(STR1.CDLINV,1,3) else SUBSTR(STR1.CDLINV,1,2) END as char(3)) CD_DEPT_INVSTMNT FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.GRA702_IDELCO=CIR1.ID_EDC_CRED AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) AND CIR1.ID_EDC_CRED IS NOT NULL AND CIR1.CD_STATU_PRET>0) LEFT JOIN %SOC%.CRED CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_BQE AND STR1.IDPART=CIR8.ID_PART_GREEN AND STR1.NOOPPR=CIR8.NU_OPERATION_NATIONAL AND STR1.NOPRPR=CIR8.NU_PRET AND CAST(CIR8.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR8.DF_HISTO AS DATE) AND CIR8.ID_EDC_CRED IS NOT NULL AND CIR8.CD_STATU_PRET=0) INNER JOIN %DE1%.E2R19G CIR2 ON (CIR2.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR2.IDELC2=COALESCE(CIR1.ID_EDC_CRED, CIR8.ID_EDC_CRED, STR1.GRA702_IDELCO) AND CIR2.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (CIR2.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND CIR2.IDELCO= TCO1.BY_SOURCE1 AND substr(TCO1.ID_SOURCE1, character(TCO1.ID_SOURCE1)-2)='ECD') LEFT JOIN %DE1%.GRA470 CIR3 ON (CIR3.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR3.GRA470_IDELCO=COALESCE(CIR1.ID_EDC_CRED, CIR8.ID_EDC_CRED) AND CIR3.CTSPEC=1 AND CIR2.TK_ACTION in ('I','U')) LEFT JOIN (SELECT A702.CD_EDS_BNQ , A702.GRA702_IDELCO , SUM(A001.MKUTPR) AS SUM_MKUTPR , SUM(A001.MKDURE) AS SUM_MKDURE , MIN(A001.DA1REA) AS MIN_DA1REA FROM %DTA%.GRA702 A702 INNER JOIN %DE1%.GRA610 A610 ON (A610.GRA610_IDLIMI=A702.GRA702_IDLIMI AND A610.CD_EDS_BNQ =A702.CD_EDS_BNQ AND A610.TK_ACTION in ('I','U')) INNER JOIN %DE1%.GRA606 A606 ON (A610.GRA610_IDLIMI = A606.GRA606_IDLIMI AND A610.CD_EDS_BNQ =A606.CD_EDS_BNQ AND A606.CTLIMI = 8 AND A606.TK_ACTION in ('I','U')) INNER JOIN %DE1%.E2R19G R19G ON (R19G.IDELC2 = A606.GRA606_IDELCO AND R19G.CD_EDS_BNQ =A606.CD_EDS_BNQ AND R19G.CDDOM3 = 'LI' AND R19G.TK_ACTION in ('I','U')) INNER JOIN %DE1%.GRA001 A001 ON (A001.GRA001_IDELCO = A610.GRA610_IDELCO AND A001.CD_EDS_BNQ =A610.CD_EDS_BNQ AND A001.CDAPPR = 0 AND A001.TK_ACTION in ('I','U')) GROUP BY A702.CD_EDS_BNQ , A702.GRA702_IDELCO ) CIR4 ON(CIR4.GRA702_IDELCO=STR1.GRA702_IDELCO AND CIR4.CD_EDS_BNQ=STR1.CD_EDS_BNQ) LEFT JOIN %SOC%.AGT CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE AND CAST(CAST(CAST(STR1.NUMATR AS format 'Z(I)') AS format '9(5)') AS CHAR(7))=CIR5.ID_AGT AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE)) LEFT JOIN (SELECT * FROM %DE1%.GRA836 WHERE TK_ACTION in ('I','U') QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_EDS_BNQ, NOOPPR, NOPRPR ORDER BY DT_ELIG DESC) = 1 ) A836 ON (STR1.CD_EDS_BNQ = A836.CD_EDS_BNQ AND STR1.NOOPPR = A836.NOOPPR AND STR1.NOPRPR = A836.NOPRPR) LEFT JOIN %DE1%.GRC560 CIR6 ON(STR1.CD_EDS_BNQ =CIR6.CD_EDS_BNQ AND STR1.IDPRJT=CIR6.IDPRJT ) LEFT JOIN %SOC%.TYP_SOLTN_HAB CIR7 ON(CIR6.CD_EDS_BNQ =CIR7.CD_BQE AND CIR6.CDSLHA=CIR7.CD_SOLTN_HAB AND CAST(CIR7.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR7.DF_HISTO AS DATE)) WHERE 1=1 AND STR1.CSTAVI<>88 AND CIR1.CD_BQE is null
REPRES                                            SELECT STR1.CD_EDS_BNQ , STR1.IDREPR , STR1.IDPART , STR1.DEREP1 , STR1.IDFNRE , STR1.DTDECJ , STR1.DFDECJ , STR1.CBSIG , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR2.CTPART , COALESCE(CIR1.ID_DWR,0) ID_DWR , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1) LEFT OUTER JOIN %DE1%.PARTEN CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART=CIR2.IDPART AND CIR2.CTPART in ('PP','PM'))
CATLG_STAT                                        SELECT STR1.CD_EDS_BNQ , STR1.IDTECH , STR1.LIBCATEG , STR1.LIBCOURT , STR1.LIBLONG , STR1.DOMAPPLI , STR1.TYPSDA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %SOC%.TYP_DOMN_TELPHNIE CIR1 ON ( STR1.DOMAPPLI=CIR1.CD_DOMN_TELPHNIE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.TYP_SDA CIR2 ON( STR1.TYPSDA=CIR2.CT_SDA AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
PREUVE_CLIENT                                     SELECT distinct STR1.CD_EDS_BNQ , STR1.PREUVE_CLIENT_ID , STR1.PREUVE_CLIENT_NUM_BON , STR1.CLIENT_COMMERCIAL_ID , STR1.STATUT_ID , STR1.PREUVE_ID , STR1.PREUVE_CLIENT_DT_DEBUT , STR1.PREUVE_CLIENT_DT_FIN , STR1.PREUVE_CLIENT_DT_CREAT , STR1.PREUVE_CLIENT_DT_MODIF , STR1.CIVILITE_BNFCR , STR1.NOM_BNFCR , STR1.PRENOM_BNFCR , STR1.PARENTE_BNFCR , STR1.ID_CLIENT_COM_BNFCR , STR1.ENTITE_CR_BNFCR , STR1.CANAL , STR1.DAV_NUM , STR1.DAV_LIBELLE , STR1.MONTANT_AVANTAGE , STR1.OFFRE_ID , STR1.IND_UTI_CREDIT , STR1.PREUVE_CLIENT_DT_UTI_CRE , STR1.IND_UTI_MRH , STR1.PREUVE_CLIENT_DT_UTI_MRH , STR1.PREUVE_CLIENT_DT_UTI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CLI_CIAL_COM , COALESCE(CIR5.ID_DWR,0) ID_DWR_CLI_CIAL_BNF , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.CLIENT_COMMERCIAL_ID = CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_PRVE CIR3 ON ((STR1.CD_EDS_BNQ = CIR3.CD_BQE OR 99900 = CIR3.CD_BQE) AND STR1.PREUVE_ID = CIR3.ID_PRVE) LEFT JOIN %SOC%.TYP_CNL_FIDEL CIR2 ON (STR1.CANAL = CIR2.ID_CNL_FIDEL) LEFT JOIN %SOC%.TYP_STATU_FIDL CIR4 ON (99900 = CIR4.CD_BQE AND STR1.STATUT_ID = CIR4.ID_STATU_PRVE) LEFT JOIN %TCO%.ID_CLI_CIAL_TCO CIR5 ON (STR1.ENTITE_CR_BNFCR = CIR5.CD_EDS_BNQ AND STR1.ID_CLIENT_COM_BNFCR = CIR5.ID_SOURCE1) LEFT JOIN %SOC%.PRVE_CLI_BNFCR CIR6 ON (CASE WHEN STR1.ENTITE_CR_BNFCR IS NOT NULL THEN STR1.ENTITE_CR_BNFCR ELSE STR1.CD_EDS_BNQ END = CIR6.CD_BQE AND STR1.PREUVE_CLIENT_ID = CIR6.ID_PRVE_CLI) WHERE 1=1
GRA006                                            SELECT STR1.CD_EDS_BNQ , STR1.GRA006_IDELCO , STR1.NUECEL , STR1.CTCEPR , STR1.CDETAB , STR1.CDGUIC , STR1.NCPRIB , STR1.CLERIB , STR1.MTDURE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR_EDC,0) ID_DWR_EDC_ECD , COALESCE(CIR3.ID_DWR_EDC,0) ID_DWR_EDC_CRED , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_BQE, ID_EDC_ECHCE FROM %SOC%.PLFD_UTIL WHERE ID_EDC_ECHCE IS NOT NULL) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.GRA006_IDELCO=CIR1.ID_EDC_ECHCE) LEFT JOIN %SOC%.ECD_DETENU CIR2 ON (CIR1.CD_BQE =CIR2.CD_BQE AND CIR1.ID_EDC_ECHCE =CIR2.ID_EDC_CRED AND CIR2.ID_EDC_CRED IS NOT NULL AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CRED CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.GRA006_IDELCO=CIR3.ID_EDC_CRED AND CIR3.ID_EDC_CRED IS NOT NULL AND CIR3.TYP_SOURCE_CRED = 'G' AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
C815ACT                                           SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CTACO , STR1.IDCCA , STR1.CPIMVP , STR1.IDACT , STR1.CPOBJL , STR1.IDELCO , STR1.NOPRPR , STR1.NOOPPR , STR1.DDLIEN , STR1.DFLIEN , STR1.IDACTL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR3.ID_DWR_EDC,0) ID_DWR_EDC , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CTR_CADRE CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDCCA = CIR1.ID_CTR_CADRE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ACTN_CRED_COMPLEXE CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDACT = CIR2.ID_ACTN AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CRED CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDELCO = CIR3.ID_EDC_CRED AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CPOBJL = CIR4.CD_STATU_CRED_COMPLEXE AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
FDPSRM01                                          SELECT STR1.CD_EDS_BNQ , STR1.NOLIG , STR1.CDSOC6 , STR1.DTFAC , STR1.IDFAC1 , STR1.NUMLFF , STR1.IDECLI , STR1.IDCTR IDCTR_BYTE , CAST(%PMU%.Bin2Char(IDCTR) AS VARCHAR(40)) AS IDCTR , STR1.IDESRV , STR1.CDORI , STR1.CDCAPL , STR1.CDCDTH , STR1.IDEBAR , STR1.IDEBSD , STR1.QOOPE , STR1.KOERED , STR1.IDEOPE , STR1.CADEVI , STR1.IDCNL4 , STR1.DDPERX , STR1.DFPER3 , STR1.DACREA , STR1.CDRINF , STR1.PERRGP , STR1.CDTOPH , STR1.IDEFOP , STR1.NBROPF , STR1.NBROPF_SIGNE , STR1.MNTFAC , STR1.MNTFAC_SIGNE , STR1.NBRFAC , STR1.NBRFAC_SIGNE , STR1.CDORIT , STR1.CDORIZ , STR1.CBIND8 , STR1.CADEVA , STR1.NBDEC , STR1.CADEVC , STR1.NBDEC6 , STR1.CADEV4 , STR1.INDTTC , STR1.MTCLC , STR1.MTCLC_SIGNE , STR1.MTHHTA , STR1.MTHHTA_SIGNE , STR1.MTHTTC , STR1.MTHTTC_SIGNE , STR1.MTFACX , STR1.MTFACX_SIGNE , STR1.MTFACW , STR1.MTFACW_SIGNE , STR1.IAGEN3 , STR1.CDMOF , STR1.CBIDEC , STR1.MTDCIA , STR1.MTDCIA_SIGNE , STR1.MTDCI , STR1.MTDCI_SIGNE , STR1.IAGEN4 , STR1.CDMOF1 , STR1.DATMRE , STR1.CBINDT , STR1.MTARE , STR1.MTARE_SIGNE , STR1.MTARE3 , STR1.MTARE3_SIGNE , STR1.NCPTIM , STR1.NCPTE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN TRIM(STR1.CDMOF1) NOT IN ('RIS', 'RED', '99998', 'PLD') THEN 1 WHEN TRIM(STR1.CDMOF1) IN ('RIS', 'RED', '99998', 'PLD') AND STR1.DATMRE < STR1.DT_ELIG AND TD_MONTH_BEGIN(ADD_MONTHS(STR1.DT_ELIG,-1))<= STR1.DTFAC AND STR1.DTFAC <= TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) THEN 1 ELSE 0 END AS TOP_PASS FROM %DTA%.%ObjectNameFrom% STR1
ELCOCPTE                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.NCPTE , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDELCO=CIR1.BY_SOURCE1 AND SUBSTR(CIR1.ID_SOURCE1,31,3) = 'ECD')
PARTCDES                                          SELECT STR1.CD_EDS_BNQ , STR1.IDPACO , STR1.IDNUPA IDNUPA_BYTE , CAST(COALESCE(TCO1.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDNUPA , STR1.IDTDOP , STR1.CDJHR , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_COORD , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , COALESCE(TCO2.ID_DWR,0) ID_DWR_PERSON , COALESCE(CIR4.CT_PART,' ') CT_PART , COALESCE(CIR5.ID_DWR,0) ID_DWR_ETS , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT T1.CD_EDS_BNQ ,T1.ID_DWR ,T1.BY_SOURCE1 , T1.ID_SOURCE1 FROM %TCO%.ID_COORD_TCO T1 WHERE SUBSTR(T1.ID_SOURCE1,1,3)='ADR' AND EXISTS (SELECT NULL FROM %SOC%.ADR CIR1 WHERE CIR1.CD_BQE=T1.CD_EDS_BNQ AND T1.ID_DWR=CIR1.ID_DWR_COORD AND CIR1.ID_INTIT_SPCFQ <> 'ADR_EDS') ) TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDNUPA=TCO1.BY_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPACO=CIR2.ID_SOURCE1) LEFT JOIN (SELECT T3.CD_EDS_BNQ ,T3.ID_SOURCE1 ,T3.ID_DWR FROM %TCO%.ID_PERSON_TCO T3 where EXISTS (SELECT NULL FROM %SOC%.PERSON CIR3 WHERE T3.CD_EDS_BNQ=CIR3.CD_BQE and T3.ID_DWR = CIR3.ID_DWR_PERSON ) ) TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDPACO=TCO2.ID_SOURCE1 ) LEFT JOIN %TCO%.ID_ETS_TCO CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ AND STR1.IDPACO=CIR5.ID_SOURCE1) LEFT JOIN %SOC%.PART CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.IDPACO=CIR4.ID_PART AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
SEGMAR                                            SELECT STR1.CD_EDS_BNQ , STR1.IDSECO , STR1.IDMARC , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.SEGM_MRCH_CIAL CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDSECO = CIR1.ID_SEGM_CIAL AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.MRCH CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.IDMARC = CIR2.ID_MRCH AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
TYP_FLIER_CALCL_CST                               SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_CT_RISQ_EXPOSE_CST                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
PROD_PRODTR                                       SELECT STR1.CD_EDS_BNQ , STR1.CD_PROD_PRODTR , STR1.CD_PROD_CIAL , STR1.ID_PRODTR_ORIG , STR1.LI_PROD_PRODTR , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_PROD_CIAL is Null Then 0 Else 1 END Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_PROD_CIAL FROM %SOC%.PROD_CIAL) CIR1 ON (STR1.CD_PROD_CIAL=CIR1.CD_PROD_CIAL)
T3R08                                             SELECT STR1.CD_EDS_BNQ , IDELST IDELST_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELST) end AS VARCHAR(30)) AS IDELST , STR1.IDPACO , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDS , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPACO=CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDS_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDELST=CIR2.BY_SOURCE1)
TDSCK117                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.IDFACG , STR1.IDREEV , STR1.IDFOU1 , STR1.DAFACT , STR1.NUSEQE , STR1.LIFACT , STR1.FILLER155 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
HCERPA                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCCO AS IDCCO_BYTE , CAST(COALESCE(CIR1.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDCCO , STR1.IDPART , STR1.CDPRIA , COALESCE(CIR3.DD_VALID, STR1.DELIEN) DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , CIR3.DD_HISTO , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CRCL_COM , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CRCL_COM_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDCCO =CIR1.BY_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART=CIR2.ID_SOURCE1) INNER JOIN ( select S1.CD_BQE , S1.ID_DWR_CRCL_COM , S1.ID_DWR_PART , S1.CD_PRIOR_PART , S1.DD_VALID , S1.DF_VALID , S1.DD_HISTO , S1.DF_HISTO from (Select Distinct CD_BQE ,ID_DWR_CRCL_COM ,ID_DWR_PART ,CD_PRIOR_PART ,DD_VALID ,DF_VALID ,DD_HISTO ,DF_HISTO ,'1' AS RECENT from %SOC%.PART_CMPS_CRCL_COM Union Select Distinct CD_BQE ,ID_DWR_CRCL_COM ,ID_DWR_PART ,CD_PRIOR_PART ,DD_VALID ,DF_VALID ,DD_HISTO ,DF_HISTO ,'0' AS RECENT from %WRK%.PART_CMPS_CRCL_COM) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_DWR_CRCL_COM,S1.ID_DWR_PART,S1.DD_HISTO ORDER BY S1.CD_BQE,S1.ID_DWR_CRCL_COM,S1.ID_DWR_PART,S1.DD_HISTO ,S1.RECENT)=1) CIR3 ON (CIR1.CD_EDS_BNQ=CIR3.CD_BQE AND CIR1.ID_DWR=CIR3.ID_DWR_CRCL_COM AND CIR2.ID_DWR=CIR3.ID_DWR_PART and STR1.DELIEN=CIR3.DD_HISTO AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) where 1=1 and STR1.TK_ACTION<>'D'
DGXG68                                            SELECT STR1.CD_EDS_BNQ , STR1.IDTAC , STR1.LNTAC , STR1.CTCAC , STR1.LITAA , STR1.CDCAA , STR1.CDCLA , STR1.CPIAP , STR1.CAMAP , STR1.CQTYA , STR1.LNCTA , STR1.IDRCS , STR1.CTNTA , STR1.CPTAM , STR1.CPCAP , STR1.CPADE , STR1.CPDISP , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
ACTE_DSTRB                                        SELECT STR1.CD_EDS_BNQ , STR1.CD_ACTE_DSTRB , STR1.APPLTN_CIALE_ACTE_DSTRB , STR1.LI_ACTE_DSTRB , STR1.TOP_SOUSC , STR1.DESC_ACTE_DSTRB , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_SEGM_NOTATN_BALE2_CST                         SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DGXG61                                            SELECT STR1.CD_EDS_BNQ , STR1.IDTYS , STR1.IDSGN , STR1.DMSGN , STR1.LNSGN , STR1.IDTYSZ , STR1.IDSGNZ , STR1.LNCSM , STR1.CDACS , STR1.IDTCC , STR1.CDSIC , STR1.CCTYC , STR1.CCSGM , STR1.QQPOT0 , STR1.QQREC0 , STR1.QQRIS0 , STR1.LMSGN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then Case When Trim(COALESCE(STR1.IDTYSZ,'')) = '' then 1 else 0 end else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_SGMTN_EMACO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDTYS = CIR1.CT_SGMTN AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_SGMTN_EMACO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.IDTYSZ= CIR2.CT_SGMTN AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
FREVAL                                            SELECT CD_EDS_BNQ , IDVAL4 , LIBVA2 , CVALC , MVNOM7 , CBTYV , CMNEV , DDNEG , DFNEG , CCVLR , CCTIT3 , CSTAT , CNATV2 , CDLIBN , CDTVM1 , CCVAL , RE_CYCLE , DT_ELIG , TK_CREATE , TK_CHANGE , TK_FLAG , TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYSEGMTR                                          SELECT STR1.CD_EDS_BNQ , STR1.CTSEG8 , STR1.LITYSG , STR1.LISOUR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_AMRTSM_CST                                    SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
T3R14C                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDSECO , STR1.DAENSG , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR,0) AS ID_DWR_PART , COALESCE(CIR3.ID_DWR,0) AS ID_DWR_PERSON , COALESCE(CIR4.CTPART,'') AS CTPART , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.SEGM_MRCH_CIAL CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDSECO=CIR1.ID_SEGM_CIAL AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART=CIR2.ID_SOURCE1) LEFT JOIN %TCO%.ID_PERSON_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDPART=CIR3.ID_SOURCE1) LEFT JOIN %DE1%.PARTEN CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND STR1.IDPART=CIR4.IDPART and CIR4.CTPART IN ('PP', 'PM'))
OPTN_GRP_CHOIX                                    SELECT STR1.CD_EDS_BNQ , STR1.CD_GRP_CHOIX , STR1.CD_OPTN , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_GRP_CHOIX is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_OPTN is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_GRP_CHOIX FROM %SOC%.GRP_CHOIX) CIR1 ON (STR1.CD_GRP_CHOIX=CIR1.CD_GRP_CHOIX) LEFT JOIN (Select DISTINCT CD_OPTN FROM %SOC%.OPTN ) CIR2 ON (STR1.CD_OPTN=CIR2.CD_OPTN)
FAIT_UTI                                          SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CT_FAIT_UTI , STR1.ID_LIST_IMPORT , STR1.LI_LIST_IMPORT , Cast(oreplace(STR1.LI_LIST_IMPORT,'+','_') AS VARCHAR(150)) as LI_LIST_IMPORT_VBA , STR1.NU_LIGNE , STR1.DD_PE , STR1.CT_PE , STR1.ID_EXT_EDS , STR1.CD_FAM_OFR , STR1.ID_OFR_BQR , STR1.CD_FAM_PROD , STR1.CD_PROD_CIAL , STR1.ID_MRCH , STR1.ID_SGMTN_EMACO , STR1.ID_EMACO , STR1.CD_AGT_ECON , STR1.ID_PORTEF , STR1.ID_PORTEF_SECD , STR1.CD_PROD_PRODTR , STR1.ID_OPERN_FACTN , STR1.ID_PART , STR1.ID_CLI_CIAL , STR1.NU_CPTE , STR1.NU_SIREN , STR1.ID_EDC_CRED , STR1.ID_CTR_IARD , STR1.CD_TRCH_AGE , STR1.CT_PART , STR1.ID_EXT_EDS_PTF , STR1.CD_PROD_BDF , STR1.ID_SEGM_CIAL , STR1.ID_EXT_EDS_ORGA , STR1.ID_FNCTN , STR1.CD_TRCH_NB_OPERN , STR1.CD_PST_FNCT , STR1.CD_TRCH_DUR_INITL_PRET , STR1.CD_TRCH_DUR_INITL_PRET_AGRG , STR1.CD_PROD_PLTAGE , STR1.VAL_FAIT_UTI , STR1.ID_UTI_ORIG , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case WHEN STR1.ID_EXT_EDS <> '-1' and (COALESCE(STR1.ID_EXT_EDS,'')='' OR CIR2.CD_BQE is null ) then 0 else 1 End Row_Found_CIR2 , Case WHEN STR1.CD_FAM_OFR <> '-1' and (COALESCE(STR1.CD_FAM_OFR,'')='' OR CIR3.CD_FAM_OFR is null ) then 0 else 1 End Row_Found_CIR3 , Case WHEN STR1.ID_OFR_BQR <> '-1' and (COALESCE(STR1.ID_OFR_BQR ,'')='' OR CIR4.ID_OFR_BQR is null ) then 0 else 1 End Row_Found_CIR4 , Case WHEN STR1.CD_FAM_PROD <> '-1' and (COALESCE(STR1.CD_FAM_PROD ,'')='' OR CIR5.CD_FAM_PROD is null ) then 0 else 1 End Row_Found_CIR5 , Case WHEN STR1.CD_PROD_CIAL <> '-1' and (COALESCE(STR1.CD_PROD_CIAL ,'')='' OR CIR6.CD_PROD_CIAL is null ) then 0 else 1 End Row_Found_CIR6 , Case WHEN STR1.ID_MRCH <> '-1' and (COALESCE(STR1.ID_MRCH,'')='' OR CIR7.CD_BQE is null ) then 0 else 1 End Row_Found_CIR7 , Case WHEN STR1.ID_SGMTN_EMACO <> '-1' and (COALESCE(STR1.ID_SGMTN_EMACO ,'')='' OR CIR8.ID_SGMTN_EMACO is null ) and ( CIR8.CT_SGMTN <> 'AP' AND CIR8.CT_SGMTN <> 'PO') then 0 else 1 End Row_Found_CIR8 , Case WHEN STR1.ID_EMACO <> '-1' and (COALESCE(STR1.ID_EMACO ,'')='' OR CIR9.ID_EMACO is null ) and (CIR9.CT_SGMTN <> 'AP' AND CIR9.CT_SGMTN <> 'PO') then 0 else 1 End Row_Found_CIR9 , Case WHEN STR1.CD_AGT_ECON <> '-1' and (COALESCE(STR1.CD_AGT_ECON,'')='' OR CIR10.CD_BQE is null ) then 0 else 1 End Row_Found_CIR10 , Case WHEN STR1.ID_PORTEF <> '-1' and (COALESCE(STR1.ID_PORTEF,'')='' OR CIR11.CD_BQE is null ) then 0 else 1 End Row_Found_CIR11 , Case WHEN STR1.ID_PORTEF_SECD <> '-1' and (COALESCE(STR1.ID_PORTEF_SECD,'')='' OR CIR12.CD_BQE is null ) then 0 else 1 End Row_Found_CIR12 , Case WHEN STR1.CD_PROD_PRODTR <> '-1' and (COALESCE(STR1.CD_PROD_PRODTR,'')='' OR CIR13.CD_BQE is null ) then 0 else 1 End Row_Found_CIR13 , Case WHEN STR1.ID_OPERN_FACTN <> '-1' and (COALESCE(STR1.ID_OPERN_FACTN,'')='' OR CIR14.CD_BQE is null ) then 0 else 1 End Row_Found_CIR14 , Case WHEN STR1.ID_PART <> '-1' and (COALESCE(STR1.ID_PART,'')='' OR CIR15.CD_BQE is null ) then 0 else 1 End Row_Found_CIR15 , Case WHEN STR1.ID_CLI_CIAL <> '-1' and (COALESCE(STR1.ID_CLI_CIAL,'')='' OR CIR16.CD_BQE is null ) then 0 else 1 End Row_Found_CIR16 , Case WHEN STR1.NU_CPTE <> '-1' and (COALESCE(STR1.NU_CPTE,'')='' OR CIR17.CD_BQE is null ) then 0 else 1 End Row_Found_CIR17 , Case WHEN STR1.NU_SIREN <> '-1' and (COALESCE(STR1.NU_SIREN,'')='' OR CIR18.CD_BQE is null ) then 0 else 1 End Row_Found_CIR18 , Case WHEN STR1.ID_EDC_CRED <> '-1' and (COALESCE(STR1.ID_EDC_CRED,'')='' OR CIR19.CD_BQE is null ) then 0 else 1 End Row_Found_CIR19 , Case WHEN STR1.ID_CTR_IARD <> '-1' and (COALESCE(STR1.ID_CTR_IARD,'')='' OR CIR20.CD_EDS_BNQ is null ) then 0 else 1 End Row_Found_CIR20 , Case WHEN STR1.CD_TRCH_AGE <> '-1' and (COALESCE(STR1.CD_TRCH_AGE,'')='' OR CIR21.CD_BQE is null ) then 0 else 1 End Row_Found_CIR21 , Case WHEN STR1.CT_PART <> '-1' and (COALESCE(STR1.CT_PART,'')='' OR CIR22.CD_BQE is null ) then 0 else 1 End Row_Found_CIR22 , Case WHEN STR1.ID_EXT_EDS_PTF <> '-1' and (COALESCE(STR1.ID_EXT_EDS_PTF,'')='' OR CIR23.CD_BQE is null ) then 0 else 1 End Row_Found_CIR23 , Case WHEN STR1.CD_PROD_BDF <> '-1' and (COALESCE(STR1.CD_PROD_BDF,'')='' OR CIR24.CD_BQE is null ) then 0 else 1 End Row_Found_CIR24 , Case WHEN STR1.ID_EXT_EDS_ORGA <> '-1' AND (COALESCE(STR1.ID_EXT_EDS_ORGA,'')='' OR CIR25.CD_BQE is null ) then 0 else 1 End Row_Found_CIR25 , Case WHEN STR1.ID_SEGM_CIAL <> '-1' AND CIR26.CD_BQE is null then 0 else 1 End Row_Found_CIR26 , Case WHEN STR1.CD_TRCH_NB_OPERN <> '-1' AND CIR27.CD_BQE is null then 0 else 1 End Row_Found_CIR27 , Case WHEN STR1.ID_FNCTN <> '-1' AND CIR28.CD_BQE is null then 0 else 1 End Row_Found_CIR28 , Case WHEN STR1.CD_PST_FNCT <> '-1' AND (COALESCE(STR1.CD_PST_FNCT,'')='' OR CIR29.CD_BQE is null ) then 0 else 1 End Row_Found_CIR29 , Case WHEN STR1.CD_TRCH_DUR_INITL_PRET <> '-1' AND CIR30.CD_BQE is null then 0 else 1 End Row_Found_CIR30 , Case WHEN STR1.CD_TRCH_DUR_INITL_PRET_AGRG <> '-1' AND CIR31.CD_BQE is null then 0 else 1 End Row_Found_CIR31 , Case WHEN STR1.CD_PROD_PLTAGE <> '-1' AND (COALESCE(STR1.CD_PROD_PLTAGE,'')='' OR CIR32.CD_BQE is null ) then 0 else 1 End Row_Found_CIR32 , MIN( CASE WHEN Row_Found_CIR1=0 or Row_Found_CIR2=0 or Row_Found_CIR3=0 or Row_Found_CIR4=0 or Row_Found_CIR5=0 or Row_Found_CIR6=0 or Row_Found_CIR7=0 or Row_Found_CIR8=0 or Row_Found_CIR9=0 or Row_Found_CIR10=0 or Row_Found_CIR11=0 or Row_Found_CIR12=0 or Row_Found_CIR13=0 or Row_Found_CIR14=0 or Row_Found_CIR15=0 or Row_Found_CIR16=0 or Row_Found_CIR17=0 or Row_Found_CIR18=0 or Row_Found_CIR19=0 or Row_Found_CIR20=0 or Row_Found_CIR21=0 or Row_Found_CIR22=0 or Row_Found_CIR23=0 or Row_Found_CIR24=0 or Row_Found_CIR25=0 or Row_Found_CIR26=0 or Row_Found_CIR27=0 or Row_Found_CIR28=0 or Row_Found_CIR29=0 or Row_Found_CIR30=0 or Row_Found_CIR31=0 or Row_Found_CIR32=0 then 0 Else 1 END ) OVER (PARTITION BY STR1.CD_EDS_BNQ,STR1.ID_LIST_IMPORT) REJET_GLOBAL FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_FAIT_UTI CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CT_FAIT_UTI=CIR1.CT_FAIT_UTI AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.ID_EXT_EDS=CIR2.ID_EXT_EDS AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.FAM_OFR CIR3 ON (STR1.CD_FAM_OFR=CIR3.CD_FAM_OFR AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.OFR CIR4 ON (STR1.ID_OFR_BQR=CIR4.ID_OFR_BQR AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %SOC%.FAM_PROD CIR5 ON (STR1.CD_FAM_PROD=CIR5.CD_FAM_PROD AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PROD_CIAL CIR6 ON (STR1.CD_PROD_CIAL=CIR6.CD_PROD_CIAL AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT JOIN %SOC%.MRCH CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_BQE AND STR1.ID_MRCH =CIR7.ID_MRCH AND CAST(CIR7.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR7.DF_HISTO AS DATE)) LEFT JOIN %SOC%.SGMTN_EMACO CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_BQE AND STR1.ID_SGMTN_EMACO =CIR8.ID_SGMTN_EMACO AND CAST(CIR8.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR8.DF_HISTO AS DATE)) LEFT JOIN %SOC%.SEGM_EMACO CIR9 ON (STR1.CD_EDS_BNQ=CIR9.CD_BQE AND STR1.ID_EMACO =CIR9.ID_EMACO AND CAST(CIR9.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR9.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_AGT_ECON CIR10 ON (STR1.CD_EDS_BNQ=CIR10.CD_BQE AND STR1.CD_AGT_ECON =CIR10.CD_AGT_ECON AND CAST(CIR10.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR10.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.PORTEF CIR11 ON (STR1.CD_EDS_BNQ=CIR11.CD_BQE AND STR1.ID_PORTEF =CIR11.ID_PORTEF AND CAST(CIR11.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR11.DF_HISTO AS DATE) AND CIR11.ID_CT_PORTEF <='02') LEFT JOIN %SOC%.PORTEF CIR12 ON (STR1.CD_EDS_BNQ=CIR12.CD_BQE AND STR1.ID_PORTEF_SECD =CIR12.ID_PORTEF AND CAST(CIR12.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR12.DF_HISTO AS DATE) AND CIR12.ID_CT_PORTEF >'02') LEFT JOIN %SOC%.PROD_PRODTR CIR13 ON (STR1.CD_EDS_BNQ=CIR13.CD_BQE AND STR1.CD_PROD_PRODTR=CIR13.CD_PROD_PRODTR AND CAST(CIR13.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR13.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_OPERN_FACTN CIR14 ON (STR1.CD_EDS_BNQ=CIR14.CD_BQE AND STR1.ID_OPERN_FACTN =CIR14.ID_OPERN_FACTN AND CAST(CIR14.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR14.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.PART CIR15 ON (STR1.CD_EDS_BNQ=CIR15.CD_BQE AND STR1.ID_PART =CIR15.ID_PART AND CAST(CIR15.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR15.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CLI_CIAL CIR16 ON (STR1.CD_EDS_BNQ=CIR16.CD_BQE AND STR1.ID_CLI_CIAL =CIR16.ID_CLI_CIAL AND CAST(CIR16.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR16.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CPTE CIR17 ON (STR1.CD_EDS_BNQ=CIR17.CD_BQE AND STR1.NU_CPTE =CIR17.NU_CPTE AND CAST(CIR17.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR17.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ENTR CIR18 ON (STR1.CD_EDS_BNQ=CIR18.CD_BQE AND STR1.NU_SIREN =CIR18.NU_SIREN AND CAST(CIR18.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR18.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CRED CIR19 ON (STR1.CD_EDS_BNQ=CIR19.CD_BQE AND STR1.ID_EDC_CRED=CIR19.ID_EDC_CRED AND CAST(CIR19.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR19.DF_HISTO AS DATE) ) LEFT JOIN %TCO%.ID_CTR_IARD_TCO CIR20 ON (STR1.CD_EDS_BNQ = CIR20.CD_EDS_BNQ AND CAST(STR1.ID_CTR_IARD AS BIGINT) = CIR20.ID_DWR) LEFT JOIN %SOC%.TYP_TRCH_AGE CIR21 ON (STR1.CD_EDS_BNQ=CIR21.CD_BQE AND STR1.CD_TRCH_AGE =CIR21.CD_TRCH_AGE AND CAST(CIR21.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR21.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_PART CIR22 ON (STR1.CD_EDS_BNQ=CIR22.CD_BQE AND STR1.CT_PART =CIR22.CT_PART AND CAST(CIR22.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR22.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR23 ON (STR1.CD_EDS_BNQ=CIR23.CD_BQE AND STR1.ID_EXT_EDS_PTF =CIR23.ID_EXT_EDS AND CAST(CIR23.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR23.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_PROD_BDF CIR24 ON (STR1.CD_EDS_BNQ=CIR24.CD_BQE AND STR1.CD_PROD_BDF =CIR24.CD_PROD_BDF AND CAST(CIR24.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR24.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR25 ON (STR1.CD_EDS_BNQ=CIR25.CD_BQE AND STR1.ID_EXT_EDS_ORGA =CIR25.ID_EXT_EDS AND CAST(CIR25.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR25.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.SEGM_MRCH_CIAL CIR26 ON (STR1.CD_EDS_BNQ=CIR26.CD_BQE AND STR1.ID_SEGM_CIAL =CIR26.ID_SEGM_CIAL AND CIR26.CT_SEGM_CIAL = 9 AND CAST(CIR26.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR26.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_TRCH_NB_OPERN CIR27 ON (STR1.CD_EDS_BNQ=CIR27.CD_BQE AND STR1.CD_TRCH_NB_OPERN =CIR27.CD_TRCH_NB_OPERN AND CAST(CIR27.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR27.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.FNCTN CIR28 ON (STR1.CD_EDS_BNQ=CIR28.CD_BQE AND STR1.ID_FNCTN =CIR28.ID_FNCTN AND CAST(CIR28.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR28.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.PST_FNCT CIR29 ON (STR1.CD_EDS_BNQ=CIR29.CD_BQE AND STR1.CD_PST_FNCT =CIR29.CD_PST_FNCT AND CAST(CIR29.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR29.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_TRCH_DUR_INITL_PRET CIR30 ON (STR1.CD_EDS_BNQ=CIR30.CD_BQE AND STR1.CD_TRCH_DUR_INITL_PRET =CIR30.CD_TRCH_DUR_INITL_PRET AND CAST(CIR30.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR30.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_TRCH_DUR_INITL_PRET_AGRG CIR31 ON (STR1.CD_EDS_BNQ=CIR31.CD_BQE AND STR1.CD_TRCH_DUR_INITL_PRET_AGRG =CIR31.CD_TRCH_DUR_INITL_PRET_AGRG AND CAST(CIR31.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR31.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_CD_PROD_PLTAGE CIR32 ON (STR1.CD_EDS_BNQ=CIR32.CD_BQE AND STR1.CD_PROD_PLTAGE =CIR32.CD_PROD_PLTAGE)
GRCO_MVT_PROV                                     SELECT STR1.IDEXEY, STR1.IDELCH, STR1.CDMOPR, STR1.MPROK5, STR1.MTPRV8, STR1.DEVNT, STR1.CDMOTV, STR1.MPROK6, STR1.MPROK7, STR1.CDSTGO, STR1.CTCREB, STR1.CTCRK, STR1.DCARR7, STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
APPSEG                                            SELECT STR1.CD_EDS_BNQ , STR1.CTSEGM , STR1.CTSEG1 , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_SEGM_CIAL CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.CTSEGM = CIR1.CT_SEGM_CIAL AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_SEGM_CIAL CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.CTSEG1 = CIR2.CT_SEGM_CIAL AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
OPE                                               SELECT STR1.CD_EDS_BNQ, STR1.OPE_IDEOPE, STR1.FOP_IDEFOP, STR1.SOC_IDESOC, STR1.DT_ELIG, STR1.RE_CYCLE, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION, CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1, CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 FROM %DTA%.OPE STR1 LEFT JOIN %SOC%.TYP_OPERN_FACTN CIR1 ON ( STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.OPE_IDEOPE = CIR1.ID_OPERN_FACTN) LEFT JOIN %SOC%.TYP_FAM_OPERN_FACTN CIR2 ON ( STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.FOP_IDEFOP = CIR2.CD_FAM_OPERN_FACTN)
PERMOR                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.CDFJUR , STR1.CDFICO , STR1.DAANEX , STR1.NOASSO , STR1.CDRASO , STR1.LNMUSU , STR1.CDSIJU , STR1.CDUTPU , STR1.DAUTPU , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.CDFJUC , STR1.MTCASO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1 )
UNICA_3E                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.IDPRG , STR1.IDECA1 , STR1.IDCPG2 , STR1.LICPG , STR1.LNLCPG , STR1.LISTS , STR1.DDPRV0 , STR1.DFPRV0 , STR1.LIGRB , STR1.LISTA3 , STR1.IDCPG3 , STR1.LMCPG3 , STR1.DDCPG0 , STR1.DFCPG0 , STR1.LMOBJC , STR1.LMINIC , STR1.LISTSC , STR1.KFCPG0 , STR1.CTPRJC , STR1.LITYPP , STR1.LCCPG , STR1.CMARCH , STR1.IDSEC1 , STR1.CDDOM6 , STR1.CDSDOM , STR1.CTCPGU , STR1.LTYPO , STR1.CTEXEC , STR1.LITEXE , STR1.CFEXE , STR1.LIFEXE , STR1.LMFEXE , STR1.CBAOPT , STR1.CBISMC , STR1.IDCPGC , STR1.CQTRA0 , STR1.LITRAV , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
EDSNTEDS                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDTYXK , STR1.LITYXK , STR1.LND2XK , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TIMTBP01                                          SELECT STR1.CD_EDS_BNQ , STR1.NPART , STR1.CEETB9 , STR1.NUCTEA , STR1.CEBQE9 , STR1.CDGUS9 , STR1.NUISO , STR1.DTREC9 , STR1.NUSQA9 , STR1.NUSIR , STR1.DTACH9 , STR1.RAISO , STR1.CEDPT , STR1.LILOCA , STR1.CDIPPC , STR1.IDAUT9 , STR1.HIVEN9 , STR1.IDERT , STR1.DTRGT9 , STR1.CDMCC1 , STR1.NULOP , STR1.MTDEV8 , STR1.CEDEVX , STR1.CEDEVA , STR1.LIPAY , STR1.CDOPFL , STR1.ZBDRJ , STR1.MTCOM9 , STR1.MTOPE9 , STR1.MTRET9 , STR1.DTRFV9 , STR1.DTPDD9 , STR1.HECDD9 , STR1.DTARC9 , STR1.NUSDI9 , STR1.CEORT9 , STR1.CEREE9 , STR1.TYOPP9 , STR1.DTTCM9 , STR1.DTADD9 , STR1.NUAUTO , STR1.IDCAD9 , STR1.NBDEC9 , STR1.MTRCA9 , STR1.MTFIR9 , STR1.MTFAC9 , STR1.CDBQEM , STR1.NBDECZ , STR1.CDSERC , STR1.CDSER2 , STR1.CDSER3 , STR1.CDSER4 , STR1.CDSER5 , STR1.CDSER6 , STR1.DTBCM9 , STR1.IDOPC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_TRCH_ANC_CTR_CST                              SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) CD_ANC_CTR , CAST('SANS TRANCHE D''ANCIENNETE' AS VARCHAR(25)) LI_ANC_CTR , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_DEPT_INVSTMNT_CST                             SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TDSCK115                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.NOEVIP , STR1.LNBQE , STR1.LNBQE1 , STR1.NCPTE , STR1.TXIETI , STR1.REFEXT , STR1.FILLER130 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
T1R07P                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.IDCTRA IDCTRA_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRA) end AS VARCHAR(30)) AS IDCTRA , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CTR , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR3.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDCTRA= CIR1.BY_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDELCO= CIR2.BY_SOURCE1 and Substr(CIR2.ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND CIR3.CDTABO='T1R07P')
ELCOCOFF                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(COALESCE(CIR3.ID_SOURCE1,'') AS VARCHAR(30)) AS IDELCO , STR1.NCOF NCOF_BYTE , CAST(%PMU%.Bin2Char(STR1.NCOF) AS VARCHAR(30)) AS NCOF , STR1.DDLOC , STR1.TYPLOCT , STR1.MODERGLT , STR1.CEXOFACO , STR1.CDVASS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR3.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR2.ID_DWR_EDS,0) ID_DWR_EDS , CAST(COALESCE(CIR1.BG,0) as INTEGER) BG , CAST(COALESCE(CIR1.NCOMP,0) as DECIMAL(5,0)) NCOMP , CAST(COALESCE(CIR1.TYPCOF,0) as DECIMAL(2,0)) TYPCOF , CIR1.DTCRECOF , CIR1.DTFEXICO , Case When (CIR1.DTFEXICO IS NULL OR CAST(CIR1.DTFEXICO AS DATE) = '1900-01-01') THEN CIR4.DF_FONCTIONNEMENT ELSE CIR1.DTFEXICO END DF_EXPLN_COFFRE , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 FROM %DTA%.ELCOCOFF STR1 LEFT JOIN %DE1%.RPRTCOFF CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.NCOF = CIR1.NCOF) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR2 ON (CIR1.CD_EDS_BNQ=CIR2.CD_BQE AND CIR1.BG = CIR2.ID_EXT_EDS AND CIR2.ID_TYP_EDS=6 AND CAST(CIR2.DF_HISTO AS DATE) = '9999-12-31') LEFT JOIN %TCO%.ID_EDC_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDELCO = CIR3.BY_SOURCE1 and SUBSTR(ID_SOURCE1,31,3) = 'ECD') LEFT JOIN (SELECT CD_BQE ,ID_DWR_EDC ,DF_FONCTIONNEMENT FROM %SOC%.ECD_DETENU WHERE DF_HISTO = '9999-12-31 00:00:00' ) CIR4 ON (CIR3.CD_EDS_BNQ=CIR4.CD_BQE AND CIR3.ID_DWR=CIR4.ID_DWR_EDC )
TYP_STATU_ECHCE_CST                               SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DGCZ06                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDPAR5 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1)
TIMTBK01                                          SELECT STR1.CD_EDS_BNQ , STR1.CDETB9 , STR1.IDELC9 , STR1.NUCTSC , STR1.CDBQS9 , STR1.CDGUS9 , STR1.NUCRS9 , STR1.IDCDP8 , STR1.NUCLTC , STR1.NUCLBC , STR1.LNBECC , STR1.LNBQSC , STR1.CTDEPC , STR1.IDCLG9 , STR1.NUBUG9 , STR1.CDGUD9 , STR1.CDMVP9 , STR1.NUIDVC , STR1.CDMEKE , STR1.CDPCR9 , STR1.DDCOC9 , STR1.DFCOC9 , STR1.CDMBC9 , STR1.DMCOC8 , STR1.DMCOC9 , STR1.CDTDC9 , STR1.DFTDC9 , STR1.CFPRCO , STR1.DTDPC9 , STR1.MTCKPR , STR1.ZGRICC , STR1.LNBQCC , STR1.CDPRS9 , STR1.NUCACS , STR1.NUCACC , STR1.IDNDCL , STR1.DMNDC9 , STR1.IDNDCD , STR1.DENDC9 , STR1.DFNDC9 , STR1.NURECC , STR1.CDAPCS , STR1.CDGRPE , STR1.DAJADP , STR1.DAJPDP , STR1.CDMPDP , STR1.CDDOCU , STR1.CPNBL9 , STR1.CFDPCK , STR1.CDFACD , STR1.DDDF9 , STR1.DFDF9 , STR1.IDELL9 , STR1.CDNATI , STR1.IDVAD , STR1.IDRBC , STR1.DTOMG9 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CAST(COALESCE(CIR2.ID_SOURCE1,'') AS VARCHAR(30)) IDELCO , CIR1.CDETB9 CDETB9_REF , CIR1.DELIEN , CIR1.DFLIEN , CIR1.DDEDIT ,Case when CIR3.DF_HISTO is null then CAST('1900-01-01' as DATE) else CAST(CIR3.DF_HISTO AS DATE) END as DF_HISTO_CIR , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.TIMELC CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDELC9 = CIR1.IDELC9 AND CIR1.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (CIR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND CIR1.IDELCO = CIR2.BY_SOURCE1 and Substr(CIR2.ID_SOURCE1,31,3) ='ECD') LEFT JOIN %SOC%.PROD_CB CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_BQE and STR1.IDCDP8 = CIR3.ID_CD_PROD_CB)
ELSTPOUV                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDPOUV , STR1.HDOUV , STR1.HFOUV , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TIMTBK03                                          SELECT STR1.CD_EDS_BNQ , STR1.CDETB9 , STR1.IDCDP8 , STR1.LICDPR , STR1.LRCDPR , STR1.IDFOU9 , STR1.CDPCF9 , STR1.CDNICA , STR1.CDTYDE , STR1.IDPCDE , STR1.IDTES9 , STR1.QPVIC8 , STR1.QPVIC9 , STR1.QLIDI9 , STR1.CDBNC , STR1.CDTEQL , STR1.LITEQL , STR1.CFPRCO , STR1.CDPCR9 , STR1.DIENF9 , STR1.DMENF9 , STR1.DEANP9 , STR1.CDLAP9 , STR1.CDDEM9 , STR1.CDEXM9 , STR1.IDSTA9 , STR1.CDCFM9 , STR1.CDVAPC , STR1.CDIFT9 , STR1.QPADP9 , STR1.CDMOCX , STR1.CDIPPC , STR1.CDRKEX , STR1.CDDOCU , STR1.DAJADP , STR1.DAJPDP , STR1.CDMPDP , STR1.CDRECA , STR1.CDGDP , STR1.CFACD , STR1.CDFAC , STR1.CDSERC , STR1.CDCAS , STR1.CDBCO , STR1.DDBCO9 , STR1.DFBCO9 , STR1.IDPVD , STR1.IDDVD , STR1.CDACTU , STR1.CDCRAS , STR1.CDTECO , STR1.NBATVD , STR1.NBATVU , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
ELCPDF                                            SELECT STR1.TK_ACTION , STR1.CD_EDS_BNQ , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.EDELCP , STR1.DDFONC , STR1.DFFONC , STR1.TXRTS1 , STR1.TXRTS2 , STR1.IDPRS7 , STR1.DTRSI1 , STR1.DFDCTE , STR1.DFDPRE , STR1.NBBRFF , STR1.MTGCTA , STR1.MTGPRA , STR1.MTGEMP , STR1.MOSOMP , STR1.MOVCMP , STR1.MSENCJ , STR1.MSENCM , STR1.MFCOVM , STR1.MFCOEM , STR1.MXTRVC , STR1.MXTRPC , STR1.MTPABA , STR1.MTPBAN , STR1.CDSTAZ , STR1.IDPERI , STR1.NCPTEY , STR1.DVALV , STR1.DEEFF , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_EDC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD') LEFT JOIN %SOC%.TYP_STATU_CTR_ASSU CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CIR1.CD_STATU_PRNCP = STR1.CDSTAZ AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
EXCCAPIX                                          SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ IS NOT NULL THEN TCO1.ID_SOURCE1 ELSE Bin2Char(STR1.IDELCO) END AS VARCHAR(30)) AS IDELCO , STR1.IDCTRA AS IDCTRA_BYTE , CAST(Bin2Char(STR1.IDCTRA) AS VARCHAR(30)) AS IDCTRA , STR1.CDENR1 , STR1.IDCLI1 , STR1.IDPACO , STR1.CPELC , STR1.IDPRB2 , STR1.IDPRB4 , STR1.IDCDP3 , STR1.IDCDP4 , STR1.IOFFR2 , STR1.DASICO , STR1.DEFCON , STR1.DFINCO , STR1.CDMOOC , STR1.CDMOFC , STR1.DDFONC , STR1.DFFONC , STR1.LIAPUS , STR1.NCPTEX , STR1.IDFPR0 , STR1.IDFPR1 , STR1.DDCOMP , STR1.DFCOMP , STR1.TYPCP4 , STR1.CPTET0 , STR1.CUSAC1 , STR1.CBTAE , STR1.CBTAR , STR1.IDEXE1 , STR1.IDEXE6 , STR1.IDDEVI , STR1.IDSEC1 , STR1.ITSPPA , STR1.ITSPPE , STR1.CDAGEC , STR1.CTACV , STR1.DDINPA , STR1.MICRE , STR1.RE_CYCLE , TD_MONTH_BEGIN(CAST (STR1.DT_ELIG AS DATE) - INTERVAL '1' MONTH) AS DD_PE , CAST(TD_YEAR_END(CAST (STR1.DT_ELIG AS DATE) - INTERVAL '1' YEAR) AS TIMESTAMP(0)) AS DD_HISTO , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END ROW_FOUND_TCO1 , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END ROW_FOUND_CIR1 , TCO1.ID_DWR , CIR2.CD_FAM_PROD FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD') LEFT OUTER JOIN %SOC%.ECD_DETENU CIR1 ON (TCO1.CD_EDS_BNQ=CIR1.CD_BQE AND TCO1.ID_DWR=CIR1.ID_DWR_EDC AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.ACCL_FAM_PROD CIR2 ON (CIR1.CD_PROD_CIAL = CIR2.CD_PROD_CIAL AND CIR2.CD_FAM_PROD IN ('RGP10019','RGP10033'))
CRM_CARAC                                         SELECT STR1.CD_EDS_BNQ , STR1.CODENR , STR1.IDECAM , STR1.NATURE , STR1.IDENTI , STR1.IDTEC , STR1.LIBELE , STR1.TYPSUJ , STR1.CODTYP , STR1.LIBTYP , STR1.PERIOD , STR1.CODPRO , STR1.CODOFR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
UNICA_3B                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.DEOPF1 , STR1.CDFLX9 , STR1.IDPLA , STR1.IDECA1 , STR1.IDPRG , STR1.LNPGMU , STR1.LMPRG , STR1.LISTS , STR1.DDPRV0 , STR1.DFPRV0 , STR1.CDSECP , STR1.LISECP , STR1.LIGRB , STR1.LISTA2 , STR1.CTCPGU , STR1.LTYPO , STR1.CDDOM6 , STR1.CDMED4 , STR1.LIMEDI , STR1.CDPGMR , STR1.LIPGMR , STR1.CDOBJK , STR1.LIOBJ0 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
DTWHNLIE                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTABO , STR1.CDVAL9 , STR1.CTLIE8 , STR1.CQLCCP , STR1.LINLCP , STR1.CQLCCR , STR1.LINLCR , STR1.CCLIES , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
MESAUV                                            SELECT STR1.CD_EDS_BNQ , STR1.IDMESA IDMESA_BYTE , CAST(Case When TCO1.CD_EDS_BNQ is not null then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDMESA) End AS VARCHAR(30)) AS IDMESA , STR1.DABLEF , STR1.STAMES , STR1.DADBLTH , STR1.IDTYMS , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.MTBLOC , STR1.CDPRMO , STR1.DTSTA , STR1.DTSTA1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.MESAUV STR1 LEFT JOIN %SOC%.TYP_MSVG CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE and STR1.IDTYMS = CIR1.CT_MSVG AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_EVT_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDMESA= TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,1)='4')
RARE02                                            SELECT STR1.CD_EDS_BNQ ,STR1.ISEGN ,STR1.IDPART ,STR1.CDAFFD ,STR1.DAMSNP ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,CIR1.ID_DWR_PART ,Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 ,Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.RARE02 STR1 LEFT JOIN %SOC%.PART CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDPART=CIR1.ID_PART AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_SEGM_NOTATN_BALE2 CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.ISEGN=CIR2.ID_SEGM_NOTATN_BALE2)
EXCCRARX                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.IDCTRA IDCTRA_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCTRA) AS VARCHAR(30)) AS IDCTRA , STR1.IDCLI1 , STR1.IDPACO , STR1.DDFONC , STR1.DFFONC , STR1.IDELCK , STR1.CPPCR6 , STR1.DA1RU , STR1.MKRDR , STR1.MTCRDT , STR1.TXAVA0 , STR1.NBERE0 , STR1.MTRETA , STR1.MTRNO1 , STR1.MTRNO2 , STR1.MTRAN2 , STR1.MTRAN3 , STR1.MTREA6 , STR1.IDPROD , STR1.MTECH4 , STR1.MTRAN1 , STR1.MKRBP1 , STR1.MRASSA , STR1.MTRSTA , STR1.MTADI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR_EDC, (COALESCE(CIR1.ID_DWR_EDC,0))) AS ID_DWR_EDC , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_TCO1 , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND substr(TCO1.ID_SOURCE1, character(TCO1.ID_SOURCE1)-2)='ECD') LEFT JOIN %SOC%.CRED CIR2 ON (CIR2.CD_BQE=TCO1.CD_EDS_BNQ AND TCO1.ID_DWR=CIR2.ID_DWR_EDC AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PLFD_UTIL CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELCK=CIR1.ID_EDC_ECHCE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_NATU_CRED CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDPROD=CIR3.CD_NATU_CRED AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
C819ACT                                           SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CTACO , STR1.IDECV , STR1.CPIMVP , STR1.IDACT , STR1.CPOBJW , STR1.DAWAI , STR1.IDCCA , STR1.CPPIJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ELT_COVENANT CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDECV = CIR1.ID_ELT_COVENANT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ACTN_CRED_COMPLEXE CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDACT = CIR2.ID_ACTN AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CPOBJW = CIR3.CD_STATU_CRED_COMPLEXE AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_CD_PRES_PCE_JUSTIF CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CPPIJ = CIR4.CD_PRES_PCE_JUSTIF AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CTR_CADRE CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE AND STR1.IDCCA = CIR5.ID_CTR_CADRE AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE))
IARFKA60                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.NCPTPA , STR1.KA4P_NOPRJ1 , STR1.KA4P_CPETA , STR1.KA4P_DDVAL7 , STR1.KA4P_DTFVA1 , STR1.KA4P_DDECHB , STR1.KA4P_KMRM , STR1.KA4P_CDMTCO , STR1.KA4P_KMDTRF , STR1.KA4P_MTTAX1 , STR1.KA4P_MTCMRA , STR1.KA4P_MTCOTF , STR1.KA4P_CDGAM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPACO=CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_DOMN_IARD CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CDDOMI=CIR2.CD_DOMN_IARD) LEFT JOIN %SOC%.PROD_PACIFICA_PROD_CIAL CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CDPROD=CIR3.CD_PROD_ASSU_IARD AND CAST (CIR3.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
CAISELST                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDELST , STR1.IDCAIS , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDS , COALESCE(CIR2.ID_DWR,0) ID_DWR_CL , COALESCE(CIR3.ID_EXT_EDS,0) ID_EXT_EDS , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDS_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDELST = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CL_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDCAIS = CIR2.ID_SOURCE1) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE and STR1.IDELST=CIR3.ID_EDS and CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
TCASFM                                            SELECT STR1.CD_EDS_BNQ , STR1.NPART , STR1.NCPTE , STR1.CDICP , STR1.MSFMO9 , STR1.DTRAA2 , STR1.RE_CYCLE , CASE WHEN EXTRACT(DAY FROM STR1.DT_ELIG)<= 25 THEN TD_MONTH_BEGIN(CAST (STR1.DT_ELIG AS DATE) - INTERVAL '1' MONTH) ELSE TD_MONTH_BEGIN(CAST (STR1.DT_ELIG AS DATE)) END AS DD_PE , CASE WHEN EXTRACT(DAY FROM STR1.DT_ELIG)<= 25 THEN CAST(TD_MONTH_END(CAST (STR1.DT_ELIG AS DATE) - INTERVAL '1' MONTH) AS TIMESTAMP(0)) ELSE CAST(TD_MONTH_END(CAST (STR1.DT_ELIG AS DATE)) AS TIMESTAMP(0)) END AS DD_HISTO , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END AS Row_Found_CIR1 , CIR1.ID_DWR_EDC , CASE WHEN REJ1.CD_BQE IS NULL THEN 0 ELSE 1 END AS Row_Found_REJ1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTE=CIR1.NU_CPTE) LEFT OUTER JOIN %REJ%.LIST_NUCOT_ECART REJ1 ON (STR1.CD_EDS_BNQ = REJ1.CD_BQE AND STR1.NCPTE = CAST(REJ1.NU_COT as DECIMAL(11,0)) AND REJ1.OBJECT_CODE ='D300330')
TYP_CT_SIGNER_CST                                 SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ENTREP                                            SELECT STR1.CD_EDS_BNQ , STR1.IDENTR IDENTR_BYTE ,CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDENTR) end AS VARCHAR(30)) AS IDENTR , STR1.CLBDF1 , STR1.NOSIRI , STR1.CDREGI , STR1.NOINOR , STR1.NOINRC , STR1.CDAGEC , STR1.MAENTR , STR1.QTTAEN , STR1.CDREGF , STR1.DFEXER , STR1.CDBFCA , STR1.CDBFCR , STR1.CDBFCP , STR1.DADBIF , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.DMAJCA , STR1.DMAJCC , STR1.DMAJCP , STR1.CDBFCC , STR1.DMAJCD , STR1.CBANAD , STR1.DCENTR , STR1.DFENTR , STR1.CTTYP3 , STR1.LICEIM , STR1.NOSIRO , STR1.DUREXE , STR1.CDNCAF , STR1.CTENTR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_ENTR , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN %TCO%.ID_ENTR_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ and STR1.IDENTR=TCO1.BY_SOURCE1)
FAM_PROD_FAM_PROD                                 SELECT STR1.CD_EDS_BNQ , STR1.CD_FAM_PROD_M , STR1.CD_FAM_PROD_F , STR1.POIDS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_FAM_PROD is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_FAM_PROD is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_FAM_PROD FROM %SOC%.FAM_PROD) CIR1 ON (STR1.CD_FAM_PROD_M=CIR1.CD_FAM_PROD) LEFT JOIN (Select DISTINCT CD_FAM_PROD FROM %SOC%.FAM_PROD) CIR2 ON (STR1.CD_FAM_PROD_F=CIR2.CD_FAM_PROD)
TDSCK130                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.CTDOS2 , STR1.NODOS5 , STR1.FILLER242 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TDSCK122                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.NOEMT , STR1.LNDOR , STR1.DHECHP , STR1.LIDEST , STR1.NOSCT1 , STR1.NREM1 , STR1.MTTVA3 , STR1.TXTVA2 , STR1.REFEXT , STR1.QTOPE1 , STR1.FILLER103 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TDSCK161                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.NCHQ1 , STR1.CEVNT6 , STR1.FILLER237 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRCO_DU_TRANCHE_CORP                              SELECT STR1.IDSTU , STR1.DANOT2 , STR1.DFCOLT , STR1.NTIER0 , STR1.CIDENV , STR1.CDCORB , STR1.CIDTRA , STR1.IDPRET , STR1.NUTRCR , STR1.CDREMO , STR1.CBPRRB , STR1.CBENDE , STR1.IDELCH , STR1.MTIGTA , STR1.MTTRAD , STR1.MTEXP , STR1.MTECDO , STR1.TXLGD9 , STR1.TXLGD8 , STR1.MTEADW , STR1.MTEADZ , STR1.MTEADE , STR1.TXPDE6 , STR1.VPRODE , STR1.KFCOR1 , STR1.KPOND1 , STR1.MTRWB1 , STR1.MTRWH1 , STR1.MTRWA1 , STR1.MTEXLB , STR1.MTEXLH , STR1.MTEXL , STR1.CLACPO , STR1.CBPNUT , STR1.TXCCF3 , STR1.CBBHB , STR1.CIDENM , STR1.IDGARP , STR1.TYSURE , STR1.MGGARR , STR1.CIDSUR , STR1.IDGAR3 , STR1.CDGARP , STR1.MGARPE , STR1.CDNIGP , STR1.CBPCSU , STR1.CBPCGA , STR1.CBPON0 , STR1.CBTCVA , STR1.KPONGA , STR1.CDMPOT , STR1.CDECTR , STR1.CBTCAP , STR1.KCHFP , STR1.MTCVV1 , STR1.MTCVV2 , STR1.IDEXEY , STR1.DCARR7 , STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1 INNER JOIN (SELECT COUNT(DISTINCT GRCO.CDCORB) NB_CDCORB, GRCO.DCARR7, GRCO.IDEXEY FROM %BRL%.%ObjectNameFrom% GRCO GROUP BY GRCO.DCARR7, GRCO.IDEXEY) CIR1 ON (STR1.DCARR7 = CIR1.DCARR7 AND STR1.IDEXEY = CIR1.IDEXEY)
TIMTBK02                                          SELECT STR1.CD_EDS_BNQ , STR1.CDETB9 , STR1.IDSUCA , STR1.DICOS9 , STR1.CDMOC9 , STR1.DTFCP9 , STR1.DGCAL9 , STR1.DADIC9 , STR1.CDMLCC , STR1.DTLIC9 , STR1.DDVAS9 , STR1.DFVAS9 , STR1.DTRES9 , STR1.DTEDC9 , STR1.IDSCCS , STR1.NULOC9 , STR1.CTLOCC , STR1.NUCOS9 , STR1.CDMEK1 , STR1.DMMEC9 , STR1.DFACS9 , STR1.CDGUD9 , STR1.IDTES9 , STR1.IDSTA9 , STR1.NUCSCP , STR1.NUCSCS , STR1.IDELC9 , STR1.CDLAP9 , STR1.CDDEM9 , STR1.CDMPR9 , STR1.CDRDC9 , STR1.CFPLR9 , STR1.MPREM9 , STR1.CFPLA9 , STR1.MPACM9 , STR1.CFPLC9 , STR1.MPCRM9 , STR1.CFPLV9 , STR1.MPVIM9 , STR1.DIENF9 , STR1.DMENF9 , STR1.MTPRC9 , STR1.IDELPR , STR1.DPTAP9 , STR1.CDLIRC , STR1.CDMORC , STR1.DMRES9 , STR1.DTAUT9 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ECD_CB CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELC9=CIR1.ID_ELT_CTR_CB AND CAST(CIR1.DF_HISTO AS DATE)='9999-12-31')
GRA210                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDPRSC , STR1.IDELST ,CAST(CAST(CAST(STR1.IDPRSC AS format 'Z(I)') AS format '9(14)') AS CHAR(14) ) AS IDPRSC_Char , STR1.CDPRSC , STR1.CQPRS2 , STR1.LNPRSC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.GRA210 STR1 LEFT JOIN %SOC%.TYP_CT_PRSCRPTR CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CQPRS2=CIR1.CT_PRSCRPTR)
T1R11                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDPART1 , STR1.CTREPM , STR1.CDFORE , STR1.DELIEN , STR1.DFLIEN , STR1.CBSIG , STR1.DEREPR , STR1.CPROFE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , COALESCE(CIR2.ID_DWR,0) PER_ID_DWR_PERSON , COALESCE(CIR3.CQLCCP,' ') NAT_CD_NATU_LIEN , COALESCE(CIR3.CQLCCR,' ') NAT_CD_NATU_LIEN_R , COALESCE(CIR4.CQLCCP,' ') CD_NATU_LIEN , COALESCE(CIR4.CQLCCR,' ') CD_NATU_LIEN_R , COALESCE(CIR5.ID_DWR,0) ID_DWR_PART , COALESCE(CIR6.ID_DWR,0) PAR_ID_DWR_PART , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR5 , CASE WHEN CIR6.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR6 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1 ) LEFT JOIN %TCO%.ID_PERSON_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPART1= CIR2.ID_SOURCE1 ) LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.CTREPM = CAST(CIR3.CDVAL9 AS DECIMAL(1)) and CIR3.CDTABO = 'T1R11XXXCTREPM' AND CIR3.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.DTWHNLIE CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_EDS_BNQ AND STR1.CDFORE = CAST(CIR4.CDVAL9 AS DECIMAL(2)) and CIR4.CDTABO = 'T1R11XXXCDFORE' AND CIR4.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_PART_TCO CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_EDS_BNQ AND STR1.IDPART = CIR5.ID_SOURCE1 ) LEFT JOIN %TCO%.ID_PART_TCO CIR6 ON (STR1.CD_EDS_BNQ = CIR6.CD_EDS_BNQ AND STR1.IDPART1= CIR6.ID_SOURCE1 )
TDSCK171                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.IDORDR2 AS IDORDR2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR2) AS VARCHAR(30)) AS IDORDR2 , STR1.FILLER235 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRC813                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDACT , STR1.CTACO , STR1.LMCOMC , STR1.DIACTI , STR1.NUMATR , STR1.IDELST , STR1.ZAC813 , STR1.ZPC813 , STR1.ZTEVER , STR1.IDCOV , STR1.IDECV , STR1.IDELCO , STR1.IDCCA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR_AGT,0) ID_DWR_AGT , COALESCE(CIR3.ID_DWR_EDS,0) ID_DWR_EDS , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR5 , CASE WHEN CIR6.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR6 , CASE WHEN CIR7.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR7 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_ACTN_CRED_COMPLEXE CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CTACO = CIR1.CT_ACTN AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.AGT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(CAST(CAST(STR1.NUMATR AS format 'Z(I)') AS format '9(5)') AS CHAR(7)) = CIR2.ID_AGT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ELT_DE_STRUCT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND SUBSTR(CAST(STR1.IDELST AS format 'Z(I)'),3,5) = CIR3.ID_EXT_EDS AND CIR3.ID_TYP_EDS<>'7' AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN ( SELECT S1.CD_BQE ,S1.ID_CTR_CADRE,FLAG_SITUA_ENREG, S1.DD_HISTO ,S1.DF_HISTO FROM (SELECT DISTINCT CD_BQE ,ID_CTR_CADRE ,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.CTR_CADRE where FLAG_SITUA_ENREG='2' UNION SELECT DISTINCT CD_BQE ,ID_CTR_CADRE ,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.CTR_CADRE where FLAG_SITUA_ENREG='2' ) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_CTR_CADRE ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 ) CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.IDCCA = CIR4.ID_CTR_CADRE AND CIR4.FLAG_SITUA_ENREG='2' AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN (SELECT S1.CD_BQE , ID_COVENANT,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO FROM (SELECT DISTINCT CD_BQE ,ID_COVENANT ,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.COVENANT where FLAG_SITUA_ENREG='2' UNION SELECT DISTINCT CD_BQE ,ID_COVENANT ,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.COVENANT where FLAG_SITUA_ENREG='2' ) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_COVENANT ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 ) CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE AND STR1.IDCOV = CIR5.ID_COVENANT AND CIR5.FLAG_SITUA_ENREG='2' AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE)) LEFT JOIN (SELECT S1.CD_BQE , ID_ELT_COVENANT,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO FROM (SELECT DISTINCT CD_BQE , ID_ELT_COVENANT ,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.ELT_COVENANT where FLAG_SITUA_ENREG='2' UNION SELECT DISTINCT CD_BQE , ID_ELT_COVENANT ,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.ELT_COVENANT where FLAG_SITUA_ENREG='2' ) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_ELT_COVENANT ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 ) CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_BQE AND STR1.IDECV = CIR6.ID_ELT_COVENANT AND CIR6.FLAG_SITUA_ENREG='2' AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT JOIN ( SELECT S1.CD_BQE ,S1.ID_CTR_CADRE,ID_EDC_CRED,FLAG_SITUA_ENREG, S1.DD_HISTO ,S1.DF_HISTO FROM (SELECT DISTINCT CD_BQE ,ID_CTR_CADRE ,ID_EDC_CRED ,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.CTR_CADRE_CTR_PRET where FLAG_SITUA_ENREG='2' UNION SELECT DISTINCT CD_BQE ,ID_CTR_CADRE ,ID_EDC_CRED ,FLAG_SITUA_ENREG ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.CTR_CADRE_CTR_PRET where FLAG_SITUA_ENREG='2' ) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_EDC_CRED ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 )CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_BQE AND STR1.IDELCO = CIR7.ID_EDC_CRED AND CIR7.FLAG_SITUA_ENREG='2' AND CAST(CIR7.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR7.DF_HISTO AS DATE))
OFR_MRCH                                          SELECT STR1.CD_EDS_BNQ , STR1.ID_MRCH , STR1.ID_OFR_BQR , STR1.CD_PERTINENCE , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.ID_MRCH is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.ID_OFR_BQR is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT ID_MRCH FROM %SOC%.MRCH ) CIR1 ON (STR1.ID_MRCH=CIR1.ID_MRCH) LEFT JOIN (Select DISTINCT ID_OFR_BQR FROM %SOC%.OFR) CIR2 ON (STR1.ID_OFR_BQR=CIR2.ID_OFR_BQR)
EDSHTEDS                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDTYED , STR1.LIBTEDS , STR1.DDVAL , STR1.DFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRCO_DU_RET_CREANCES                              SELECT STR1.IDSTU , STR1.DFCOLT , STR1.NTIER0 , STR1.CIDENV , STR1.IDPRET , STR1.CDREMO , STR1.CDCORB , STR1.CBPRRB , STR1.IDELCH , STR1.CETACR , STR1.CETATI , STR1.CBENDE , STR1.CDSTMC , STR1.CDSTMP , STR1.CDNIIG , STR1.CLACPO , STR1.TXPDE1 , STR1.NOTCP1 , STR1.KPONDE , STR1.MTEADW , STR1.MTEADZ , STR1.MTEADE , STR1.MTRWB1 , STR1.MTRWH1 , STR1.MTRWA1 , STR1.MTEXLB , STR1.MTEXLH , STR1.MTEXL , STR1.KFENP , STR1.TXLGD9 , STR1.TXCCF3 , STR1.MTEXLM , STR1.KOEDUR , STR1.MTEXLR , STR1.KOEREA , STR1.IDEXEY , STR1.DCARR7 , STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1 INNER JOIN (SELECT COUNT(DISTINCT GRCO.CDCORB) NB_CDCORB, GRCO.DCARR7, GRCO.IDEXEY FROM %BRL%.%ObjectNameFrom% GRCO WHERE GRCO.DCARR7 = '#FirstDayPreviousMonth#' AND GRCO.IDEXEY IN (#ListEntityToRun#) GROUP BY GRCO.DCARR7, GRCO.IDEXEY) CIR1 ON (STR1.DCARR7 = CIR1.DCARR7 AND STR1.IDEXEY = CIR1.IDEXEY)
DESCOM                                            SELECT DISTINCT S.CD_EDS_BNQ , S.IDNUPA BY_SOURCE1 , 'ADR' || CAST(%PMU%.Bin2Char(BY_SOURCE1) AS VARCHAR(33)) ID_SOURCE1 FROM %DTA%.DESCOM S
TYP_CLI_CIAL_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_AGT_ECON_BDF_CST                              SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
IARFKA16                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.IDBANC , STR1.CDDOMI , STR1.CDPROD , STR1.CDBUR1 , STR1.LNMARI , STR1.LNPRUS , STR1.DNAISA , STR1.CDDRTF , STR1.NCPTPA , STR1.CBSOU1 , STR1.CBSOU2 , STR1.CBSOU3 , STR1.CBSOU , STR1.CBSOU4 , STR1.CBSOU5 , STR1.KA10_IDCTRT , STR1.KA10_CDBURO , STR1.KA10_CDVEND , STR1.KA10_NUIMAG , STR1.KA10_CDFOIC , STR1.KA10_CPEFAC , STR1.KA10_CDSICT , STR1.KA10_DEDIMC , STR1.KA10_DEFIMC , STR1.KA10_DEDAFN , STR1.KA10_DECHC1 , STR1.KA10_DPRECH , STR1.KA10_DRESC1 , STR1.KA10_MOTRS1 , STR1.KA10_KMRM , STR1.KA10_CDMTCO , STR1.KA10_CDITRF , STR1.KA10_MTITRF , STR1.KA10_CDDTRF , STR1.KA10_CDDTR1 , STR1.KA10_KMDTRF , STR1.KA10_MTTAXE , STR1.KA10_MTCOMA , STR1.KA10_MTCOTI , STR1.KA10_CDAPPT , STR1.KA10_CBREPD , STR1.KA10_DERSPR , STR1.KA10_CDMORP , STR1.KA10_DADERS , STR1.KA10_DACRE , STR1.KA10_CTDOJA , STR1.KA10_CTDOJB , STR1.KA10_CTDOJC , STR1.KA10_CTDOJD , STR1.KA10_CTDOJE , STR1.KA10_CTDOJF , STR1.KA10_CBINDG , STR1.KA10_KFSUR , STR1.KA10_CDTOP1 , STR1.KA10_CDTOP2 , STR1.KA10_IDPERC , STR1.KA10_CDETAX , STR1.KA10_CDGBD1 , STR1.KA10_NCPTDF , STR1.KA10_CLRIBP , STR1.KA10_CDETA5 , STR1.KA10_CDBGD3 , STR1.KA10_NCPTDG , STR1.KA10_CLRIBI , STR1.KA10_DHECH1 , STR1.KA10_DAPASS , STR1.KA10_MTAAB1 , STR1.KA10_CDGAM , STR1.KA10_CBPOP , STR1.KA10_CDPCO , STR1.KA10_CSSITU , STR1.KA10_DATSUP , STR1.KA10_CDTIM , STR1.KA10_MTDRG , STR1.KA10_DDECH3 , STR1.KA10_CDINIT , STR1.KA10_CDVOP1 , STR1.KA10_IDBAN7 , STR1.KA10_IDPERD , STR1.KA10_NOVER4 , STR1.KA10_IDRFIN , STR1.KA10_IDRFI1 , STR1.KA10_CDNTU , STR1.KA10_IDBAN9 , STR1.KA10_IDRFI2 , STR1.KA10_CDNTU1 , STR1.KA10_IDBANA , STR1.KA10_IDRFI3 , STR1.KA10_CDNTU2 , STR1.KA10_CDNTU3 , STR1.KA10_CQAEAG , STR1.KA10_CDORCO , STR1.KA10_CTSOU1 , STR1.KA09_CBHST , STR1.KA09_IDCTRT , STR1.KA09_CTPRS0 , STR1.KA09_NBMV2 , STR1.KA09_MFRAID , STR1.KA09_CMEDI , STR1.KA09_IDTYOQ , STR1.KA09_CDPRCT , STR1.KA10_ZB014 , STR1.KA1A_IDCTRT , STR1.KA1A_NUIMAG , STR1.KA1A_CBSOU1 , STR1.KA1A_DADESS , STR1.KA1A_CTSOU2 , STR1.KA1A_CDTOP , STR1.KA1A_IDCTRH , STR1.KA1A_DGAREF , STR1.KA1A_CDMOCC , STR1.KA1A_IDCTRG , STR1.KA10_DASIEM , STR1.KA10_CDTOP3 , STR1.KA16_CDZTFG , STR1.KA16_NBAYD , STR1.KA16_NBASS , STR1.KA16_CDFIT , STR1.KA16_LNASS0 , STR1.KA16_IDBAN0_1 , STR1.KA16_IDPERS_1 , STR1.KA16_IDBAN1_1 , STR1.KA16_CBRTAS_1 , STR1.KA16_CDSEXE_1 , STR1.KA16_DNAISS_1 , STR1.KA16_KMRM2_1 , STR1.KA16_CBCSPA_1 , STR1.KA16_IDBAN0_2 , STR1.KA16_IDPERS_2 , STR1.KA16_IDBAN1_2 , STR1.KA16_CBRTAS_2 , STR1.KA16_CDSEXE_2 , STR1.KA16_DNAISS_2 , STR1.KA16_KMRM2_2 , STR1.KA16_CBCSPA_2 , STR1.KA16_IDPERA_1 , STR1.KA16_IDBAN3_1 , STR1.KA16_CTRAT_1 , STR1.KA16_CCPAR_1 , STR1.KA16_CDSEX1_1 , STR1.KA16_DANAI4_1 , STR1.KA16_CDRAF_1 , STR1.KA16_CORAF_1 , STR1.KA16_CDPCS_1 , STR1.KA16_KMRM0_1 , STR1.KA16_CBCSPA1_1 , STR1.KA16_CTSOU1_1 , STR1.KA16_DDSOU7_1 , STR1.KA16_CBPAB_1 , STR1.KA16_IDPERA_2 , STR1.KA16_IDBAN3_2 , STR1.KA16_CTRAT_2 , STR1.KA16_CCPAR_2 , STR1.KA16_CDSEX1_2 , STR1.KA16_DANAI4_2 , STR1.KA16_CDRAF_2 , STR1.KA16_CORAF_2 , STR1.KA16_CDPCS_2 , STR1.KA16_KMRM0_2 , STR1.KA16_CBCSPA1_2 , STR1.KA16_CTSOU1_2 , STR1.KA16_DDSOU7_2 , STR1.KA16_CBPAB_2 , STR1.KA16_IDPERA_3 , STR1.KA16_IDBAN3_3 , STR1.KA16_CTRAT_3 , STR1.KA16_CCPAR_3 , STR1.KA16_CDSEX1_3 , STR1.KA16_DANAI4_3 , STR1.KA16_CDRAF_3 , STR1.KA16_CORAF_3 , STR1.KA16_CDPCS_3 , STR1.KA16_KMRM0_3 , STR1.KA16_CBCSPA1_3 , STR1.KA16_CTSOU1_3 , STR1.KA16_DDSOU7_3 , STR1.KA16_CBPAB_3 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_CTR_IARD , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.KA10_IDCTRT=TCO1.ID_SOURCE1)
ADREML                                            SELECT STR1.CD_EDS_BNQ , STR1.IDADEM AS IDADEM_BYTE , CAST(substr(COALESCE(TCO1.ID_SOURCE1, ' '),4,30) AS VARCHAR(30)) AS IDADEM , STR1.LIEML , STR1.IDNUPA AS IDNUPA_BYTE , CAST(%PMU%.Bin2Char(IDNUPA) AS VARCHAR(30)) AS IDNUPA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_COORD , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_COORD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDADEM=TCO1.BY_SOURCE1 and 'CNL'= substr(TCO1.ID_SOURCE1,1,3))
SERVIC                                            SELECT STR1.CD_EDS_BNQ , STR1.IDSERV , STR1.LISERV , STR1.LIASUS , STR1.DDVESE , STR1.DFVESE , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.IDCD2R , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
SECUCPTE                                          SELECT STR1.CD_EDS_BNQ , IDELCO IDELCO_BYTE , CAST(%PMU%.Bin2Char(IDELCO) AS VARCHAR(30)) AS IDELCO , CAST(%PMU%.Bin2Char(IDELCO) AS VARCHAR(30)) || 'ECD' AS IDELCOECD ,CIR1.ID_DWR as ID_DWR_EDC , CPRTT , DSOUSCTR , DDMDRSL , case when MOTRSL is null then cast( '00' as decimal(2,0)) else MOTRSL end as MOTRSL , DECHCCTR , DGSTCOTS , MTCOTS , MTTVACOT , RISTTC , DRIS , DGSTRSL , MTEXT , MTTVAEXT , BADHS , ADHSCTRA , BLNT , RE_CYCLE , DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION ,Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End as ROW_FOUND_CIR1 ,Case When CIR2.CD_BQE is null then 0 else 1 End as ROW_FOUND_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 left join %TCO%.ID_EDC_TCO CIR1 on (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND CAST(%PMU%.Bin2Char(IDELCO) AS VARCHAR(30)) || 'ECD'= CIR1.ID_SOURCE1) left join %SOC%.TYP_MTF_RESIL CIR2 on (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.MOTRSL=CIR2.CT_MTF_RESIL and STR1.MOTRSL is not null )
T1R23                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDENTR IDENTR_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDENTR) end AS VARCHAR(30)) AS IDENTR , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_ENTR , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , COALESCE(CIR3.CT_PART,'') CT_PART , COALESCE(CIR4.ID_DWR,0) ID_DWR_PERSON , COALESCE(CIR5.CTPART,' ') CT_PART_PARTEN , COALESCE(CIR6.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR6 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_ENTR_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDENTR=CIR1.BY_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART=CIR2.ID_SOURCE1) LEFT JOIN %SOC%.PART CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDPART=CIR3.ID_PART AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_PERSON_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND STR1.IDPART=CIR4.ID_SOURCE1) LEFT JOIN %DE1%.PARTEN CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ AND STR1.IDPART=CIR5.IDPART AND CIR5.TK_ACTION IN('I','U')) LEFT JOIN %DE1%.DTWHNLIE CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_EDS_BNQ AND CIR6.CDTABO = 'T1R23'AND CIR6.TK_ACTION IN('I','U'))
IARFKA40                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , CIR1.ID_DWR_CTR_IARD , STR1.IDBANC , STR1.CDDOMI , STR1.CDPROD , STR1.CDBUR1 , STR1.LNMARI , STR1.LNPRUS , STR1.DNAISA , STR1.CDDRTF , STR1.NCPTPA , STR1.CBSOU1 , STR1.CBSOU2 , STR1.CBSOU3 , STR1.CBSOU , STR1.CBSOU4 , STR1.CBSOU5 , STR1.FILLERA , STR1.KA40_IDSINI , STR1.FILLERB , STR1.KA40_CDBURO , STR1.KA40_IDCTRT , STR1.KA40_NUIMAG , STR1.KA40_CDFOIC , STR1.KA40_CDXTUG , STR1.KA40_DATMAJ , STR1.KA40_DDSINI , STR1.KA40_DESINI , STR1.KA40_DFSINI , STR1.KA40_CDETSI , STR1.KA40_MTCTSI , STR1.KA40_QORCAS , STR1.KA40_CDINSI , STR1.KA40_DATRSI , STR1.KA40_CBCLTM , STR1.KA40_IDBAN8 , STR1.KA40_CDVOP , STR1.FILLERC , STR1.KA41_CDGASIA , STR1.KA41_CDGASIB , STR1.KA41_CDGASIC , STR1.KA41_CDGASID , STR1.KA41_CDGASIE , STR1.FILLERD , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End as ROW_FOUND_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End as ROW_FOUND_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ASSU_IARD_MENS CIR1 on (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.KA40_IDCTRT = CIR1.ID_CTR_IARD AND CAST(CIR1.DD_HISTO AS DATE) <= TD_MONTH_END(STR1.DT_ELIG) AND TD_MONTH_END(STR1.DT_ELIG) < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_DOMN_IARD CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.CDDOMI = CIR2.CD_DOMN_IARD) WHERE 1=1 and ( (CIR1.DT_RESIL='9999-12-31' or CIR1.DT_RESIL> STR1.DT_ELIG) and ( CIR1.DF_EFFT_IMGCTR_IARD='9999-12-31' or CIR1.DF_EFFT_IMGCTR_IARD> STR1.DT_ELIG) )
ETABL                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.NOSIRE , STR1.CCETAB , STR1.LIENTA , STR1.DAPIET , STR1.QTEFFE , STR1.MTCAFT , STR1.DFEXPL , STR1.NOMEXA , STR1.CDPAYS , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.IDTVA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_ETS_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ and STR1.IDPART=TCO1.ID_SOURCE1)
TYP_SAV_CST                                       SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_SERV_FACTN_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRCO_TIERS                                        SELECT STR1.IDEXEY , STR1.DFCOLT , STR1.IDPOCE , STR1.ISEGN , STR1.IDPOBT , STR1.CDACTN , STR1.DCARR7 , STR1.CDMC4 , STR1.NTIER0 , STR1.CCONTR , STR1.NOSIR4 FROM %BRL%.%ObjectNameFrom% STR1
TYP_CD_THEME_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_REGRP_AGT_ECON_BDF_CST                        SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
CLCXS006                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPART , STR1.CTPCC , STR1.LNCLC1 , STR1.IDTCC , STR1.CPPROS , STR1.CTPART , STR1.CTGPPE , STR1.CDFOR9 , STR1.CDFOR9_2 , STR1.ZB001 , STR1.ZB001A , STR1.ZB001B , STR1.CTYLJA , STR1.CTYLJE , STR1.CTINCD , STR1.MAPPOR , STR1.MTCASO , STR1.IDCLC_2 , STR1.IDPART_2 , STR1.CTPCC_2 , STR1.LNCLC1_2 , STR1.IDTCC_2 , STR1.CPPROS_2 , STR1.CTPART_2 , STR1.CTGPPE_2 , STR1.FILLER , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.CQLCCP CD_NATU_LIEN_CLI_CIAL , CIR2.CQLCCP CD_NATU_LIEN_CLI_CIAL_LIE , CIR3.CQLCCP CD_NATU_LIEN_MNDT , CIR4.CQLCCP CD_NATU_LIEN_JUR , CIR5.CQLCCR CD_NATU_LIEN_JUR_ENFT , CIR6.CQLCCP CD_NATU_LIEN_RPRSTN_PHSQ , CIR7.CQLCCR CD_NATU_LIEN_RPRSTN_MOR , COALESCE(CIR8.ID_DWR,0) ID_DWR_PART , COALESCE(CIR9.ID_DWR,0) ID_DWR_CLI_CIAL , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR6 , Case When CIR7.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR7 , Case When CIR8.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR8 , Case When CIR9.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR9 FROM %DTA%.CLCXS006 STR1 LEFT JOIN %DE1%.DTWHNLIE CIR1 ON (TRIM(CIR1.CDTABO) = 'DGCZ18XXCTPCC' AND STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.CTPCC = CIR1.CDVAL9 AND CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.DTWHNLIE CIR2 ON (TRIM(CIR2.CDTABO) = 'DGCZ18XXCTPCC' AND STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.CTPCC_2= CIR2.CDVAL9 AND CIR2.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (TRIM(CIR3.CDTABO) = 'C1RE34XXCTINCT' AND STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.CTINCD = CIR3.CDVAL9 AND CIR3.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.DTWHNLIE CIR4 ON (TRIM(CIR4.CDTABO) = 'T1R10XXXCTYLJU' AND STR1.CD_EDS_BNQ = CIR4.CD_EDS_BNQ AND STR1.CTYLJA = CIR4.CDVAL9 AND CIR4.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.DTWHNLIE CIR5 ON (TRIM(CIR5.CDTABO) = 'T1R10XXXCTYLJU' AND STR1.CD_EDS_BNQ = CIR5.CD_EDS_BNQ AND STR1.CTYLJE = CIR5.CDVAL9 AND CIR5.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.DTWHNLIE CIR6 ON (TRIM(CIR6.CDTABO) = 'T1R11XXXCDFORE' AND STR1.CD_EDS_BNQ = CIR6.CD_EDS_BNQ AND STR1.CDFOR9 = CIR6.CDVAL9 AND CIR6.TK_ACTION IN ('I','U')) LEFT JOIN %DE1%.DTWHNLIE CIR7 ON (TRIM(CIR7.CDTABO) = 'T1R11XXXCDFORE' AND STR1.CD_EDS_BNQ = CIR7.CD_EDS_BNQ AND STR1.CDFOR9_2=CIR7.CDVAL9 AND CIR7.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_PART_TCO CIR8 ON (STR1.CD_EDS_BNQ = CIR8.CD_EDS_BNQ AND Trim(STR1.IDPART)= Trim(CIR8.ID_SOURCE1)) LEFT JOIN %TCO%.ID_CLI_CIAL_TCO CIR9 ON (STR1.CD_EDS_BNQ = CIR9.CD_EDS_BNQ AND Trim(STR1.IDCLC) = Trim(CIR9.ID_SOURCE1))
C1RE69                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDQUEX , STR1.DDVALK , STR1.DTREVP , STR1.CQQEX , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR3.ID_DWR,0) AS ID_DWR_PART , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_STATU_MIF CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CQQEX = CIR1.CD_STATU__MIF AND CAST(CIR1.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %DE1%.TQUAEX CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDQUEX = CIR2.IDQUEX) LEFT JOIN %TCO%.ID_PART_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDPART=CIR3.ID_SOURCE1)
HISDAV                                            SELECT STR1.CD_EDS_BNQ , STR1.NPART1 , STR1.DASTD , STR1.IDELCO IDELCO_BYTE , COALESCE(%PMU%.Bin2Char (STR1.IDELCO),'') AS IDELCO_SOURCE , COALESCE(TCO1.ID_SOURCE1,'') AS IDELCO , STR1.MFLUXE , STR1.MFLUXF , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(CIR1.NU_CPTE,0) NU_CPTE , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , CIR1.DD_HISTO , CIR1.DF_HISTO FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT DISTINCT CD_EDS_BNQ,BY_SOURCE1,CAST(ID_SOURCE1 AS VARCHAR(30)) ID_SOURCE1 FROM %TCO%.ID_EDC_TCO) TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1) LEFT OUTER JOIN (%SOC%.ACCL_CTR_ECD CIR1 JOIN %SOC%.ACCL_PROD APROD ON (CIR1.CD_PROD_CIAL = APROD.CD_PROD_CIAL AND APROD.DF_HISTO = CAST('9999-12-31 00:00:00' AS TIMESTAMP(0) FORMAT 'YYYY-MM-DDBHH:MI:SS') AND (APROD.CD_FAM_PROD_1 = 'RGP10001' OR APROD.CD_FAM_PROD_2 = 'RGP10001' OR APROD.CD_FAM_PROD_3 = 'RGP10001' OR APROD.CD_FAM_PROD_4 = 'RGP10001' OR APROD.CD_FAM_PROD_5 = 'RGP10001' OR APROD.CD_FAM_PROD_6 = 'RGP10001' OR APROD.CD_FAM_PROD_7 = 'RGP10001' OR APROD.CD_FAM_PROD_8 = 'RGP10001' OR APROD.CD_FAM_PROD_9 = 'RGP10001' OR APROD.CD_FAM_PROD_10 = 'RGP10001')) ) ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and CAST(TCO1.ID_SOURCE1 AS VARCHAR(30))=CIR1.ID_EDC_VEGA AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
OPENCT                                            SELECT STR1.CD_EDS_BNQ , STR1.IPART1 , STR1.NORIB , STR1.CATTE , STR1.CPRSP , STR1.CDACCO , STR1.CSITUA , STR1.CMRGLT , STR1.CEXSIN , STR1.JECHE1 , STR1.DPROD1 , STR1.DTRSI1 , STR1.MKATT1 , STR1.MKDIS1 , STR1.CDCMAK , STR1.CTARIF , STR1.DADMAJ , STR1.NCPTE , STR1.CDRSI2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(CIR4.IDELCO) end AS VARCHAR(30)) AS IDELCO , TCO1.ID_DWR ID_DWR_EDC_ECD , CASE WHEN TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , COALESCE(CIR2W.CD_DOMN_INTVTN ,CIR2S.CD_DOMN_INTVTN ) CD_DOMN_INTVTN , COALESCE(CIR2W.CD_SOCIETARIAT_CRED ,CIR2S.CD_SOCIETARIAT_CRED ) CD_SOCIETARIAT_CRED , COALESCE(CIR2W.CD_BIEN_FINANCE ,CIR2S.CD_BIEN_FINANCE ) CD_BIEN_FINANCE , COALESCE(CIR2W.CD_DESTN_FINCT ,CIR2S.CD_DESTN_FINCT ) CD_DESTN_FINCT , COALESCE(CIR2W.CD_CATG_PRET ,CIR2S.CD_CATG_PRET ) CD_CATG_PRET , COALESCE(CIR2W.CD_CATG_FINCT ,CIR2S.CD_CATG_FINCT ) CD_CATG_FINCT , COALESCE(CIR2W.CD_COMPLEMENTARITE ,CIR2S.CD_COMPLEMENTARITE ) CD_COMPLEMENTARITE , COALESCE(CIR2W.CD_TECHN_CRED_NOYAU_PRET,CIR2S.CD_TECHN_CRED_NOYAU_PRET) CD_TECHN_CRED_NOYAU_PRET , COALESCE(CIR2W.CT_LOI_AMRTSM ,CIR2S.CT_LOI_AMRTSM ) CT_LOI_AMRTSM , COALESCE(CIR2W.CD_PRIOD_RBT ,CIR2S.CD_PRIOD_RBT ) CD_PRIOD_RBT , COALESCE(CIR2W.DD_AMRTSM ,CIR2S.DD_AMRTSM ) DD_AMRTSM , COALESCE(CIR2W.DT_DER_ECHCE_THRQ ,CIR2S.DT_DER_ECHCE_THRQ ) DT_DER_ECHCE_THRQ , COALESCE(CIR2W.DT_SIGNER_CTR_CRED ,CIR2S.DT_SIGNER_CTR_CRED ) DT_SIGNER_CTR_CRED , COALESCE(CIR2W.TX_CRED ,CIR2S.TX_CRED ) TX_CRED , COALESCE(CIR2W.CD_NATU_TAUX ,CIR2S.CD_NATU_TAUX ) CD_NATU_TAUX , COALESCE(CIR2W.NU_OPERATION_NATIONAL ,CIR2S.NU_OPERATION_NATIONAL ) NU_OPERATION_NATIONAL , COALESCE(CIR2W.NU_PRET ,CIR2S.NU_PRET ) NU_PRET , COALESCE(CIR2W.CLE_ID_NATIONAL ,CIR2S.CLE_ID_NATIONAL ) CLE_ID_NATIONAL , COALESCE(CIR2W.CD_DEVIS_ISO ,CIR2S.CD_DEVIS_ISO ) CD_DEVIS_ISO , COALESCE(CIR2W.LIEU_INVESTISSEMENT ,CIR2S.LIEU_INVESTISSEMENT ) LIEU_INVESTISSEMENT , COALESCE(CIR2W.ID_DWR_AGT ,CIR2S.ID_DWR_AGT ) ID_DWR_AGT , COALESCE(CIR2W.DUR_INITL_PRET ,CIR2S.DUR_INITL_PRET ) DUR_INITL_PRET , COALESCE(CIR2W.DT_PROCH_REVIS ,CIR2S.DT_PROCH_REVIS ) DT_PROCH_REVIS , COALESCE(CIR2W.DT_DECHCE_TERME ,CIR2S.DT_DECHCE_TERME ) DT_DECHCE_TERME , COALESCE(CIR2W.CD_DTX_LTGX ,CIR2S.CD_DTX_LTGX ) CD_DTX_LTGX , CASE WHEN COALESCE(CIR2W.CD_BQE,CIR2S.CD_BQE) is null then 0 else 1 End Row_Found_CIR2 , CASE WHEN CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , CIR3.R6 , CIR3.SumMTMEN1 , CIR3.SumMTNEC1 , CIR3.SumMTEIK1 , CASE WHEN CIR3.CTPLAN=1 then 1 else 0 End CTPLAN , COALESCE(CIR2W.DT_EMISSON_OFR_CRED ,CIR2S.DT_EMISSON_OFR_CRED ) DT_EMISSON_OFR_CRED , COALESCE(CIR2W.DT_RCPTN_OFR_CRED_GED ,CIR2S.DT_RCPTN_OFR_CRED_GED ) DT_RCPTN_OFR_CRED_GED , COALESCE(CIR2W.DT_TRT_REALN_CRED ,CIR2S.DT_TRT_REALN_CRED ) DT_TRT_REALN_CRED , COALESCE(CIR2W.DT_DECI_AP ,CIR2S.DT_DECI_AP ) DT_DECI_AP , 0 CD_SOLTN_HAB , '-1' CD_DEPT_INVSTMNT FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN ( SELECT CD_EDS_BNQ ,IPART1 ,IDELCO FROM %DE1%.OPENEL WHERE TK_ACTION in ('I','U') QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_EDS_BNQ,IPART1 ORDER BY CD_EDS_BNQ,IPART1,DFLIEN DESC ,DELIEN DESC )=1 ) CIR4 ON (CIR4.IPART1=STR1.IPART1 AND CIR4.CD_EDS_BNQ =STR1.CD_EDS_BNQ) LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (CIR4.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND CIR4.IDELCO= TCO1.BY_SOURCE1 AND substr(TCO1.ID_SOURCE1, character(TCO1.ID_SOURCE1)-2)='ECD') LEFT JOIN %SOC%.CRED CIR2S ON ( CIR2S.ID_DWR_EDC=TCO1.ID_DWR AND CIR2S.CD_BQE=TCO1.CD_EDS_BNQ AND CAST(CIR2S.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2S.DF_HISTO AS DATE) ) LEFT JOIN ( SELECT DISTINCT CD_BQE ,ID_DWR_EDC ,DD_HISTO ,DF_HISTO ,CD_DOMN_INTVTN ,CD_SOCIETARIAT_CRED ,CD_BIEN_FINANCE ,CD_DESTN_FINCT ,CD_CATG_PRET ,CD_CATG_FINCT ,CD_COMPLEMENTARITE ,CD_TECHN_CRED_NOYAU_PRET ,CT_LOI_AMRTSM ,CD_PRIOD_RBT ,DD_AMRTSM ,DT_DER_ECHCE_THRQ ,DT_SIGNER_CTR_CRED ,TX_CRED ,CD_NATU_TAUX ,NU_OPERATION_NATIONAL ,NU_PRET ,CLE_ID_NATIONAL ,CD_DEVIS_ISO ,LIEU_INVESTISSEMENT ,ID_DWR_AGT ,DUR_INITL_PRET ,DT_PROCH_REVIS ,DT_DECHCE_TERME ,CD_DTX_LTGX ,DT_EMISSON_OFR_CRED ,DT_RCPTN_OFR_CRED_GED ,DT_TRT_REALN_CRED ,DT_DECI_AP FROM %WRK%.CRED QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_BQE,ID_DWR_EDC ORDER BY DD_HISTO DESC,DF_HISTO DESC)=1 ) CIR2W ON ( CIR2W.ID_DWR_EDC=TCO1.ID_DWR AND CIR2W.CD_BQE=TCO1.CD_EDS_BNQ AND CAST(CIR2W.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2W.DF_HISTO AS DATE) ) LEFT JOIN (SELECT CD_EDS_BNQ ,IPART1 ,MAX(CASE WHEN CTPLAN='P' THEN 1 ELSE 0 END ) AS CTPLAN , SUM(CASE WHEN MTNEC1 >0 THEN MTMEN1 ELSE 0 END ) as R6 ,sum( CASE WHEN MTNEC1 >0 OR MTEIK1>0 THEN MTMEN1 ELSE 0 END) as SumMTMEN1 ,sum(MTNEC1) as SumMTNEC1 ,sum(MTEIK1) as SumMTEIK1 FROM %DE1%.OPENPF WHERE TK_ACTION in ('I','U') GROUP BY CD_EDS_BNQ,IPART1 ) CIR3 ON (CIR3.IPART1=STR1.IPART1 AND CIR3.CD_EDS_BNQ =STR1.CD_EDS_BNQ)
CRMINCOF                                          SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.NOREG , CAST(COALESCE(CIR1.CD_OFFER_UNICA, '-1') AS CHAR(10)) CDOFFR , STR1.DDVALA , STR1.DADMAA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.OFFER_UNICA CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE and STR1.CDOFFR = CIR1.CD_OFFER_UNICA AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
EDSNFONC                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IFONC5 , STR1.LFONCN , STR1.DDVAL , STR1.DFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TDSCAUTR                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , CASE WHEN (TO_NUMBER(STR1.CDBCF)) IS NULL THEN 0 ELSE STR1.CDBCF END AS CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.FILLER250 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
DGXH16                                            SELECT STR1.CD_EDS_BNQ , STR1.IDRES , STR1.IDVBL , STR1.QTVBR , STR1.MTVBR , STR1.CPRES , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.RESULTAT CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDRES= CIR1.ID_RESULTAT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
TDSCK107                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.DTDERM , STR1.QCCHQ , STR1.NCHQ , STR1.NREM , STR1.CORIG , STR1.REFEXT , STR1.NOMIF9 , STR1.DTARCH , STR1.FILLER175 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
GRCO_DU_TRANCHE_CORP                              SELECT STR1.CD_EDS_BNQ , STR1.IDSTU , STR1.DANOT2 , STR1.DFCOLT , STR1.NTIER0 , STR1.CIDENV , STR1.CDCORB , STR1.CIDTRA , STR1.IDPRET , STR1.NUTRCR , STR1.CDREMO , STR1.CBPRRB , STR1.CBENDE , STR1.IDELCH AS IDELCH_BYTE , CAST(%PMU%.Bin2Char(IDELCH) AS VARCHAR(46)) AS IDELCH , STR1.MTIGTA , STR1.MTTRAD , STR1.MTEXP , STR1.MTECDO , STR1.TXLGD9 , STR1.TXLGD8 , STR1.MTEADW , STR1.MTEADZ , STR1.MTEADE , STR1.TXPDE6 , STR1.VPRODE , STR1.KFCOR1 , STR1.KPOND1 , STR1.MTRWB1 , STR1.MTRWH1 , STR1.MTRWA1 , STR1.MTEXLB , STR1.MTEXLH , STR1.MTEXL , STR1.CLACPO , STR1.CBPNUT , STR1.TXCCF3 , STR1.CBBHB , STR1.CIDENM , STR1.IDGARP , STR1.TYSURE , STR1.MGGARR , STR1.CIDSUR , STR1.IDGAR3 , STR1.CDGARP , STR1.MGARPE , STR1.CDNIGP , STR1.CBPCSU , STR1.CBPCGA , STR1.CBPON0 , STR1.CBTCVA , STR1.KPONGA , STR1.CDMPOT , STR1.CDECTR , STR1.CBTCAP , STR1.KCHFP , STR1.MTCVV1 , STR1.MTCVV2 , STR1.DCARR7 , STR1.ZCNUFD , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , STR1.IDPRET || CAST (STR1.NUTRCR AS VARCHAR(10)) AS CDJ , TCO1.ID_DWR AS ID_DWR_TRCH_BDE , TCO2.ID_DWR AS ID_DWR_CREANC_EXPOSE_TCO , CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_TCO1 , CASE WHEN TCO2.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_TCO2 , CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_TRCH_BDE_TCO TCO1 ON(STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND CDJ =TCO1.ID_SOURCE1) LEFT JOIN ( SELECT CD_EDS_BNQ, DD_PE, ID_SOURCE1, ID_DWR FROM %TCO%.ID_CREANCE_EXPO_TCO TCO2 INNER JOIN %SOC%.CREANC_EXPOSE_MENS CIR1 ON ( TCO2.CD_EDS_BNQ = CIR1.CD_BQE AND TCO2.ID_DWR = CIR1.ID_DWR_CREANC_EXPOSE) ) TCO2 ON ( STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.IDPRET = TCO2.ID_SOURCE1) AND (TCO2.DD_PE = CAST(TD_MONTH_BEGIN(ADD_MONTHS (STR1.DT_ELIG,-1)) AS DATE)) LEFT JOIN %SOC%.TYP_CAP CIR2 ON ( STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.CLACPO = CIR2.CD_CAP AND CIR2.DD_HISTO <= TD_MONTH_END(ADD_MONTHS (STR1.DT_ELIG,-1))AND TD_MONTH_END(ADD_MONTHS (STR1.DT_ELIG,-1)) < CIR2.DF_HISTO)
GRA001                                            Select S.CD_EDS_BNQ, S.GRA001_IDELCO||'0' ID_SOURCE1, CAST(NULL AS BYTE(15)) AS BY_SOURCE1 FROM %DTA%.GRA001 S INNER JOIN %DE1%.GRA610 CIR1 ON (S.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND S.GRA001_IDELCO = CIR1.GRA610_IDELCO AND CIR1.TK_ACTION in ('I','U')) INNER JOIN %DE1%.GRA606 CIR2 ON (CIR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND CIR1.GRA610_IDLIMI = CIR2.GRA606_IDLIMI AND CIR2.TK_ACTION in ('I','U')) INNER JOIN %DE1%.E2R19G CIR3 ON (CIR2.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND CIR2.GRA606_IDELCO = CIR3.IDELC2 AND CIR3.TK_ACTION in ('I','U')) INNER JOIN %SOC%.ECD_DETENU CIR4 ON (CIR2.CD_EDS_BNQ=CIR4.CD_BQE AND CIR2.GRA606_IDELCO=CIR4.ID_EDC_CRED AND CAST(CIR4.DD_HISTO AS DATE)<=S.DT_ELIG AND S.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE) AND CIR4.ID_EDC_CRED IS NOT NULL) WHERE CIR3.CDDOM3 = 'LI' AND CIR2.CTLIMI in(4, 8)
DGXG52                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDCAD , STR1.IDSCA , STR1.IDCAD1 , STR1.IDSCA1 , STR1.IDCAD2 , STR1.IDSCA2 , STR1.MTCAL4 , STR1.MTCAL5 , STR1.MTCAL6 , STR1.IDSGM , STR1.MTCALA , STR1.MTCALB , STR1.MTCALC , STR1.MTCALD , STR1.MTCALE , STR1.MTCALF , STR1.MTCALG , STR1.MTCALH , STR1.MTCALI , STR1.MTCALJ , STR1.MTCALK , STR1.MTCALL , STR1.MTCALM , STR1.MTCALN , STR1.MTCALO , STR1.MTCALP , STR1.MTCALQ , STR1.MTCALR , STR1.MTCALS , STR1.MTCALT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CLI_CIAL , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.DGXG52 STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCLC= TCO1.ID_SOURCE1)
EXCAGECO                                          SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.ZN004Y , STR1.ZB001 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1)
TYP_METHD_NOTATN_GRP_CST                          SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_ISSU_CMPOS_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYP_OPERN_FINC_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRC560                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPRJT , STR1.MTPRJT , STR1.MTPRD3 , STR1.CQPRJ3 , STR1.CTBIPR , STR1.CTOBFI , STR1.CDDTLB , STR1.CDUSB1 , STR1.CDNFA2 , STR1.LLPRJT , STR1.DDPRJT , STR1.CTDFIN , STR1.CDAGP2 , STR1.NUMATR , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 ,CAST(CAST(CAST(STR1.CDAGP2 AS format 'Z(I)') AS format '9(5)') AS CHAR(7) ) AS ID_AGT_PRODTR ,COALESCE(CIR2.ID_DWR_AGT,-1) AS ID_DWR_AGT_PRODTR ,CAST(CAST(CAST(STR1.NUMATR AS format 'Z(I)') AS format '9(5)') AS CHAR(7) ) AS ID_AGT_INSTRCTR ,COALESCE(CIR3.ID_DWR_AGT,-1) AS ID_DWR_AGT_INSTRCTR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_TYP_DESTN_FINCT CIR1 ON (STR1.CD_EDS_BNQ =CIR1.CD_BQE and STR1.CTDFIN=CIR1.CT_DESTN_FINCT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.AGT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(CAST(CAST(STR1.CDAGP2 AS format 'Z(I)') AS format '9(5)') AS CHAR(7))=CIR2.ID_AGT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.AGT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND CAST(CAST(CAST(STR1.NUMATR AS format 'Z(I)') AS format '9(5)') AS CHAR(7))=CIR3.ID_AGT AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
GRA004                                            SELECT DISTINCT CD_EDS_BNQ , STR1.GRA004_IDELCO , STR1.NUECEL , STR1.DHEXPR , STR1.CTECHE , STR1.NOECPR , STR1.CPECHE , STR1.DKECHE , STR1.CDRPEC , STR1.DFACPR , STR1.DATOPE , STR1.DVECHE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.NU_ORDR_ECHCE=STR1.NOECPR THEN CIR1.ID_DWR_PLFD_UTIL WHEN CIR1.NU_ORDR_ECHCE=0 THEN CIR1.ID_DWR_PLFD_UTIL ELSE 0 END ID_DWR_PLFD_UTIL , Case When CIR1.CD_BQE IS NULL then 0 else 1 End Row_Found_CIR1 , COALESCE(CIR2.ID_DWR_EDC,0) ID_DWR_EDC_ECD , Case When CIR2.CD_BQE IS NULL then 0 else 1 End Row_Found_CIR2 , COALESCE(CIR3.ID_DWR_EDC,0) ID_DWR_EDC_CRED , Case When CIR3.CD_BQE IS NULL then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_BQE, ID_EDC_ECHCE,NU_ORDR_ECHCE,ID_DWR_PLFD_UTIL FROM %SOC%.PLFD_UTIL WHERE ID_EDC_ECHCE IS NOT NULL ) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.GRA004_IDELCO=CIR1.ID_EDC_ECHCE AND (CIR1.NU_ORDR_ECHCE=STR1.NOECPR OR CIR1.NU_ORDR_ECHCE=0)) LEFT JOIN (SELECT DISTINCT CD_BQE, ID_EDC_CRED,ID_DWR_EDC FROM %SOC%.ECD_DETENU WHERE ID_EDC_CRED IS NOT NULL ) CIR2 ON (CIR1.CD_BQE=CIR2.CD_BQE AND CIR1.ID_EDC_ECHCE=CIR2.ID_EDC_CRED) LEFT JOIN (SELECT DISTINCT CD_BQE,ID_EDC_CRED,ID_DWR_EDC FROM %SOC%.CRED WHERE ID_EDC_CRED IS NOT NULL AND TYP_SOURCE_CRED = 'G' ) CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.GRA004_IDELCO=CIR3.ID_EDC_CRED)
TYP_MTF_ENTREE_DFT_CST                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ADRINT                                            SELECT STR1.CD_EDS_BNQ , STR1.IADRES IADRES_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then COALESCE(SUBSTR(CIR1.ID_SOURCE1,4),' ') else %PMU%.Bin2Char(STR1.IADRES) end AS VARCHAR(30)) AS IADRES , STR1.LIEML , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(ID_DWR,0) ID_DWR_COORD , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_COORD_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IADRES=CIR1.BY_SOURCE1 AND SUBSTR(CIR1.ID_SOURCE1,1,3)='MEL')
COCL_EDP_HRS_CR                                   SELECT STR1.CD_EDS_BNQ , STR1.ID_STRUCT_CONSO , STR1.ID_TECHN_EDP_GR_HRS_CR , STR1.ID_TECHN_CONSO , STR1.CD_FAM_PROD_COMCIAL , STR1.CD_CNCRNT_EDP_GR_HRS_CR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CONSO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.ID_TECHN_CONSO=CIR1.ID_TK_CONSO AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.FAM_PROD CIR2 ON (STR1.CD_FAM_PROD_COMCIAL=CIR2.CD_FAM_PROD AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) AND CIR2.CD_BQE=99900) LEFT JOIN %SOC%.ETS_FINC_CONC CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CD_CNCRNT_EDP_GR_HRS_CR=CIR3.CD_ETS_CONC AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
BMOSOFI                                           SELECT STR1.CD_EDS_BNQ , STR1.DATTRT , STR1.DATARR , STR1.IDCLI , STR1.FILLER_2 , STR1.CODECR , STR1.IDPERS , STR1.FILLER_3 , STR1.PERLIE , STR1.FILLER_4 , STR1.RVTYPO , STR1.RVRISQ , STR1.RVAPPE , STR1.RVTARI , STR1.RVMONT , STR1.RVSEGM , STR1.RVSCOR , STR1.RVSCOA , STR1.RVIDOP , STR1.PATYP1 , STR1.PARIS1 , STR1.PAAPP1 , STR1.PATAR1 , STR1.PAM121 , STR1.PAM241 , STR1.PAM361 , STR1.PAM481 , STR1.PAM601 , STR1.PAM721 , STR1.PASEG1 , STR1.PASCO1 , STR1.PASCA1 , STR1.PAFIL1 , STR1.PATYP2 , STR1.PARIS2 , STR1.PAAPP2 , STR1.PATAR2 , STR1.PAM122 , STR1.PAM242 , STR1.PAM362 , STR1.PAM482 , STR1.PAM602 , STR1.PAM722 , STR1.PASEG2 , STR1.PASCO2 , STR1.PASCA2 , STR1.PAFIL2 , STR1.PATYP3 , STR1.PARIS3 , STR1.PAAPP3 , STR1.PATAR3 , STR1.PAM123 , STR1.PAM243 , STR1.PAM363 , STR1.PAM483 , STR1.PAM603 , STR1.PAM723 , STR1.PASEG3 , STR1.PASCO3 , STR1.PASCA3 , STR1.PAFIL3 , STR1.REJET , STR1.FILLER_5 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_CLI_CIAL , COALESCE(CIR1.ID_DWR_PERSON,0) ID_DWR_PERSON , COALESCE(CIR2.ID_DWR_PERSON,0) ID_DWR_PERSON_LIEE FROM %DTA%.BMOSOFI STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCLI= TCO1.ID_SOURCE1) LEFT JOIN %SOC%.PERSON CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_BQE AND ('000'||STR1.IDPERS||' ')=CIR1.ID_PERSON AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PERSON CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_BQE AND ('000'||STR1.PERLIE||' ')=CIR2.ID_PERSON AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
GRCO_PNA_COL_CTR_M                                SELECT STR1.CDOEPA, STR1.IDSTU, STR1.DFCOLT, STR1.DCARR3, STR1.CDFIL2, STR1.IDPRET, STR1.IDELCH, STR1.CCONT4, STR1.IDPOCE, STR1.ICLAN, STR1.ISEGN, STR1.GRAPDE, STR1.CDSTGO, STR1.GRAGDR, STR1.CTOPA7, STR1.DDFON4, STR1.DURACB, STR1.CDNIVR, STR1.CDNIVE, STR1.CDNMOB, STR1.TG19, STR1.MTENCA, STR1.MTHEN1, STR1.MTEADC, STR1.MTEXL, STR1.KFMAT1, STR1.MTEXLB, STR1.IDPOBT, STR1.CDPOB, STR1.MTPRV, STR1.CDMPNA, STR1.NOPPC1, STR1.IDEXEY, STR1.DCARR7, STR1.ZCNUFD FROM %BRL%.%ObjectNameFrom% STR1
EDSNTENT                                          SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.TYENT2 , STR1.LIENT7 , STR1.LIENT8 , STR1.CDENCA , STR1.CDETBQ , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
SEGM_MRCH_CIAL_CST                                SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
FAM_OFR                                           SELECT STR1.CD_EDS_BNQ , STR1.CD_FAM_OFR , STR1.CD_USG_FAM , STR1.LI_FAM_OFR , STR1.INDIC_FAM_GRP , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_USG_FAM is Null Then 0 Else 1 END Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_USG_FAM FROM %SOC%.USG_FAM) CIR1 ON ( STR1.CD_USG_FAM=CIR1.CD_USG_FAM)
MIRATP                                            SELECT STR1.CD_EDS_BNQ , STR1.NCPTE , STR1.MSTNC3 , STR1.IDDEVI , STR1.DDMVT8 , STR1.DADMAJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END AS Row_Found_CIR1 , CIR1.ID_DWR_EDC FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ECD_CPTE CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.NCPTE=CIR1.NU_CPTE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
UNIQU1                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE ,COALESCE(CAST(%PMU%.Bin2Char(STR1.IDELCO) AS VARCHAR(30)),' ') AS IDELCO , STR1.IDPART , STR1.NOABT1 , STR1.TOPAGT , STR1.IDCLTC , STR1.CDREV , STR1.CDOUNI , STR1.IOFFRE , STR1.DDSOUS , STR1.CBSOUS , STR1.DFINCO , STR1.CDSTAH , STR1.CDETFA , STR1.LILI1H , STR1.LILI2D , STR1.LIGA3H , STR1.LIGA4H , STR1.LIGA5H , STR1.LILI2C , STR1.NCPTE , STR1.CDNPAI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDELCO = CIR1.BY_SOURCE1 and Substr(CIR1.ID_SOURCE1,31,3) ='ECD')
G3R09                                             SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IPOSTF , STR1.IDPORT , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PST_FNCT , COALESCE(CIR2.ID_DWR,0) ID_DWR_PORTEF , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PST_FNCT_TCO CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IPOSTF = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_PORTEF_TCO CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDPORT = CIR2.ID_SOURCE1)
SIMEVT                                            SELECT STR1.CD_EDS_BNQ ,STR1.IDETAT ,STR1.IDELEP ,STR1.CDTEVG ,STR1.DCREEVT ,STR1.DCREAT ,STR1.ORIGINE ,STR1.SSORIG ,STR1.IDPAGE ,STR1.IDSESS ,STR1.IDAGQU ,STR1.CDETQU ,STR1.CDAVQU ,STR1.CDACTM ,STR1.DCONTP ,STR1.CDCTRE ,STR1.CDMOCT ,STR1.DMODIF ,STR1.CDMPRJ ,STR1.CDAVWEB ,STR1.NBFMEM ,STR1.CDCANAL ,STR1.CBOPTI ,STR1.LREMQU ,STR1.LIELST ,STR1.IDOFC ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.SIMULCA_DOSS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELEP=CIR1.ID_SIM)
TYP_DOMN_ACTI_BQR_CST                             SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
FEPAVE03                                          SELECT STR1.CD_EDS_BNQ , STR1.CDENRG , STR1.CINT , STR1.LIBISP , STR1.NOMPRE , STR1.IDEXEF , STR1.NCPTEX , STR1.CRIB , STR1.CDETC , STR1.DTOUV , STR1.DADMA1 , STR1.DTCLOT , STR1.CDPROC , STR1.TYPCP , STR1.CPTECL , STR1.USCPTE , STR1.DTPEFF , STR1.DFCNT , STR1.TXIPEL , STR1.PECPEL , STR1.NBMECO , STR1.NBMRES , STR1.IDPAG1 , STR1.IDPAG2 , STR1.IDPAG3 , STR1.CVBACV , STR1.MTVOUV , STR1.MTCOCV , STR1.MTVPER , STR1.CFVER , STR1.DTPVPE , STR1.NOPECV , STR1.NCPTE2 , STR1.NCPTE5 , STR1.DTANIC , STR1.DTPANI , STR1.CPCPT , STR1.MCVPER , STR1.MCVEXC , STR1.DDAFF1 , STR1.MTRDTH , STR1.BGEST2 , STR1.BGEST1 , STR1.MIKCNT , STR1.DDAFF2 , STR1.CDCTX1 , STR1.CPETRG , STR1.MICTRF , STR1.MIKTRF , STR1.MTCSGF , STR1.CDRSIL , STR1.DTRSIL , STR1.CDTRNF , STR1.DTTRNF , STR1.CDPROR , STR1.DTPROR , STR1.CDDPRT , STR1.DTDPRT , STR1.CDTRFE , STR1.DATRFE , STR1.CDTRFS , STR1.DATRFS , STR1.MTDEL6 , STR1.MCVPEX , STR1.CDSUEP , STR1.CTPROR , STR1.MSOLD1 , STR1.DTSOJD , STR1.LICMT , STR1.DSSOLJ , STR1.MSMBDF , STR1.DSMBDF , STR1.MSMCIV , STR1.DSMCIV , STR1.CDSOC2 , STR1.IFAMP , STR1.CDDEV , STR1.MSACIV , STR1.DSACIV , STR1.MSABDF , STR1.DSABDF , STR1.MSRELV , STR1.DSRELV , STR1.CDSUSS , STR1.NBPFCC , STR1.MSFMC1 , STR1.DSFMC1 , STR1.DTNBOP , STR1.CDJRH , STR1.CREL , STR1.NERLV , STR1.DCDRLV , STR1.CDCTX4 , STR1.CPETRA , STR1.CDCTX2 , STR1.CDRFAN , STR1.POCSCD , STR1.CINTFM , STR1.CDETC2 , STR1.CINTBF , STR1.CDETC1 , STR1.CDEXO , STR1.BGFMBF , STR1.MICTXR , STR1.MIKTXR , STR1.CDEBTF , STR1.NCPTE3 , STR1.DADATT , STR1.MICAP2 , STR1.MCIFAP , STR1.DCIFAP , STR1.DDOFIC , STR1.DDMVTR , STR1.IDCDPR , STR1.IDCDPK , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , CIR2.DTSIT , COALESCE(CIR2.IBCOUPEL,0) IBCOUPEL , COALESCE(CIR2.MTPRICOU,0) MTPRICOU , COALESCE(CIR2.MTSREEL,0) MTSREEL FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTEX=CIR1.NU_CPTE) LEFT JOIN %DE1%.HPELDPP CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.NCPTEX=CIR2.NCPTE and CIR2.TK_ACTION in ('I','U'))
LIEN_ACTE_OFR_BSN                                 SELECT STR1.CD_EDS_BNQ , STR1.CD_BSN , STR1.ID_OFR_BQR , STR1.CD_ACTE_DSTRB , STR1.CD_PERTINENCE , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_BSN is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.ID_OFR_BQR is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_ACTE_DSTRB is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_BSN FROM %SOC%.BSN ) CIR1 ON (STR1.CD_BSN=CIR1.CD_BSN) LEFT JOIN (Select DISTINCT ID_OFR_BQR FROM %SOC%.OFR ) CIR2 ON (STR1.ID_OFR_BQR=CIR2.ID_OFR_BQR) LEFT JOIN (Select DISTINCT CD_ACTE_DSTRB FROM %SOC%.ACTE_DSTRB) CIR3 ON (STR1.CD_ACTE_DSTRB=CIR3.CD_ACTE_DSTRB)
PARTEN                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.CTPART FROM %DE1%.%ObjectNameFrom% STR1 WHERE STR1.TK_ACTION IN ('I','U')
EXCOPENX                                          SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(TCO1.ID_SOURCE1 as VARCHAR(30)) IDELCO , STR1.IDCTRA IDCTRA_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCTRA) AS VARCHAR(30)) AS IDCTRA , STR1.CDENR1 , STR1.IDCLI1 , STR1.IDPACO , STR1.CPELC , STR1.IDPRB2 , STR1.IDPRB4 , STR1.IDCDP3 , STR1.IDCDP4 , STR1.IOFFR2 , STR1.DASICO , STR1.DEFCON , STR1.DFINCO , STR1.CDMOOC , STR1.CDMOFC , STR1.DDFONC , STR1.DFFONC , STR1.LIAPUS , STR1.NCPTEX , STR1.IDFPR0 , STR1.IDFPR1 , STR1.DDCOMP , STR1.DFCOMP , STR1.TYPCP4 , STR1.CPTET0 , STR1.CUSAC1 , STR1.CBTAE , STR1.CBTAR , STR1.IDEXE1 , STR1.IDEXE6 , STR1.IDDEVI , STR1.FILLER_2 , STR1.IDSEC1 , STR1.ITSPPA , STR1.ITSPPE , STR1.CDAGEC , STR1.CTACV , STR1.DDINPA , STR1.CDRSY3 , STR1.IDASP2 , STR1.NORIB , STR1.CATTE , STR1.CPRSP , STR1.CDACCO , STR1.CSITUA , STR1.CMRGLT , STR1.CEXSIN , STR1.JECHE1 , STR1.DPROD1 , STR1.DTRSI1 , STR1.MKATT1 , STR1.MKDIS1 , STR1.CDCMAK , STR1.CTARIF , STR1.NUPLA1 , STR1.CTPLAN , STR1.DDPLA1 , STR1.DURPL1 , STR1.CTMENS , STR1.TXIAH1 , STR1.MTMEN1 , STR1.MTNEC1 , STR1.MTEIF1 , STR1.MTEIK1 , STR1.CPACT , STR1.CQRES , STR1.NUTRAN , STR1.MSFMOI , STR1.CBCNT , STR1.MSMOYJ , STR1.MHPLF , STR1.MKUTP1 , STR1.MTDPF , STR1.CBSPF , STR1.CBHPF , STR1.MTOUVM , STR1.CBOUM , STR1.MPONM , STR1.CBCLM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) AS ID_DWR_EDC_TCO1 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND substr(TCO1.ID_SOURCE1, character(TCO1.ID_SOURCE1)-2)='ECD') INNER JOIN %SOC%.CRED CIR1 ON (CIR1.CD_BQE=TCO1.CD_EDS_BNQ AND TCO1.ID_DWR=CIR1.ID_DWR_EDC AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
PROCON                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPRD , STR1.LIPROC , STR1.LIAPUS , STR1.IDFPRO , STR1.CTFPR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TDSCK164                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.CDBCF2 , STR1.CDGBD2 , STR1.NCPTE , STR1.CDBCF3 , STR1.CDGBD3 , STR1.NCPTE2 , STR1.LNBECC , STR1.LNDOR , STR1.LIVIR , STR1.DGORFI , STR1.DECHEA , STR1.DAPRPR , STR1.NUOVP2 , STR1.REFEXT , STR1.QTOPE1 , STR1.NUREMV , STR1.NUAUT , STR1.IDSUC2 , STR1.HETRT2 , STR1.FILLER14 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
EXTIT1                                            SELECT STR1.CD_EDS_BNQ, STR1.CDFSCT_MIN, STR1.CDFSCT_MAX, STR1.IDVAL4_MIN, STR1.IDVAL4_MAX, STR1.IDPROD, STR1.LIBEL, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
DGCZ13                                            SELECT STR1.CD_EDS_BNQ, STR1.IDCLC, STR1.IDSGM, STR1.DDPER1, STR1.IDTYS, STR1.DELIEN, STR1.DFLIEN, STR1.RE_CYCLE, STR1.DT_ELIG, STR1.TK_CREATE, STR1.TK_CHANGE, STR1.TK_FLAG, STR1.TK_ACTION, COALESCE(TCO1.ID_DWR,0) ID_DWR_CLI_CIAL, Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1, Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2, Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.DGCZ13 STR1 LEFT JOIN %SOC%.SEGM_EMACO CIR1 ON ( STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDSGM=CIR1.ID_EMACO AND STR1.IDTYS=CIR1.CT_SGMTN AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_SGMTN_EMACO CIR2 ON (CIR2.CD_BQE=STR1.CD_EDS_BNQ AND CIR2.CT_SGMTN=STR1.IDTYS AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) ) LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCLC= TCO1.ID_SOURCE1)
E2R19G                                            SELECT CIR1.CD_EDS_BNQ , CIR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(CIR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , CIR1.DDFONC , CIR1.DFFONC , CIR1.CDSUSS , CAST(NULL As date) As DDVAL , CAST(NULL As date) As DFVAL , CAST(NULL As Time) As HFVAL , CIR1.IDCDPR , CIR1.IDCDPK , CIR1.CDDEMA , CIR1.IDELEX , CIR1.RE_CYCLE , STR1.DT_ELIG , CIR1.TK_CREATE , CIR1.TK_CHANGE , CIR1.TK_FLAG , CIR1.TK_ACTION , CIR2.IDTYOF , IDELC2 , NULL AS IPART1 , NULL AS IDCTR1 , COALESCE(CIR4.IDASPR,-1) AS IDASPR , COALESCE(TCO1.ID_DWR,0) AS ID_DWR , CAST(CAST(Case When CIR1.IDCDPR = 11 and CIR1.IDCDPK > 0 Then CIR1.IDCDPK Else CIR1.IDCDPR end as format '99999') as CHAR(5)) IDCDPR_IDCDPK FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN %DE1%.ELECON CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDELCO=CIR1.IDELCO AND CIR1.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.T2R05P CIR2 ON (CIR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and CIR1.IDELCO=CIR2.IDELCO AND CIR2.TK_ACTION in ('I','U') AND CAST(CIR2.DELIEN AS DATE)<=CIR1.DT_ELIG AND CIR1.DT_ELIG < CAST (CIR2.DFLIEN AS DATE) ) LEFT JOIN %DE1%.ECTASP CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ and STR1.IDELCO=CIR4.IDELCO ) INNER JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD')
C4RE09                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDREPR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR_PERSON,0) PER_ID_DWR_PERSON , COALESCE(CIR3.IDPART,' ') IDPART_REPRES , COALESCE(CIR5.ID_DWR,0) ID_DWR_PERSON , COALESCE(CIR6.ID_DWR,0) PAR_ID_DWR_PART , COALESCE(CIR7.IDPART,0) IDPART_PARTEN , CIR2.DT_DECI_JDCR , CIR2.DF_DECI_JDCR , CIR7.CTPART , COALESCE(CIR3.IDFNRE, ' ') IDFNRE , COALESCE(CIR4.CQLCCP, ' ') CQLCCP , COALESCE(CIR4.CQLCCR, ' ') CQLCCR , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR5 , CASE WHEN CIR6.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR6 , CASE WHEN CIR7.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR7 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1 ) LEFT JOIN %SOC%.RPRSTN CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.IDREPR = CIR2.ID_RPRSTN and CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %DE1%.REPRES CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.IDREPR = CIR3.IDREPR) LEFT JOIN %DE1%.DTWHNLIE CIR4 ON (CIR3.CD_EDS_BNQ = CIR4.CD_EDS_BNQ AND CIR3.IDFNRE = CAST(CIR4.CDVAL9 AS CHAR(2)) and CIR4.CDTABO = 'C4RE09XXIDFNRE') LEFT JOIN %TCO%.ID_PERSON_TCO CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_EDS_BNQ AND STR1.IDPART = CIR5.ID_SOURCE1 ) LEFT JOIN %TCO%.ID_PART_TCO CIR6 ON (CIR3.CD_EDS_BNQ = CIR6.CD_EDS_BNQ AND CIR3.IDPART = CIR6.ID_SOURCE1 ) LEFT JOIN %DE1%.PARTEN CIR7 ON (CIR3.CD_EDS_BNQ = CIR7.CD_EDS_BNQ AND CIR3.IDPART = CIR7.IDPART )
ADREML                                            Select DISTINCT S.CD_EDS_BNQ,S.IDADEM BY_SOURCE1,'CNL' || CAST(%PMU%.Bin2Char(BY_SOURCE1) AS VARCHAR(33)) ID_SOURCE1 FROM %DTA%.ADREML S
TDSCK132                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.CLTPA , STR1.CTSAC , STR1.LIDEST , STR1.NCPTE2 , STR1.CLRIB , STR1.LNDOR , STR1.REFEXT , STR1.LIORDR , STR1.FILLER76 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
MOTSOR                                            SELECT CD_EDS_BNQ, CDSDFO, LISDFO, LISDF1, RE_CYCLE, DT_ELIG, TK_CREATE, TK_CHANGE, TK_FLAG, TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
MDCPRV                                            SELECT STR1.CD_EDS_BNQ , STR1.IDMDCP , STR1.IDEVT , STR1.IDCPG2 , STR1.IDACTC , Case When NullIf(STR1.IDTCN,'') is Null then -1 else STR1.IDTCN end IDTCN , STR1.LIMDCP , STR1.CTMCN1 , STR1.IDOPOR , STR1.CDOFFR , STR1.IDPARZ , STR1.IDTRT , STR1.IDPART , STR1.IDELEX , STR1.IDCTRA IDCTRA_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRA) end AS VARCHAR(30)) AS IDCTRA , STR1.NCPTE , STR1.DIMDCP , STR1.DDMDCP , STR1.DFMDCP , STR1.DEMDCP , STR1.CPSIMP , STR1.CPMDCP , STR1.CPSOMP , STR1.DMMDCP , STR1.DMDCPS , STR1.DMSMPR , STR1.COCHST , STR1.CTRAIS , STR1.CDRAIS , STR1.MTPRJ , STR1.LMPRJ , STR1.KFMDCP , STR1.IDWO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,-1) ID_DWR_CTR , COALESCE(CIR2.ID_DWR_EDC,-1) ID_DWR_EDC , COALESCE(CIR3.ID_DWR_PST_FNCT,-1) ID_DWR_PST_FNCT , COALESCE(CIR4.ID_DWR,0) ID_DWR_PART , COALESCE(CIR5.ID_DWR,-1) ID_DWR_PARZ , CIR6.CD_DETECTION_RSEAU_EVT CD_DETECTION_RSEAU_EVT , COALESCE(CIR7.ID_DWR_AGT,0) ID_DWR_AGT , Case When NullIf(CIR8.IDEVN,'') is Null then -1 else CIR8.IDEVN end IDEVN , Case When CIR1.CD_EDS_BNQ is null then case when STR1.IDCTRA is Null then 1 else 0 end else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then case when NullIf(STR1.IDELEX,'') is null then 1 else 0 end else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then case when NullIf(STR1.IDWO,'') is null then 1 else 0 end else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then case when NullIf(STR1.IDPARZ,'') is null then 1 else 0 end else 1 End Row_Found_CIR5 , Case When CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 , Case When CIR7.CD_BQE is null then 0 else 1 End Row_Found_CIR7 , Case When CIR8.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR8 , Case When CIR9.CD_BQE is null then case when NullIf(STR1.IDTCN,'') is null then 1 else 0 end else 1 End Row_Found_CIR9 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDCTRA = CIR1.BY_SOURCE1) LEFT JOIN %SOC%.ECD_DETENU CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.IDELEX = CIR2.ID_EDC_EXT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.PST_FNCT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE and STR1.IDWO = CIR3.CD_PST_FNCT AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_PART_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ and STR1.IDPART = CIR4.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ and STR1.IDPARZ = CIR5.ID_SOURCE1) INNER JOIN %SOC%.CATALOGUE_MDC_PREVN CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_BQE and STR1.IDEVT = CIR6.ID_EVT_TYP AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT JOIN %SOC%.AGT_AFFECTE_PST_FNCT CIR7 ON (CIR3.CD_BQE = CIR7.CD_BQE and COALESCE(CIR3.ID_DWR_PST_FNCT,0)= CIR7.ID_DWR_PST_FNCT AND CIR3.DF_VALID = CIR7.DF_VALID and CIR7.DF_VALID = '9999-12-31') LEFT JOIN %DE1%.CORPRV CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_EDS_BNQ and STR1.IDMDCP = CIR8.IDMDCP AND CIR8.TK_ACTION IN ('I','U')) LEFT JOIN %SOC%.TECHN_CNTCT CIR9 ON (STR1.CD_EDS_BNQ=CIR9.CD_BQE and STR1.IDTCN = CIR9.ID_TECHN_CNTCT AND CAST(CIR9.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR9.DF_HISTO AS DATE))
PARAM_INDIC_ICS                                   SELECT STR1.CD_EDS_BNQ , STR1.TYP_ICS , STR1.CD_BQE , STR1.ID_ICS , STR1.LB_ICS_BQE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CURRENT_TIMESTAMP(0) DD_HISTO , CURRENT_TIMESTAMP(0) DF_HISTO FROM %DTA%.%ObjectNameFrom% STR1
TYP_CT_CMPOS_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TQUAEX                                            SELECT STR1.CD_EDS_BNQ , STR1.IDQUEX , STR1.CTQEX , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 INNER JOIN %SOC%.TYP_QUALIF_MIF CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CTQEX=CIR1.CT_QUALIF_MIF AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
TYP_FAM_OPERN_FACTN_CST                           SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
T1R10                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDPART1 , STR1.CTYLJU , STR1.DTMARI , STR1.DELIEN , STR1.DFLIEN , STR1.DTDECJ , STR1.DFDECJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , COALESCE(CIR2.ID_DWR,0) PER_ID_DWR_PERSON , COALESCE(CIR3.CQLCCP,' ') CQLCCP , COALESCE(CIR3.CQLCCR,' ') CQLCCR , COALESCE(CIR4.ID_DWR,0) ID_DWR_PART , COALESCE(CIR5.ID_DWR,0) PAR_ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_PERSON_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART1= CIR2.ID_SOURCE1) LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.CTYLJU = CAST(CIR3.CDVAL9 AS DECIMAL(2)) and CIR3.CDTABO = 'T1R10XXXCTYLJU' AND CIR3.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_PART_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND STR1.IDPART = CIR4.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ AND STR1.IDPART1= CIR5.ID_SOURCE1)
ENDETE                                            SELECT STR1.CD_EDS_BNQ , STR1.IDEDEX , STR1.IDPART , STR1.IDPRD , STR1.MJENDE , STR1.MTMEN1 , STR1.DFECC , STR1.DADMA2 , STR1.CFPEPR , STR1.CTGAR6 , STR1.MKRDRA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.ENDETE STR1 LEFT OUTER JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1) LEFT OUTER JOIN %SOC%.PROD_CONC CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.IDPRD=CIR2.ID_PROD_CONC AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
COCL_AF_CENTR_INT                                 SELECT STR1.CD_EDS_BNQ , STR1.ID_STRUCT_AFFECT_CENTR_INT , STR1.ID_SUJET_CENTR_INT , STR1.CD_TYP_SUJET_CENTR_INT , STR1.CENTR_INT_CD_CENTR_INT , STR1.SOURCE_MAJ_AFFECT_CENTR_INT , STR1.TS_MAJ_AFFECT_CENTR_INT , STR1.ID_AGT_MAJ , STR1.CD_CNL_DSTRB_MAJ , STR1.ID_STRUCT_MAJ , STR1.TOP_PRATIQUE_CENTR_INT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 ,CIR3.LI_TYP_CENTR_INT ,CIR2.LI_CENTR_INT FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (select distinct CD_BQE, ID_TK_INTRL from %SOC%.INTRL_CONSO) CIR1 on (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND SUBSTR(STR1.ID_SUJET_CENTR_INT,1,10)=CIR1.ID_TK_INTRL) LEFT JOIN %SOC%.TYP_CENTR_INT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CENTR_INT_CD_CENTR_INT=CIR2.CD_CENTR_INT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.TYP_TYP_CENTR_INT CIR3 ON (CIR2.CD_BQE=CIR3.CD_BQE AND CIR2.CT_CENTR_INT=CIR3.CT_CENTR_INT AND CAST(CIR3.DD_HISTO AS DATE)<=CIR2.DD_HISTO AND CIR2.DF_HISTO <=CAST (CIR3.DF_HISTO AS DATE))
T6R01                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDINPE IDINPE_BYTE , CAST(Case When TCO1.CD_EDS_BNQ is not null then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDINPE) End AS VARCHAR(30)) IDINPE , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_EVT , COALESCE(CIR1.ID_DWR,0) ID_DWR_PERSON , COALESCE(TCO2.ID_DWR,0) ID_DWR_SITUA_PARTC , CIR2.ITSPPE ITSPPE , COALESCE(CIR3.ID_DWR_TYP_EVT,0) ID_DWR_TYP_EVT FROM %DTA%.T6R01 STR1 LEFT JOIN %TCO%.ID_EVT_TCO TCO1 ON(STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDINPE=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,1)='1') LEFT JOIN %TCO%.ID_SITUA_PARTC_TCO TCO2 ON(STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDINPE=TCO2.BY_SOURCE1 AND SUBSTR(TCO2.ID_SOURCE1,31,1)='1') LEFT JOIN %TCO%.ID_PERSON_TCO CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1) LEFT JOIN %DE1%.INCPER CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDINPE=CIR2.IDINPE AND CIR2.TK_ACTION IN ('I','U')) LEFT JOIN %SOC%.TYP_EVT CIR3 ON(CIR2.CD_EDS_BNQ=CIR3.CD_BQE AND CIR2.ITSPPE=CIR3.CT_EVT AND CIR3.CD_REGRP_EVT=1 AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
CHARG1                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCHAR IDCHAR_BYTE , CAST(COALESCE(TCO1.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDCHAR , STR1.IDPART , STR1.CTCHAR , STR1.MTCHAG , STR1.DAARE1 , STR1.DDMOD , STR1.CDOMJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(TCO1.ID_DWR,0) ID_DWR_CHRG , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_CHRG CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CTCHAR = CIR2.CT_CHRG) LEFT JOIN %TCO%.ID_CHRG_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDCHAR = TCO1.BY_SOURCE1)
MTF_CLOT_CST                                      SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
PROD_CIAL_FAM_PROD                                SELECT STR1.CD_EDS_BNQ , STR1.CD_FAM_PROD , STR1.CD_PROD_CIAL , STR1.CT_REL , STR1.LI_TYP_REL , COALESCE(STR1.POIDS,0) POIDS , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_FAM_PROD is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_PROD_CIAL is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_FAM_PROD FROM %SOC%.FAM_PROD ) CIR1 ON (STR1.CD_FAM_PROD=CIR1.CD_FAM_PROD) LEFT JOIN (Select DISTINCT CD_PROD_CIAL FROM %SOC%.PROD_CIAL) CIR2 ON (STR1.CD_PROD_CIAL=CIR2.CD_PROD_CIAL)
LOCCOMM                                           SELECT STR1.CD_EDS_BNQ , STR1.IDADRE IDADRE_BYTE , CAST( %PMU%.Bin2Char(STR1.IDADRE) AS VARCHAR(30)) AS vIDADRE , vIDADRE AS IDADRE , STR1.NCOMMU , STR1.CPOST , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , coALESCE(CIR2.ID_DWR_COORD,0) ID_DWR_COORD , Case When CIR1.CD_EDS_BNQ is null AND PYS.CDPAYS = 1 Then 0 else 1 end Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_EDS_BNQ, NCOMMU FROM %DE1%.COMMUNES WHERE TK_ACTION IN ('I','U')) CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.NCOMMU = CIR1.NCOMMU) LEFT JOIN %SOC%.ADR CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND vIDADRE = CIR2.ID_LCLSTN AND CIR2.ID_INTIT_SPCFQ <>'ADR_EDS') LEFT JOIN %DE1%.PAYS PYS ON (STR1.CD_EDS_BNQ= PYS.CD_EDS_BNQ AND CIR2.ID_CD_PAYS=PYS.CDPAYS)
TYHIERUT                                          SELECT STR1.CD_EDS_BNQ , STR1.CTHUT , STR1.LIHUT , STR1.LITASO , STR1.LNIDSO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
PARTEN                                            SELECT STR1.CD_EDS_BNQ ,STR1.IDPART ,STR1.CDPROS ,STR1.DIPART ,STR1.NUTEPA ,STR1.CAIGPA ,STR1.DCLOPAR ,STR1.DDVAL ,STR1.DFVAL ,STR1.HFVAL ,STR1.CDREBQ ,STR1.CDREF2 ,STR1.CBFREF ,STR1.NONIF ,STR1.CDPRF2 ,STR1.LILIG1 ,STR1.LILIG2 ,STR1.CTPART ,STR1.IDMARC ,STR1.IDPORT ,STR1.IDELST IDELST_BYTE ,CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELST) end AS VARCHAR(30)) AS IDELST ,STR1.IDEXELST ,STR1.DANAIS ,STR1.CTGPPE ,STR1.CCETAB ,STR1.NOSIRE ,STR1.CDMOER ,STR1.CDPAIN ,STR1.CDROLE ,STR1.CBMULB ,STR1.CBEERD ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION , CIR1.CCATJU , CIR1.CCATJ4 , CIR2.DACTGP , CIR2.CLBDFG , CIR2.DDVAL DDVAL_PERGRO , CIR3.IDPAR5 , CIR6.IDMRSE , CIR6.DDMCER , CIR6.CEREFP , CIR7.CLIBISPE , COALESCE (CIR6.DT_ELIG,CAST('0001-01-01 00:00:00' AS TIMESTAMP(0) FORMAT 'YYYY-MM-DDBHH:MI:SS')) AS DT_ELIG_SEA , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR5 , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 , CASE WHEN CIR6.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR6 , CASE WHEN CIR7.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR7 , CASE WHEN CIR8.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR8 , COALESCE(CIR4.ID_DWR,0) ID_DWR_EDS , COALESCE(CIR5.ID_DWR,0) ID_DWR_PORTEF , COALESCE(TCO1.ID_DWR,0) ID_DWR_PART FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.ENNOEC CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.IDPART and CIR1.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.PERGRO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART = CIR2.IDPART and CIR2.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.DGCZ06 CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDPART = CIR3.IDPART and CIR3.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_EDS_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ and STR1.IDELST=CIR4.BY_SOURCE1) LEFT JOIN %TCO%.ID_PORTEF_TCO CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_EDS_BNQ and STR1.IDPORT=CIR5.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ and STR1.IDPART=TCO1.ID_SOURCE1) LEFT JOIN %DE1%.REFSEA CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_EDS_BNQ AND STR1.IDPART = CIR6.IDPART and CIR6.TK_ACTION in ('I','U')) LEFT JOIN %DE1%.PARINT CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_EDS_BNQ AND STR1.IDPART = CIR7.IDPACO and CIR7.TK_ACTION in ('I','U')) LEFT JOIN %SOC%.TYP_ABRG_CVLT CIR8 ON (CIR7.CD_EDS_BNQ=CIR8.CD_BQE AND CIR7.CLIBISPE=CIR8.CD_ABRG_CVLT)
TYP_NATU_NPE_CREANC_CST                           SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
FAM_OFR_FAM_OFR                                   SELECT STR1.CD_EDS_BNQ , STR1.CD_FAM_OFR_M , STR1.CD_FAM_OFR_F , COALESCE(STR1.POIDS,0) POIDS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_FAM_OFR is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_FAM_OFR is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_FAM_OFR FROM %SOC%.FAM_OFR) CIR1 ON (STR1.CD_FAM_OFR_M=CIR1.CD_FAM_OFR) LEFT JOIN (Select DISTINCT CD_FAM_OFR FROM %SOC%.FAM_OFR) CIR2 ON (STR1.CD_FAM_OFR_F=CIR2.CD_FAM_OFR)
PERSON                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.DANAIS , STR1.CDCONA , STR1.LNCONA , STR1.CDRECH , STR1.CDREFI , STR1.CDPAYS , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.CTPART,' ') CTPART , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , COALESCE(TCO1.ID_DWR,0) ID_DWR_PERSON , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.PARTEN CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.IDPART and CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.IDPART=CIR2.ID_SOURCE1) LEFT JOIN %TCO%.ID_PERSON_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ and STR1.IDPART=TCO1.ID_SOURCE1)
LIBELIND                                          SELECT STR1.CD_EDS_BNQ , STR1.IDNOMI , STR1.CDINDI , STR1.IDECAM , STR1.LIB50D , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
CONVSE                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCOSE IDCOSE_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCOSE) end AS VARCHAR(30)) AS IDCOSE , STR1.DASICS , STR1.DECOSE , STR1.DFCOSE , STR1.IDSERV , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) AS ID_DWR_EDC , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDCOSE=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='SCE')
REVEN1                                            SELECT STR1.CD_EDS_BNQ , STR1.IDREVE IDREVE_BYTE , CAST(COALESCE(TCO1.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDREVE , STR1.IDPART , STR1.CTREVE , STR1.MTREVE , STR1.DAARE1 , STR1.DDMOD , STR1.CDOMJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(TCO1.ID_DWR,0) ID_DWR_REVNU , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_REVNU CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CTREVE = CIR2.CT_REVNU) LEFT JOIN %TCO%.ID_REVNU_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDREVE = TCO1.BY_SOURCE1)
DGCZ18                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDCLC , STR1.CTPCC , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.CQLCCP,' ') CQLCCP , COALESCE(CIR2.ID_DWR, 0) ID_DWR_PART , COALESCE(CIR3.ID_DWR, 0) ID_DWR_CLI_COMCIAL , CASE WHEN CIR1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 , CASE WHEN CIR4.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.DTWHNLIE CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.CTPCC = CAST(CIR1.CDVAL9 AS CHAR(1)) AND CIR1.CDTABO IN ('DGCZ18XXXCTPCC','DGCZ18ZXCTPCC','DGCZ18XXCTPCC') AND CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPART= CIR2.ID_SOURCE1) LEFT JOIN %TCO%.ID_CLI_CIAL_TCO CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.IDCLC = CIR3.ID_SOURCE1) LEFT JOIN %DE1%.DGCZ15 CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_EDS_BNQ AND STR1.IDPART= CIR4.IDPART AND STR1.IDCLC= CIR4.IDCLC AND CIR1.TK_ACTION IN ('I','U'))
CMPDEC                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.MTDECO , STR1.CCTAUX , STR1.MATAUX , STR1.MTENGC , STR1.CDFDA , STR1.DADMAJ , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDELCO= CIR1.BY_SOURCE1 AND SUBSTR(CIR1.ID_SOURCE1,31,3) = 'ECD')
TYP_SOLTN_HAB_CST                                 SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRCO_GP_RISQUE                                    SELECT STR1.CD_EDS_BNQ , STR1.IDGRRI , STR1.DFCOLT , STR1.CDSTGO , STR1.MAENTT , STR1.GRAGDR1 , CASE WHEN STR1.DTNOTC1 IS NOT NULL THEN STR1.DTNOTC1 ELSE CAST('1900-01-01' AS DATE) END DTNOTC1 , STR1.GRAGDR2 , STR1.DTNOTC2 , STR1.LNGRR0 , STR1.ISEGN , STR1.CTFIPE , STR1.DCARR7 , STR1.ZCNUFD , STR1.RE_CYCLE , STR1.DT_ELIG , CAST(TD_MONTH_BEGIN(ADD_MONTHS(STR1.DT_ELIG,-1)) as DATE) as DD_PE1 , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.CDMC4 , CIR1.CDFACC , CIR1.DCARR7 AS DCARR7_NOD , CIR3.DCARR7 AS DCARR7_GRCO , CIR3.CDNRI1 , COALESCE(CIR3.CDCRIB, '0') AS CDCRIB , COALESCE(TCO1.ID_DWR,0) AS ID_DWR , CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_TCO1 , 1 Row_Found_CIR1 , CASE WHEN CIR1.CD_EDS_BNQ IS NULL THEN 1 WHEN CIR12.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR12 , CASE WHEN CIR1.CD_EDS_BNQ IS NULL THEN 1 WHEN CIR13.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR13 , CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_GRP_RISQ_TCO TCO1 on STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDGRRI = TCO1.ID_SOURCE1 LEFT JOIN (SELECT CD_EDS_BNQ, IDGRCL, DCARR7, CDMC4, CDFACC FROM %DE1%.NODTIE01 QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_EDS_BNQ,IDGRCL ORDER BY DCARR7 DESC )=1 ) CIR1 ON STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND SUBSTR(STR1.IDGRRI, 2, 10) = CIR1.IDGRCL AND TD_MONTH_BEGIN(ADD_MONTHS(STR1.DT_ELIG,-1)) >= CAST (CIR1.DCARR7 AS DATE) LEFT JOIN %SOC%.TYP_METHD_NOTATN_GRP CIR12 ON CIR1.CD_EDS_BNQ = CIR12.CD_BQE AND CIR1.CDMC4 = CIR12.CD_METHD_NOTATN_GRP AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) >= CAST (CIR12.DD_HISTO AS DATE) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CAST (CIR12.DF_HISTO AS DATE) LEFT JOIN %SOC%.TYP_CATG_PRNCP_GRP CIR13 ON CIR1.CD_EDS_BNQ = CIR13.CD_BQE AND CIR1.CDFACC = CIR13.CD_CATG_PRNCP_GRP AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) >= CAST (CIR13.DD_HISTO AS DATE) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CAST (CIR13.DF_HISTO AS DATE) LEFT JOIN %SOC%.TYP_SEGM_NOTATN_BALE CIR2 ON STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.ISEGN = CIR2.CD_SEGM_NOTATN_BALE AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) >= CAST (CIR2.DD_HISTO AS DATE) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CAST (CIR2.DF_HISTO AS DATE) LEFT JOIN (SELECT CD_EDS_BNQ, IDGRRI, DCARR7, CDNRI1, CDCRIB FROM %DE1%.GRCONIVG QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_EDS_BNQ,IDGRRI ORDER BY DCARR7 DESC )=1 ) CIR3 ON STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND STR1.IDGRRI = CIR3.IDGRRI AND CIR3.DCARR7 <=TD_MONTH_BEGIN(ADD_MONTHS(STR1.DT_ELIG,-1)) LEFT JOIN %SOC%.TYP_NIV_RISQ CIR4 ON CIR3.CD_EDS_BNQ = CIR4.CD_BQE AND CIR3.CDNRI1 = CIR4.CD_NIV_RISQ AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) >= CAST (CIR4.DD_HISTO AS DATE) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CAST (CIR4.DF_HISTO AS DATE) LEFT JOIN %SOC%.TYP_CLASS_RISQ CIR5 ON CIR3.CD_EDS_BNQ = CIR5.CD_BQE AND CIR3.CDCRIB = CIR5.CD_CLASS_RISQ AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) >= CAST (CIR5.DD_HISTO AS DATE) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CAST (CIR5.DF_HISTO AS DATE)
TYP_CSP_CST                                       SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
T1R35                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDELCO IDELCO_BYTE , CAST(COALESCE(CIR2.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDELCO , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR3.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDELCO=CIR2.BY_SOURCE1 AND SUBSTR(CIR2.ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND CIR3.CDTABO = 'T1R35' AND CIR3.TK_ACTION IN ('I','U'))
T2R18P                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDCLGP , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , CASE WHEN CIR1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1 )
ADRINT                                            Select DISTINCT S.CD_EDS_BNQ , 'MEL' || CAST(%PMU%.Bin2Char(S.IADRES) AS VARCHAR(33)) AS ID_SOURCE1 , S.IADRES AS BY_SOURCE1 FROM %DTA%.ADRINT S
TYP_AGT_ECON_CST                                  SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ENVDCO                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDENV AS IDENV_BYTE , CAST(%PMU%.Bin2Char(IDENV) AS VARCHAR(30)) AS IDENV , STR1.IDTCCO , STR1.IDNUPA AS IDNUPA_BYTE , CAST(%PMU%.Bin2Char(IDNUPA) AS VARCHAR(30)) AS IDNUPA , STR1.CDPRI4 , STR1.CCENV , STR1.DELIEN , STR1.IDCANA , STR1.DELIE1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR3.ID_DWR,CIR4.ID_DWR_COORD,0) ID_DWR_COORD , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR5 , COALESCE(CIR1.ID_ENV, '') ID_ENV , COALESCE(CIR2.ID_TK_COM, '') ID_TK_COM , COALESCE(CIR5.ID_CNL, '') ID_CNL FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ENV_COM CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CAST(%PMU%.Bin2Char(STR1.IDENV) AS VARCHAR(30))=CIR1.ID_ENV) LEFT JOIN %SOC%.TYP_TK_COM CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDTCCO=CIR2.ID_TK_COM) LEFT JOIN %TCO%.ID_COORD_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDNUPA=CIR3.BY_SOURCE1 AND SUBSTR(CIR3.ID_SOURCE1,1,3)='ADR') LEFT JOIN %SOC%.CNL_EMAIL CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND CAST(%PMU%.Bin2Char(STR1.IDNUPA) AS VARCHAR(30))=CIR4.ID_DESTI_COM) LEFT JOIN %SOC%.CNL CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE AND STR1.IDCANA=CIR5.ID_CNL) where 1=1 and STR1.TK_ACTION <> 'D'
BSN_UNVRS_DE_BSN                                  SELECT STR1.CD_EDS_BNQ , STR1.CD_UNVRS , STR1.CD_BSN , STR1.CD_PERTINENCE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_UNVRS is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_BSN is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_UNVRS FROM %SOC%.UNVRS_DE_BSN) CIR1 ON (STR1.CD_UNVRS=CIR1.CD_UNVRS) LEFT JOIN (SELECT DISTINCT CD_BSN FROM %SOC%.BSN ) CIR2 ON (STR1.CD_BSN=CIR2.CD_BSN)
TYP_CT_VAL_MOBLRE_CST                             SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
ELESTR                                            SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDELST , STR1.LIELST , STR1.IDTYES , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.NUTEPA , STR1.IDRSB , STR1.NBJOUV , STR1.CDPRCOF , STR1.NBURSCT , STR1.IDEXELST , STR1.NUFXEL , STR1.LND2ES , STR1.CCLXES , STR1.DDOUES , STR1.DFOUES , STR1.QUISE , STR1.CTNHE , STR1.CPICA , STR1.QTLSE , STR1.QPPRE , STR1.QPSYE , STR1.QPCRE , STR1.CESTEC , STR1.NUFAX , STR1.QTCOF , STR1.CTEDS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_STRUCT , COALESCE(CIR3.ID_DWR,0) ID_DWR_EDS , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.ELESTR STR1 LEFT JOIN %TCO%.ID_ENT_TCO CIR1 ON (99900=CIR1.CD_EDS_BNQ and STR1.CD_EDS_BNQ = CIR1.ID_SOURCE1) LEFT JOIN %DE1%.EDSHTEDS CIR2 ON (99900=CIR2.CD_EDS_BNQ and STR1.IDTYES = CIR2.IDTYED AND CIR2.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_EDS_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.IDELST = CIR3.ID_SOURCE1)
CRM_TRMAIL                                        SELECT STR1.CD_EDS_BNQ , STR1.IDECAM , STR1.NUORDR , STR1.DACFLX , STR1.CDTTML , STR1.IDPART , STR1.IDCTRX , STR1.IDELEX , STR1.IDPARZ , STR1.IDCPG2 , STR1.LIEML , STR1.CTRPML , STR1.DTSTAA , STR1.LNURL , STR1.CBDESB , STR1.CDORIG , STR1.IDBTN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , Case When TCO3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO3 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , COALESCE(TCO1.ID_DWR,0) ID_DWR_PART , COALESCE(TCO2.ID_DWR,0) ID_DWR_CTR , COALESCE(TCO3.ID_DWR,0) ID_DWR_PART_COM , COALESCE(CIR2.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(CIR1.ID_CAMPGN_UNICA,0) ID_CAMPGN_UNICA , COALESCE(CIR3.ID_BOUTON_TECHN_CNTCT,0) ID_BOUTON_TECHN_CNTCT FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDPART= TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.IDCTRX= TCO2.ID_SOURCE1 AND TRIM(STR1.IDCTRX) <> '') LEFT JOIN %TCO%.ID_PART_TCO TCO3 ON (STR1.CD_EDS_BNQ = TCO3.CD_EDS_BNQ AND STR1.IDPARZ= TCO3.ID_SOURCE1) LEFT JOIN %SOC%.PROJ_UNICA CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDCPG2=CIR1.ID_CAMPGN_UNICA AND CIR1.DF_HISTO = to_date('31/12/9999', 'DD/MM/YYYY')) LEFT JOIN %SOC%.ECD_DETENU CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.IDELEX= CIR2.ID_EDC_EXT AND CIR2.DF_HISTO = to_date('31/12/9999' , 'DD/MM/YYYY') AND TRIM(STR1.IDELEX) <> '') LEFT JOIN %SOC%.BOUTON CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_BQE AND STR1.IDBTN= CIR3.ID_BOUTON_TECHN_CNTCT)
CATREV                                            SELECT STR1.CD_EDS_BNQ , STR1.CTREVE , STR1.LCREVE , STR1.LIREVE , STR1.LIM200 , STR1.CDRGT6 , STR1.CTGES1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
PARMAI                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IADRES IADRES_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then COALESCE(SUBSTR(TCO1.ID_SOURCE1,4),' ') else %PMU%.Bin2Char(STR1.IADRES) end AS VARCHAR(30)) AS IADRES , STR1.DELIEN , STR1.DFLIEN , STR1.CDCOMA , STR1.DMAJCM , STR1.IDCANA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , coALESCE(TCO1.ID_DWR,0) ID_DWR_COORD , coALESCE(TCO2.ID_DWR,0) ID_DWR_PERSON , coALESCE(TCO3.ID_DWR,0) ID_DWR_PART , coALESCE(CIR3.CT_PART,' ') CT_PART , coALESCE(CIR4.ID_DWR,0) ID_DWR_ETS , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When TCO3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT T1.CD_EDS_BNQ ,T1.ID_DWR ,T1.BY_SOURCE1 , T1.ID_SOURCE1 FROM %TCO%.ID_COORD_TCO T1 WHERE SUBSTR(T1.ID_SOURCE1,1,3)='MEL' AND EXISTS (SELECT NULL FROM %SOC%.EMAIL CIR1 WHERE CIR1.CD_BQE=T1.CD_EDS_BNQ AND T1.ID_DWR=CIR1.ID_DWR_COORD ) ) TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IADRES=TCO1.BY_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO TCO3 ON (STR1.CD_EDS_BNQ=TCO3.CD_EDS_BNQ AND STR1.IDPART=TCO3.ID_SOURCE1 ) LEFT JOIN %SOC%.PART CIR3 ON (TCO3.CD_EDS_BNQ=CIR3.CD_BQE and TCO3.ID_DWR = CIR3.ID_DWR_PART AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN (SELECT T2.CD_EDS_BNQ ,T2.ID_SOURCE1 ,T2.ID_DWR FROM %TCO%.ID_PERSON_TCO T2 Where EXISTS (SELECT NULL FROM %SOC%.PERSON CIR2 WHERE T2.CD_EDS_BNQ=CIR2.CD_BQE and T2.ID_DWR = CIR2.ID_DWR_PERSON ) ) TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDPART=TCO2.ID_SOURCE1 ) LEFT JOIN %TCO%.ID_ETS_TCO CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND STR1.IDPART=CIR4.ID_SOURCE1 )
TYP_TRCH_ANC_REL_CLI_CST                          SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
GRCO_CREANCE                                      SELECT STR1.CD_EDS_BNQ , STR1.IDELCH IDELCH_BYTE , CAST(STR1.IDELCH AS BYTE(15)) AS IDELCH_TR1 , CAST(%PMU%.Bin2Char(STR1.IDELCH) AS VARCHAR(46)) AS IDELCH , STR1.DFCOLT , STR1.IDPOCE , STR1.IDPRET , STR1.DCARR7 , STR1.CTOPA7 , STR1.GRAPDE1 , STR1.GRAPDE2 , STR1.ICLAN , STR1.CELICR , STR1.CDSTGO , STR1.CLACPO , STR1.CDPOB , STR1.CTRIS , STR1.MTPRV8 , STR1.MTPER1 , STR1.MTEXR2 , STR1.MTENCI , STR1.MTHENG , STR1.MPROK9 , STR1.MTPRV , STR1.DFFON0 , STR1.MPLIMB , STR1.MTDECD , STR1.MKUTP6 , STR1.MFRAE2 , STR1.MITOT4 , STR1.MKCAE4 , STR1.NBJORE , TRIM(STR1.CODORI) AS CODORI , STR1.CTEVCR , STR1.CDARFR , STR1.CBNAEC , STR1.CQCRE4 , STR1.CBCNP5 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR AS ID_DWR_CREANC_EXPOSE , TCO2.ID_DWR AS ID_DWR_PART_TCO , TCO3.ID_DWR AS ID_DWR_EDC_TCO , CIR4.CDNRIS AS CDNRIS , CIR4.DCARR7 AS CIR4_DCARR7 , CIR4.CDCRIB , CIR11.CLACPO AS CLACPO_DEGRA , CASE WHEN CIR35.CDBUC = ' ' THEN 'NC' ELSE CIR35.CDBUC END AS CDBUC , CASE WHEN CIR11.TOP_CDNATF_11 IN (1) THEN CIR11.CDNATF_11 ELSE '-1' END AS CDNATF_11_DEGRA , CASE WHEN CIR11.TOP_CDNATF_16=1 THEN CIR11.CDNATF_16 ELSE '-1' END AS CDNATF_16_DEGRA , CIR14.CQOPE AS CQOPE_DELTA , CIR14.CQOPE2 AS CQOPE2_DELTA , Cast(ADD_MONTHS(TD_MONTH_BEGIN(STR1.DT_ELIG),-1) AS DATE) AS DD_PE , COALESCE (CIR3.CD_NATU_RISQ_CONTREPARTIE,0) AS CD_NATU_RISQ_CONTREPARTIE , CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_TCO1 , CASE WHEN TCO2.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_TCO2 , CASE WHEN TCO3.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_TCO3 , CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR5 , CASE WHEN CIR8.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR8 , CASE WHEN CIR9.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR9 , CASE WHEN CIR10.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR10 , CASE WHEN CIR11.CD_EDS_BNQ IS NOT NULL THEN 1 ELSE 0 End Row_Found_CIR6 , CASE WHEN CIR11.TOP_CDNATF_11 IN (1) THEN 1 ELSE 0 End Row_Found_CIR11 , CASE WHEN CIR11.TOP_CDNATF_16=1 THEN 1 ELSE 0 End Row_Found_CIR16 , CASE WHEN CIR12.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR12 , CASE WHEN CIR13.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR13 , CASE WHEN CIR14.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_CIR14 , CASE WHEN CIR15.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR15 , CASE WHEN CIR17.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR17 , CASE WHEN CIR19.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_CIR19 , CASE WHEN CIR21.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 End Row_Found_CIR21 , CASE WHEN CIR20.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR20 , CASE WHEN CIR22.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR22 , CASE WHEN CIR25.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR25 , CASE WHEN CIR26.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR26 , CIR21.MTEXL AS MTEXL_CREA , CIR21.MTEXLB AS MTEXLB_CREA , CIR21.MTEXLH AS MTEXLH_CREA , CIR21.MTEXLM AS MTEXLM_CREA , CIR21.MTEXLR AS MTEXLR_CREA , CIR21.MTEADE AS MTEADE_CREA , CIR21.MTEADW AS MTEADW_CREA , CIR21.MTEADZ AS MTEADZ_CREA , CIR21.MTRWA1 AS MTRWA1_CREA , CIR21.MTRWB1 AS MTRWB1_CREA , CIR21.MTRWH1 AS MTRWH1_CREA , CIR19.CDCORB AS CDCORB_DEG , CIR21.CDCORB AS CDCORB_CREA , CIR19.CDREMO AS CDREMO_DEG , CIR21.CDREMO AS CDREMO_CREA , CIR23.MTPRV AS MTPRV_COL , CIR24.MTPRV AS MTPRV_FIL , CASE WHEN (STR1.CDSTGO = '04' AND STR1.CELICR = 'O') THEN CASE WHEN (CIR19.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR19.MT_EAD END ELSE CASE WHEN (CIR21.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR21.MTEADE END END AS MT_EAD , CASE WHEN (STR1.CDSTGO = '04' AND STR1.CELICR = 'O') THEN CASE WHEN (CIR19.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR19.MT_EAD_BILAN END ELSE CASE WHEN (CIR21.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR21.MTEADW END END AS MT_EAD_BILAN , CASE WHEN (STR1.CDSTGO = '04' AND STR1.CELICR = 'O') THEN CASE WHEN (CIR19.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR19.MT_EAD_HORS_BILAN END ELSE CASE WHEN (CIR21.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR21.MTEADZ END END AS MT_EAD_HORS_BILAN , CASE WHEN (STR1.CDSTGO = '04' AND STR1.CELICR = 'O') THEN CASE WHEN (CIR19.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR19.MT_RWA END ELSE CASE WHEN (CIR21.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR21.MTRWA1 END END AS MT_RWA , CASE WHEN (STR1.CDSTGO = '04' AND STR1.CELICR = 'O') THEN CASE WHEN (CIR19.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR19.MT_RWA_BILAN END ELSE CASE WHEN (CIR21.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR21.MTRWB1 END END AS MT_RWA_BILAN , CASE WHEN (STR1.CDSTGO = '04' AND STR1.CELICR = 'O') THEN CASE WHEN (CIR19.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR19.MT_RWA_HORS_BILAN END ELSE CASE WHEN (CIR21.CD_EDS_BNQ IS NULL) THEN 0 ELSE CIR21.MTRWH1 END END AS MT_RWA_HORS_BILAN , CIR19.CLACPO AS CLACPO_RET_DEG , CIR21.CLACPO AS CLACPO_RET , CASE WHEN CIR27.CD_EDS_BNQ IS NOT NULL THEN CIR27.MVT_PERT_CVRT_CAPTL ELSE 0 END AS MVT_PERT_CVRT_CAPTL , CASE WHEN CIR27.CD_EDS_BNQ IS NOT NULL THEN CIR27.MVT_PERT_CVRT_INT_FRS ELSE 0 END MVT_PERT_CVRT_INT_FRS , CASE WHEN CIR27.CD_EDS_BNQ IS NOT NULL THEN CIR27.MVT_PERT_NCVRT_CAPTL ELSE 0 END MVT_PERT_NCVRT_CAPTL , CASE WHEN CIR27.CD_EDS_BNQ IS NOT NULL THEN CIR27.MVT_PERT_NCVRT_INT_FRS ELSE 0 END MVT_PERT_NCVRT_INT_FRS , CASE WHEN CIR28.CD_EDS_BNQ IS NOT NULL THEN CIR28.MVT_DOTN_SPCFQ_CAPTL ELSE 0 END AS MVT_DOTN_SPCFQ_CAPTL , CASE WHEN CIR28.CD_EDS_BNQ IS NOT NULL THEN CIR28.MVT_DOTN_SPCFQ_INT_FRS ELSE 0 END MVT_DOTN_SPCFQ_INT_FRS , CASE WHEN CIR28.CD_EDS_BNQ IS NOT NULL THEN CIR28.MVT_REPR_NUTLS_CAPTL ELSE 0 END MVT_REPR_NUTLS_CAPTL , CASE WHEN CIR28.CD_EDS_BNQ IS NOT NULL THEN CIR28.MVT_REPR_NUTLS_INT_FRS ELSE 0 END MVT_REPR_NUTLS_INT_FRS , CASE WHEN CIR29.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR29 , CASE WHEN CIR30.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR30 , CASE WHEN CIR31.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR31 , CASE WHEN CIR32.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR32 , CASE WHEN CIR33.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR33 , CASE WHEN CIR34.CD_BQE IS NULL THEN 0 ELSE 1 End Row_Found_CIR34 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CREANCE_EXPO_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDPRET=TCO1.ID_SOURCE1) LEFT JOIN ( SELECT CD_EDS_BNQ,DD_HISTO,DF_HISTO,DT_CREAT_PART,DT_CLOT_PART,ID_DWR,ID_SOURCE1 FROM %TCO%.ID_PART_TCO TCO2 INNER JOIN %SOC%.PART CIR1 ON (TCO2.CD_EDS_BNQ=CIR1.CD_BQE AND TCO2.ID_DWR=CIR1.ID_DWR_PART ) ) TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDPOCE=TCO2.ID_SOURCE1) AND (TCO2.DF_HISTO = '9999-12-31 00:00:00' AND TCO2.DT_CREAT_PART<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) <TCO2.DT_CLOT_PART) LEFT JOIN ( SELECT CD_EDS_BNQ ,ID_DWR ,DD_FONCTIONNEMENT,DF_FONCTIONNEMENT , DD_HISTO , DF_HISTO,ID_SOURCE1, BY_SOURCE1 FROM %TCO%.ID_EDC_TCO TCO3 INNER JOIN %SOC%.ECD_DETENU CIR2 ON (TCO3.CD_EDS_BNQ=CIR2.CD_BQE AND TCO3.ID_DWR=CIR2.ID_DWR_EDC ) ) TCO3 ON (STR1.CD_EDS_BNQ=TCO3.CD_EDS_BNQ AND IDELCH_TR1=TCO3.BY_SOURCE1 AND SUBSTR(TCO3.ID_SOURCE1,31,3)='ECD') AND (TCO3.DF_HISTO = '9999-12-31 00:00:00') LEFT JOIN %SOC%.TYP_APPLI_ORIG CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CODORI=CIR3.CD_APPLI_ORIG AND CIR3.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR3.DF_HISTO) LEFT JOIN (select CD_EDS_BNQ,IDELCH,DCARR7,CDNRIS,CDCRIB from %DE1%.GRCONIVC where DCARR7 <= '#FirstDayPreviousMonth#' qualify row_number() over(partition by CD_EDS_BNQ,IDELCh order by DCARR7 DESC )=1 ) CIR4 ON(STR1.CD_EDS_BNQ=CIR4.CD_EDS_BNQ AND STR1.IDELCH=CIR4.IDELCH) LEFT JOIN %SOC%.TYP_NIV_RISQ CIR5 ON (CIR4.CD_EDS_BNQ=CIR5.CD_BQE AND CIR4.CDNRIS=CIR5.CD_NIV_RISQ AND CIR5.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR5.DF_HISTO) LEFT JOIN %SOC%.TYP_CLASS_RISQ CIR34 ON (CIR4.CD_EDS_BNQ=CIR34.CD_BQE AND CIR4.CDCRIB=CIR34.CD_CLASS_RISQ AND CIR34.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR34.DF_HISTO) LEFT JOIN %SOC%.TYP_PORTEF_BALE_CREANC CIR8 ON (STR1.CD_EDS_BNQ=CIR8.CD_BQE AND CAST(STR1.CDPOB AS SMALLINT)=CIR8.CD_PORTEF_BALE_CREANC AND CIR8.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR8.DF_HISTO) LEFT JOIN %SOC%.TYP_CT_CREANC_EXPOSE CIR9 ON (STR1.CD_EDS_BNQ=CIR9.CD_BQE AND CAST(STR1.CTOPA7 AS SMALLINT)=CIR9.CT_CREANC_EXPOSE AND CIR9.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR9.DF_HISTO) LEFT JOIN %SOC%.TYP_CT_RISQ_EXPOSE CIR10 ON (STR1.CD_EDS_BNQ=CIR10.CD_BQE AND TRIM(STR1.CTRIS)=TRIM(CIR10.CT_RISQ) AND CIR10.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR10.DF_HISTO) LEFT JOIN ( SELECT CD_EDS_BNQ ,IDELCH ,MAX( CASE WHEN CDNATF IN ('NAT06','NAT07') THEN CDNATF ELSE '' END) AS CDNATF_11 ,MAX( CASE WHEN CDNATF NOT IN ('NAT06','NAT07') THEN CDNATF ELSE '' END) AS CDNATF_16 ,MAX( CASE WHEN CDNATF IN ('NAT06','NAT07') THEN 1 ELSE 0 END) AS TOP_CDNATF_11 ,MAX( CASE WHEN CDNATF NOT IN ('NAT06','NAT07') THEN 1 ELSE 0 END) AS TOP_CDNATF_16 ,MAX(CLACPO) as CLACPO FROM %DTA%.GRCO_COMPL_DEGRA GROUP BY CD_EDS_BNQ,IDELCH ) CIR11 ON (STR1.CD_EDS_BNQ=CIR11.CD_EDS_BNQ AND STR1.IDELCH=CIR11.IDELCH) LEFT JOIN %SOC%.TYP_NATO CIR12 ON (CIR11.CD_EDS_BNQ=CIR12.CD_BQE AND TRIM(CIR11.CDNATF_11)=TRIM(CIR12.CD_NATO) AND CIR11.TOP_CDNATF_11 IN (1) AND CIR12.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR12.DF_HISTO ) LEFT JOIN %SOC%.TYP_NATO CIR16 ON (CIR11.CD_EDS_BNQ=CIR16.CD_BQE AND TRIM(CIR11.CDNATF_16)=TRIM(CIR16.CD_NATO) AND CIR11.TOP_CDNATF_16=1 AND CIR16.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR16.DF_HISTO ) LEFT JOIN %SOC%.TYP_CLASS_NOTATN_CREANC CIR13 ON (STR1.CD_EDS_BNQ=CIR13.CD_BQE AND TRIM(STR1.ICLAN)=TRIM(CIR13.CD_CLASS_NOTATN_CREANC) AND CIR13.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR13.DF_HISTO) LEFT JOIN %DTA%.GRCO_DELTA_CREANCE CIR14 ON (STR1.CD_EDS_BNQ=CIR14.CD_EDS_BNQ AND STR1.IDELCH=CIR14.IDELCH ) LEFT JOIN %SOC%.TYP_NATO CIR15 ON (CIR14.CD_EDS_BNQ=CIR15.CD_BQE AND TRIM(CIR14.CQOPE)=TRIM(CIR15.CD_NATO) AND CIR15.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR15.DF_HISTO ) LEFT JOIN %SOC%.TYP_NATO CIR17 ON (CIR14.CD_EDS_BNQ=CIR17.CD_BQE AND TRIM(CIR14.CQOPE2)=TRIM(CIR17.CD_NATO) AND CIR17.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR17.DF_HISTO ) LEFT JOIN (SELECT CD_EDS_BNQ ,IDPRET ,MAX(CDREMO) AS CDREMO ,MAX(CDCORB) AS CDCORB ,SUM(CASE WHEN CQOPE NOT IN ('NAT06','NAT07') THEN MTEA1E END) AS MT_EAD_BILAN ,SUM(CASE WHEN CQOPE IN ('NAT06','NAT07') THEN MTEA1E END) AS MT_EAD_HORS_BILAN ,SUM(CASE WHEN CQOPE NOT IN ('NAT06','NAT07') THEN MTRT1E END) AS MT_RWA_BILAN ,SUM(CASE WHEN CQOPE IN ('NAT06','NAT07') THEN MTRT1E END) AS MT_RWA_HORS_BILAN ,SUM(MTEA1E) AS MT_EAD ,SUM(MTRT1E) AS MT_RWA ,MAX(CLACPO) AS CLACPO FROM %DTA%.GRCO_DU_RET_COMP_DEG GROUP BY CD_EDS_BNQ,IDPRET ) CIR19 ON (STR1.CD_EDS_BNQ=CIR19.CD_EDS_BNQ AND STR1.IDPRET=CIR19.IDPRET ) LEFT JOIN %SOC%.TYP_METHD_CALC_BALE CIR20 ON (CIR19.CD_EDS_BNQ=CIR20.CD_BQE AND TRIM(CIR19.CDCORB)=TRIM(CIR20.CD_METHD_CALC_BALE) AND CIR20.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR20.DF_HISTO ) LEFT JOIN %DTA%.GRCO_DU_RET_CREANCES CIR21 ON (STR1.CD_EDS_BNQ=CIR21.CD_EDS_BNQ AND STR1.IDPRET=CIR21.IDPRET ) LEFT JOIN %SOC%.TYP_METHD_CALC_BALE CIR22 ON (CIR21.CD_EDS_BNQ=CIR22.CD_BQE AND TRIM(CIR21.CDCORB)=TRIM(CIR22.CD_METHD_CALC_BALE) AND CIR22.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR22.DF_HISTO ) LEFT JOIN (SELECT CD_EDS_BNQ ,IDPRET ,DCARR7 ,sum(coalesce(MTPRV,0)) AS MTPRV FROM %DTA%.GRCO_PNA_COL_CTR_M GROUP BY CD_EDS_BNQ,IDPRET,DCARR7 ) CIR23 ON (STR1.CD_EDS_BNQ=CIR23.CD_EDS_BNQ AND STR1.IDPRET=CIR23.IDPRET ) LEFT JOIN (SELECT CD_EDS_BNQ ,IDPRET ,DCARR7 ,sum(coalesce(MTPRV,0)) AS MTPRV FROM %DTA%.GRCO_PNA_FIL_CTR_M GROUP BY CD_EDS_BNQ, IDPRET, DCARR7 ) CIR24 ON (STR1.CD_EDS_BNQ=CIR24.CD_EDS_BNQ AND STR1.IDPRET=CIR24.IDPRET ) LEFT JOIN %SOC%.TYP_CAP CIR25 ON (CIR19.CD_EDS_BNQ=CIR25.CD_BQE AND CAST(CIR19.CLACPO AS SMALLINT)=CIR25.CD_CAP AND CIR25.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR25.DF_HISTO ) LEFT JOIN %SOC%.TYP_CAP CIR26 ON (CIR21.CD_EDS_BNQ=CIR26.CD_BQE AND CAST(CIR21.CLACPO AS SMALLINT)=CIR26.CD_CAP AND CIR26.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR26.DF_HISTO ) LEFT JOIN (SELECT CD_EDS_BNQ, IDELCH, DCARR7, SUM ( CASE WHEN CDMOPR = '101' THEN MTMO351 ELSE 0 END ) AS MVT_PERT_CVRT_CAPTL, SUM ( CASE WHEN CDMOPR = '101' THEN MTMO352 + MTMO353 ELSE 0 END ) AS MVT_PERT_CVRT_INT_FRS, SUM ( CASE WHEN CDMOPR = '102' THEN MTMO351 ELSE 0 END ) AS MVT_PERT_NCVRT_CAPTL, SUM ( CASE WHEN CDMOPR = '102' THEN MTMO352 + MTMO353 ELSE 0 END ) AS MVT_PERT_NCVRT_INT_FRS FROM %DTA%.GRCO_MVT_PERT GROUP BY CD_EDS_BNQ,IDELCH,DCARR7 ) CIR27 ON (STR1.CD_EDS_BNQ=CIR27.CD_EDS_BNQ AND STR1.IDELCH=CIR27.IDELCH ) LEFT JOIN (SELECT CD_EDS_BNQ, IDELCH, DCARR7, SUM ( CASE WHEN CDMOPR = '001' THEN MPROK5 ELSE 0 END ) AS MVT_DOTN_SPCFQ_CAPTL, SUM ( CASE WHEN CDMOPR = '001' THEN MPROK6 + MPROK7 ELSE 0 END ) AS MVT_DOTN_SPCFQ_INT_FRS, SUM ( CASE WHEN CDMOPR = '002' THEN MPROK5 ELSE 0 END ) AS MVT_REPR_NUTLS_CAPTL, SUM ( CASE WHEN CDMOPR = '002' THEN MPROK6 + MPROK7 ELSE 0 END ) AS MVT_REPR_NUTLS_INT_FRS FROM %DTA%.GRCO_MVT_PROV GROUP BY CD_EDS_BNQ,IDELCH,DCARR7 ) CIR28 ON (STR1.CD_EDS_BNQ=CIR28.CD_EDS_BNQ AND STR1.IDELCH=CIR28.IDELCH ) LEFT JOIN %SOC%.TYP_STATU_4BRNC CIR29 ON (STR1.CD_EDS_BNQ=CIR29.CD_BQE AND STR1.CQCRE4=CIR29.CD_STATU_4BRNC AND CIR29.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR29.DF_HISTO) LEFT JOIN %SOC%.TYP_RISQ_4BRNC CIR30 ON (STR1.CD_EDS_BNQ=CIR30.CD_BQE AND STR1.CDARFR=CIR30.CD_RISQ_4BRNC AND CIR30.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR30.DF_HISTO) LEFT JOIN %SOC%.TYP_NATU_EVT_4BRNC CIR31 ON (STR1.CD_EDS_BNQ=CIR31.CD_BQE AND STR1.CBNAEC=CIR31.CD_NATU_EVT_4BRNC AND CIR31.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR31.DF_HISTO) LEFT JOIN %SOC%.TYP_EVT_EDC_EXPOSE CIR32 ON (STR1.CD_EDS_BNQ=CIR32.CD_BQE AND STR1.CTEVCR=CIR32.CD_EVT_EDC_EXPOSE AND CIR32.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR32.DF_HISTO) LEFT JOIN %SOC%.TYP_NATU_NPE_CREANC CIR33 ON (STR1.CD_EDS_BNQ=CIR33.CD_BQE AND STR1.CBCNP5=CIR33.CD_NATU_NPE_CREANC AND CIR33.DD_HISTO<=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1))<CIR33.DF_HISTO) LEFT JOIN (SELECT CD_EDS_BNQ ,IDPRET ,DCARR7 ,MAX(CDBUC) AS CDBUC FROM %DTA%.GRCO_ROMP_PROV GROUP BY CD_EDS_BNQ, IDPRET, DCARR7) CIR35 ON (STR1.CD_EDS_BNQ=CIR35.CD_EDS_BNQ AND STR1.IDPRET=CIR35.IDPRET)
ENTCAM                                            SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IDSTU , STR1.LIENT7 , STR1.LIBE3 , STR1.DDVAL , STR1.DFVAL , STR1.IDECAM , STR1.IDECA1 , STR1.IDEXEY , STR1.CDADH , STR1.IDEXEB , STR1.CDTYES , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_ENT , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_STRUCT CIR1 ON(STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.CDTYES= CIR1.CT_STRUCT and CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_ENT_TCO TCO1 ON(STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDSTU = TCO1.ID_SOURCE1)
TYP_TECHN_CRED_NOYAU_PRET_CST                     SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
RELPAR                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELTD , STR1.IDPART , STR1.DELIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , COALESCE(CIR1.ID_ELT_CONSTI_DOCU,0) AS ID_ELT_CONSTI_DOCU FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ELT_CONSTI_DOCU CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELTD=CIR1.ID_ELT_CONSTI_DOCU AND DF_HISTO='9999-12-31 00:00:00') LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART=CIR2.ID_SOURCE1) WHERE 1=1 and STR1.TK_ACTION <> 'D'
DGXG1A                                            SELECT STR1.CD_EDS_BNQ , STR1.IDRAA , STR1.LNRAA , STR1.CPCLG , STR1.KFCLG , STR1.CBIMDC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
CLASS_GST_PARTC_CST                               SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TIMTBA02                                          SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CEETB9 , STR1.SIRET9 , STR1.LRRAI , STR1.TELCO , STR1.RAISO , STR1.NUADH , STR1.AD2CO , STR1.AD3CO , STR1.RUECO , STR1.VILCO , STR1.CEPCO9 , STR1.BDICO , STR1.AD1EX , STR1.AD2EX , STR1.AD3EX , STR1.AD4EX , STR1.VILEX , STR1.CEPEX9 , STR1.BDIEX , STR1.NUCLI , STR1.NOMCO , STR1.CEAPE , STR1.CESGN9 , STR1.LIENS , STR1.NUGDN9 , STR1.NUDET9 , STR1.NUBUG9 , STR1.NUACA9 , STR1.DTAFF9 , STR1.DSUCO9 , STR1.DTRES8 , STR1.DTRAD9 , STR1.LIRAD , STR1.NURIB , STR1.NOBQE , STR1.NUMCM9 , STR1.DMACC9 , STR1.DEACC9 , STR1.NUMVK9 , STR1.DMVKC9 , STR1.DEVKC9 , STR1.ZLSP1 , STR1.ZLSP2 , STR1.ZLSP3 , STR1.ZLSP4 , STR1.ZLSP5 , STR1.TYMDC9 , STR1.PEDCC , STR1.TYRLC9 , STR1.PERCC , STR1.PERRC , STR1.CELCC9 , STR1.STDGG9 , STR1.NBDGG9 , STR1.STDGI9 , STR1.NBDGI9 , STR1.STDAU9 , STR1.NUDSL9 , STR1.IDNSL9 , STR1.CEMCC9 , STR1.CTRICO , STR1.CTCOMM , STR1.CDPAYX , STR1.CDPAYA , STR1.DMENR9 , STR1.CDEDCM , STR1.TYSEGF , STR1.CDTIGF , STR1.TYSEA1 , STR1.NUACA1 , STR1.CDMMC1 , STR1.IDKCA1 , STR1.STDAU1 , STR1.TYSEA2 , STR1.NUACA2 , STR1.CDMMC2 , STR1.IDKCA2 , STR1.STDAU2 , STR1.TYSEA3 , STR1.NUACA3 , STR1.CDMMC3 , STR1.IDKCA3 , STR1.STDAU3 , STR1.TYSEA4 , STR1.NUACA4 , STR1.CDMMC4 , STR1.IDKCA4 , STR1.STDAU4 , STR1.TYSEA5 , STR1.NUACA5 , STR1.CDMMC5 , STR1.IDKCA5 , STR1.STDAU5 , STR1.TYSEA6 , STR1.NUACA6 , STR1.CDMMC6 , STR1.IDKCA6 , STR1.STDAU6 , STR1.TYSEA7 , STR1.NUACA7 , STR1.CDMMCE , STR1.IDKCA7 , STR1.STDAU7 , STR1.TYSEA8 , STR1.NUACAX , STR1.CDMMC8 , STR1.IDKCA8 , STR1.STDAU8 , STR1.TYSEA9 , STR1.NUACAD , STR1.CDMMCD , STR1.IDKCA9 , STR1.STDAUD , STR1.TYSEAA , STR1.NUACAA , STR1.CDMMCA , STR1.IDKCAA , STR1.STDAUA , STR1.TYSEAB , STR1.NUACAB , STR1.CDMMCB , STR1.IDKCAB , STR1.STDAUB , STR1.TYSEAD , STR1.NUACAC , STR1.CDMMCC , STR1.IDKCAC , STR1.STDAUC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CAST(SUBSTR(STR1.NURIB,11,11) AS BIGINT) as NU_CPTE , CASE WHEN Row_Found_CIR1=1 THEN COALESCE(CIR1.ID_DWR_ETS,0) ELSE COALESCE(CIR5.ID_DWR_ETS,0) END AS ID_DWR_ETS , COALESCE(J1.SUM_J1,0) AS Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN ( SELECT SUM(Case When CIR1.CD_BQE is null then 0 else 1 End) AS SUM_J1, CIR1.CD_BQE AS CD_BQE, CIR1.NU_SIRET AS NU_SIRET FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ETS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.SIRET9=CIR1.NU_SIRET AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) GROUP BY CIR1.CD_BQE, CIR1.NU_SIRET ) AS J1 ON J1.CD_BQE=STR1.CD_eds_bnq AND J1.NU_SIRET=STR1.SIRET9 LEFT JOIN %SOC%.ETS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.SIRET9=CIR1.NU_SIRET AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ACCL_CTR_ECD CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND substr (STR1.NURIB, 11, 11) =CIR2.NU_CPTE AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.EST_CLI_POUR CIR3 ON (CIR2.CD_BQE=CIR3.CD_BQE AND CIR2.ID_DWR_CTR =CIR3.ID_DWR_CTR AND CAST(CIR3.DD_VALID AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_VALID AS DATE)) LEFT JOIN %SOC%.PART CIR4 ON (CIR3.CD_BQE=CIR4.CD_BQE AND CIR3.ID_DWR_PART =CIR4.ID_DWR_PART AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ETS CIR5 ON (CIR4.CD_BQE=CIR5.CD_BQE AND CIR4.ID_PART =CIR5.ID_ETS AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE)) WHERE 1=1
FONCTN                                            SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IFONCN , STR1.CNIVDL , STR1.LIWO02 , STR1.LNRTF , STR1.KPPNC , STR1.QPPRT , STR1.QPSYT , STR1.QPCRT , STR1.IDTYWO , STR1.CDPRI2 , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_FNCTN , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN TCO1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.EDSNFONC CIR1 ON (99900 = CIR1.CD_EDS_BNQ AND STR1.IFONCN = CIR1.IFONC5 AND CIR1.TK_ACTION IN ('I','U')) LEFT JOIN %TCO%.ID_FNCTN_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IFONCN = TCO1.ID_SOURCE1)
TYP_CT_SIGNER                                     SELECT CD_BQE, CT_SIGNER, DD_HISTO, DF_HISTO FROM %SOC%.%ObjectNameFrom% WHERE DF_HISTO = '9999-12-31 00:00:00'
GRA071                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO , STR1.NUFAOP , STR1.CQOPTI , STR1.NUREOP , STR1.DDAPPL , STR1.DFAPPL , STR1.DTANZE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC, 0) ID_DWR_EDC , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , CIR2.NU_FAM_OPTN AS NU_FAM_OPTN , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , CIR4.CD_REGL_OPTN AS CD_REGL_OPTN , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELCO=CIR1.ID_EDC_CRED AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE) AND CIR1.TYP_SOURCE_CRED = 'G' AND CIR1.ID_EDC_CRED IS NOT NULL) LEFT JOIN %SOC%.TYP_FAM_OPTN CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(STR1.NUFAOP AS INTEGER)=CIR2.NU_FAM_OPTN AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_NATU_OPTN CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CQOPTI=CIR3.CD_NATU_OPTN AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_REGL_OPTN CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND CAST(STR1.NUREOP AS INTEGER)=CIR4.CD_REGL_OPTN AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
C1RE34                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDCTRA IDCTRA_BYTE , CAST(COALESCE(CIR2.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDCTRA , STR1.CTINCT , STR1.QTPRQU , STR1.DELIEN , STR1.DFLIEN , STR1.CDFICE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_CTR , COALESCE(CIR3.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPART=CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDCTRA=CIR2.BY_SOURCE1) LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.CTINCT=CIR3.CDVAL9 and CIR3.CDTABO='C1RE34XXCTINCT')
BRUIK603                                          SELECT STR1.CD_EDS_BNQ , STR1.CDOPFI , STR1.CDART4 , STR1.IDEXEF , STR1.NCPTEI , STR1.IDEXE5 , STR1.FILLER_2 , STR1.CDRGV , STR1.CDVAL2 , STR1.FILLERA , STR1.MTVPE3 , STR1.FILLERB , STR1.DAA9 , STR1.DMM1 , STR1.DJJ1 , STR1.FILLERC , STR1.DAA , STR1.DMM , STR1.DJJ , STR1.PEREC6 , STR1.CDTRTG , STR1.CDCFE , STR1.TXTAU6 , STR1.TXTAU7 , STR1.FILLERD , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , TD_MONTH_BEGIN(ADD_MONTHS(CAST(STR1.DT_ELIG AS DATE),-1)) AS DD_PE FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTEI=CIR1.NU_CPTE)
TYP_PORTEF_BALE_CREANC_CST                        SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DGXB52                                            SELECT CD_EDS_BNQ , IDCNL , IDCANA FROM %DE1%.%ObjectNameFrom%
COCL_CRC                                          SELECT STR1.CD_EDS_BNQ , STR1.ID_STRUCT_CRC , STR1.ID_TECHN_CRC , STR1.LIB_CRC , STR1.CD_TYP_CRC , STR1.TOP_PRMNT_CRC , STR1.DESCPTN_MTF_SUPPR_CRC , STR1.DESCPTN_TYP_MODIF_CRC , STR1.TS_MAJ_CRC , STR1.TS_FIN_VALID_CRC , STR1.TS_CREAT_CRC , STR1.SOURCE_MAJ_CRC , STR1.ID_STRUCT_MAJ_CRC , STR1.ID_AGT_MAJ_CRC , STR1.CD_CNL_DSTRB_MAJ_CRC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_CRCL_REL_CIALE CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CD_TYP_CRC=CIR1.CT_CRCL_REL_CIALE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
AGENT                                             SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , STR1.IAGENT , STR1.LNAGEN , STR1.LPAGEN , STR1.DDVAL , STR1.DFVAL , STR1.NUTEL2 , STR1.NUTEPG , STR1.NUTEPF , STR1.LIEML , STR1.LIIAG , STR1.PEDHT , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE( TCO1.ID_DWR,0) ID_DWR , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.AGENT STR1 LEFT JOIN %TCO%.ID_AGT_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IAGENT=TCO1.ID_SOURCE1)
PROD_CIAL_PROD_CIAL                               SELECT STR1.CD_EDS_BNQ , STR1.CD_PROD_CIAL_M , STR1.CD_PROD_CIAL_F , STR1.CD_NATU_REL , STR1.LI_NATU_REL , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_PROD_CIAL is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_PROD_CIAL is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT CD_PROD_CIAL FROM %SOC%.PROD_CIAL) CIR1 ON (STR1.CD_PROD_CIAL_M=CIR1.CD_PROD_CIAL) LEFT JOIN (SELECT DISTINCT CD_PROD_CIAL FROM %SOC%.PROD_CIAL) CIR2 ON (STR1.CD_PROD_CIAL_F=CIR2.CD_PROD_CIAL)
OPTN_OFR                                          SELECT STR1.CD_EDS_BNQ , STR1.CD_OPTN , STR1.ID_OFR_BQR , STR1.CD_PRES_OPTN_OFR , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_OPTN is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.ID_OFR_BQR is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_OPTN FROM %SOC%.OPTN) CIR1 ON (STR1.CD_OPTN=CIR1.CD_OPTN) LEFT JOIN (Select DISTINCT ID_OFR_BQR FROM %SOC%.OFR ) CIR2 ON (STR1.ID_OFR_BQR=CIR2.ID_OFR_BQR)
COCLICO_SEGM                                      SELECT STR1.CD_EDS_BNQ , STR1.CODENR , STR1.DATPRO , STR1.NATURE , STR1.IDENTI , STR1.IDTEC , STR1.DATAPL , STR1.CODANU , STR1.CODENR_2 , STR1.IDECAM , STR1.IDSUJE , STR1.VALSEG , STR1.INFCOM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CLI_CIAL , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , TCO2.ID_DWR ID_DWR_CTR , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 , TCO3.ID_DWR ID_DWR_EDC , Case When TCO3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO3 , TCO4.ID_DWR ID_DWR_PART , Case When TCO4.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO4 , CIR1.TYPSUJ , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.COCLICO_SEGM STR1 LEFT JOIN %TCO%.ID_CLI_CIAL_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDSUJE= TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO TCO2 ON (STR1.CD_EDS_BNQ = TCO2.CD_EDS_BNQ AND STR1.IDSUJE= TCO2.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO TCO3 ON (STR1.CD_EDS_BNQ = TCO3.CD_EDS_BNQ AND STR1.IDSUJE= CAST(TCO3.ID_SOURCE1 AS VARCHAR(30)) AND SUBSTR(TCO3.ID_SOURCE1,31,3)='ECD') LEFT JOIN %TCO%.ID_PART_TCO TCO4 ON (STR1.CD_EDS_BNQ = TCO4.CD_EDS_BNQ AND STR1.IDSUJE= TCO4.ID_SOURCE1) LEFT JOIN %DE1%.CRM_CARAC CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDTEC=CIR1.IDTEC AND CIR1.TK_ACTION IN ('I','U'))
PROD_CIAL_MRCH                                    SELECT STR1.CD_EDS_BNQ , STR1.CD_PROD_CIAL , STR1.ID_MRCH , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.ID_MRCH is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_PROD_CIAL is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT DISTINCT ID_MRCH FROM %SOC%.MRCH ) CIR1 ON (STR1.ID_MRCH=CIR1.ID_MRCH ) LEFT JOIN (SELECT DISTINCT CD_PROD_CIAL FROM %SOC%.PROD_CIAL) CIR2 ON (STR1.CD_PROD_CIAL=CIR2.CD_PROD_CIAL)
COMN_CST                                          SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
DOFSJFON                                          SELECT STR1. CD_EDS_BNQ ,STR1. CDJUSF ,STR1. LIJUSF ,STR1. CDORFD ,STR1. RE_CYCLE ,STR1. DT_ELIG ,STR1. TK_CREATE ,STR1. TK_CHANGE ,STR1. TK_FLAG ,STR1. TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_NATU_RISQ_CONTREPARTIE_CST                    SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
IARFKA50                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.NCPTPA , STR1.KA50_IDPRO , STR1.KA50_CPETA , STR1.KA50_DDVAL7 , STR1.KA50_DTFVA1 , STR1.KA50_DDECHB , STR1.KA50_KMRM , STR1.KA50_CDMTCO , STR1.KA50_KMDTRF , STR1.KA50_MTTAX1 , STR1.KA50_MTCMRA , STR1.KA50_MTCOTF , STR1.KA50_CDGAM , STR1.KA50_CDORCO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , Case WHEN CIR1.CD_EDS_BNQ is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR2 , Case WHEN CIR3.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPACO=CIR1.ID_SOURCE1) LEFT JOIN %SOC%.TYP_DOMN_IARD CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CDDOMI=CIR2.CD_DOMN_IARD) LEFT JOIN %SOC%.PROD_PACIFICA_PROD_CIAL CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CDPROD=CIR3.CD_PROD_ASSU_IARD AND CAST (CIR3.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
DGXB46                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPRS , CAST(Case WHEN STR1.IDOFB = '00000' then '0' else TRIM(leading '0' from STR1.IDOFB) end as CHAR(5)) IDOFB , STR1.NUOPO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_NATU_EVT_4BRNC_CST                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
T1R17P                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPACO , STR1.IDCOSE IDCOSE_BYTE , CAST(COALESCE(CIR2.ID_SOURCE1,' ') AS VARCHAR(30)) AS IDCOSE , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR3.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPACO=CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDCOSE=CIR2.BY_SOURCE1 AND SUBSTR(CIR2.ID_SOURCE1,31,3) = 'SCE') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND CIR3.CDTABO = 'T1R17P' AND CIR3.TK_ACTION IN ('I','U'))
T1R09                                             SELECT STR1.CD_EDS_BNQ , STR1.IDPACO , STR1.IDCTRA IDCTRA_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRA) end AS VARCHAR(30)) AS IDCTRA , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PART , COALESCE(CIR2.ID_DWR,0) ID_DWR_CTR , COALESCE(CIR3.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDPACO=CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CTR_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDCTRA=CIR2.BY_SOURCE1) LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND CIR3.CDTABO='T1R09')
DGCZ62                                            SELECT STR1.CD_EDS_BNQ , STR1.IDTCN , STR1.IDBTN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.CD_BQE is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.BOUTON CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDBTN = CIR1.ID_BOUTON_TECHN_CNTCT AND CAST(CIR1.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TECHN_CNTCT CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDTCN = CIR2.ID_TECHN_CNTCT AND CAST(CIR2.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
GRC818                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDECV , STR1.MVARF , STR1.CGRAT , STR1.MVRRF , STR1.CURAT , STR1.ZTEVER , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT S1.CD_BQE , ID_ELT_COVENANT ,DD_HISTO ,DF_HISTO FROM (SELECT DISTINCT CD_BQE , ID_ELT_COVENANT ,DD_HISTO ,DF_HISTO ,'1' AS RECENT FROM %SOC%.ELT_COVENANT UNION SELECT DISTINCT CD_BQE , ID_ELT_COVENANT ,DD_HISTO ,DF_HISTO ,'0' AS RECENT FROM %WRK%.ELT_COVENANT) S1 QUALIFY ROW_NUMBER() OVER(PARTITION BY S1.CD_BQE,S1.ID_ELT_COVENANT ORDER BY S1.RECENT,S1.DD_HISTO DESC,S1.DF_HISTO DESC)=1 )CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDECV = CIR1.ID_ELT_COVENANT AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_SENS_RATIO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CGRAT = CIR2.CD_SENS_RATIO AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_UNTE_RATIO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CURAT = CIR3.CD_UNTE_RATIO AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
PSOLDE                                            SELECT STR1.CD_EDS_BNQ , STR1.SVCDFI , STR1.SVCENR , STR1.NCPTEX , STR1.FILLER_2 , STR1.IDEXEF , STR1.SVCDET , STR1.DAA9 , STR1.DAMM0 , STR1.DAA91 , STR1.DAMM , STR1.SVNBDB , STR1.SVNBCR , STR1.SVMTDB , STR1.SVMTCR , STR1.NBJDB1 , STR1.NBJCR , STR1.SVNJAN , STR1.MSMIN0 , STR1.MSMDA2 , STR1.MSMAX0 , STR1.MSMDA4 , STR1.MSMDA3 , STR1.SVNBDBA , STR1.SVNBCRA , STR1.SVMTDBA , STR1.SVMTCRA , STR1.NBJDB1A , STR1.NBJCRA , STR1.SVNJANA , STR1.MSMIN0A , STR1.MSMDA2A , STR1.MSMAX0A , STR1.MSMDA4A , STR1.MSMDA3A , STR1.SVNBDBB , STR1.SVNBCRB , STR1.SVMTDBB , STR1.SVMTCRB , STR1.NBJDB1B , STR1.NBJCRB , STR1.SVNJANB , STR1.MSMIN0B , STR1.MSMDA2B , STR1.MSMAX0B , STR1.MSMDA4B , STR1.MSMDA3B , STR1.SVNBDBC , STR1.SVNBCRC , STR1.SVMTDBC , STR1.SVMTCRC , STR1.NBJDB1C , STR1.NBJCRC , STR1.SVNJANC , STR1.MSMIN0C , STR1.MSMDA2C , STR1.MSMAX0C , STR1.MSMDA4C , STR1.MSMDA3C , STR1.SVNBDBD , STR1.SVNBCRD , STR1.SVMTDBD , STR1.SVMTCRD , STR1.NBJDB1D , STR1.NBJCRD , STR1.SVNJAND , STR1.MSMIN0D , STR1.MSMDA2D , STR1.MSMAX0D , STR1.MSMDA4D , STR1.MSMDA3D , STR1.SVNBDBE , STR1.SVNBCRE , STR1.SVMTDBE , STR1.SVMTCRE , STR1.NBJDB1E , STR1.NBJCRE , STR1.SVNJANE , STR1.MSMIN0E , STR1.MSMDA2E , STR1.MSMAX0E , STR1.MSMDA4E , STR1.MSMDA3E , STR1.SVNBDBF , STR1.SVNBCRF , STR1.SVMTDBF , STR1.SVMTCRF , STR1.NBJDB1F , STR1.NBJCRF , STR1.SVNJANF , STR1.MSMIN0F , STR1.MSMDA2F , STR1.MSMAX0F , STR1.MSMDA4F , STR1.MSMDA3F , STR1.SVNBDBG , STR1.SVNBCRG , STR1.SVMTDBG , STR1.SVMTCRG , STR1.NBJDB1G , STR1.NBJCRG , STR1.SVNJANG , STR1.MSMIN0G , STR1.MSMDA2G , STR1.MSMAX0G , STR1.MSMDA4G , STR1.MSMDA3G , STR1.SVNBDBH , STR1.SVNBCRH , STR1.SVMTDBH , STR1.SVMTCRH , STR1.NBJDB1H , STR1.NBJCRH , STR1.SVNJANH , STR1.MSMIN0H , STR1.MSMDA2H , STR1.MSMAX0H , STR1.MSMDA4H , STR1.MSMDA3H , STR1.SVNBDBI , STR1.SVNBCRI , STR1.SVMTDBI , STR1.SVMTCRI , STR1.NBJDB1I , STR1.NBJCRI , STR1.SVNJANI , STR1.MSMIN0I , STR1.MSMDA2I , STR1.MSMAX0I , STR1.MSMDA4I , STR1.MSMDA3I , STR1.SVNBDBJ , STR1.SVNBCRJ , STR1.SVMTDBJ , STR1.SVMTCRJ , STR1.NBJDB1J , STR1.NBJCRJ , STR1.SVNJANJ , STR1.MSMIN0J , STR1.MSMDA2J , STR1.MSMAX0J , STR1.MSMDA4J , STR1.MSMDA3J , STR1.SVNBDBK , STR1.SVNBCRK , STR1.SVMTDBK , STR1.SVMTCRK , STR1.NBJDB1K , STR1.NBJCRK , STR1.SVNJANK , STR1.MSMIN0K , STR1.MSMDA2K , STR1.MSMAX0K , STR1.MSMDA4K , STR1.MSMDA3K , STR1.FILLER_3 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , COALESCE(CIR1.DF_FONCTIONNEMENT,CAST('1900-01-01' AS DATE)) DF_FONCTIONNEMENT , COALESCE(CIR1.DD_FONCTIONNEMENT,CAST('1900-01-01' AS DATE)) DD_FONCTIONNEMENT , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , CIR2.NPART , CIR2.CDICP , CIR2.MSFMO9 , CAST(CAST(DECODE(CIR2.DTRAA2, 0 , NULL, CIR2.DTRAA2) AS VARCHAR(8)) AS DATE FORMAT 'YYYYMMDD') DTRAA2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , CIR3.SMMTCR , CIR3.SMMTDB , CIR3.SVNJAN SVNJAN_PSOLDM , CIR3.NBJCR NBJCR_PSOLDM , CIR3.NBJDB1 NBJDB1_PSOLDM , CIR3.SMNBCR , CIR3.SMNBDB , CIR3.MSMAX0 MSMAX0_PSOLDM , CIR3.MSMIN0 MSMIN0_PSOLDM , CIR3.MSMDA2 MSMDA2_PSOLDM , CIR3.MSMDA3 MSMDA3_PSOLDM , CIR3.MSMDA4 MSMDA4_PSOLDM FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %SOC%.ACCL_CTR_ECD CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.NCPTEX=CIR1.NU_CPTE and CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG and STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT OUTER JOIN %DE1%.TCASFM CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ and STR1.NCPTEX=CIR2.NCPTE and CIR2.TK_ACTION in ('I','U')) LEFT OUTER JOIN %DE1%.PSOLDM CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.NCPTEX=CIR3.NCPTEX and CIR3.TK_ACTION in ('I','U'))
PAKADI                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCTR1 , STR1.MRASSA , STR1.TXTAUX , STR1.CDEXI7 , STR1.CBASTI , STR1.MTADI , STR1.DADMAJ , STR1.DADMAC , STR1.HEDMAS , STR1.CBASCT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN STR1.CBASTI='O' AND COALESCE(CIR1.IDEXPR, 0)<>0 THEN CIR1.IDEXPR ELSE 0 END IDEXPR_PAKCGE , CASE WHEN STR1.CBASCT='O' AND COALESCE(CIR1.IDEXP7, 0)<>0 THEN CIR1.IDEXP7 ELSE 0 END IDEXP7_PAKCGE , Case When CIR1.CD_EDS_BNQ is null OR (IDEXPR_PAKCGE=0 AND IDEXP7_PAKCGE=0)then 0 else 1 End Row_Found_CIR1 , COALESCE(CIR2.ID_DWR_EDC, 0) ID_DWR_EDC , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.PAKCGE CIR1 ON (CIR1.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR1.IDCTR1=STR1.IDCTR1 AND CIR1.TK_ACTION in ('I', 'U')) LEFT JOIN (select distinct CD_BQE,ID_EDC_CRED,ID_DWR_EDC from %SOC%.CRED WHERE TYP_SOURCE_CRED = 'S') CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(CAST(CAST(CIR1.IDCTR1 AS format 'Z(I)') AS format '9(11)') AS CHAR(11))= CIR2.ID_EDC_CRED) WHERE 1=1 and (STR1.CBASTI='O' OR STR1.CBASCT='O')
PARTEL                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , TRIM(TRIM(BOTH '00'xc FROM STR1.NUTEPA)) NUTEPA , STR1.CTYTEL , STR1.CSITEL , STR1.DELIEN , STR1.DFLIEN , STR1.CDLIR , STR1.CDCOTE , STR1.DMAJCT , STR1.IDCANA , STR1.IDTELA , STR1.CDPAYS , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_COORD , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , COALESCE(TCO2.ID_DWR,0) ID_DWR_PERSON , COALESCE(CIR6.CT_PART,' ') CT_PART , COALESCE(CIR7.ID_DWR,0) ID_DWR_ETS , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 , Case When CIR7.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR7 , Trim(CAST(CAST(CAST(STR1.CTYTEL AS format 'Z(I)') AS format '9(1)') AS CHAR(1))) CTY , Trim(CAST(CAST(CAST(STR1.CSITEL AS format 'Z(I)') AS format '9(1)') AS CHAR(1))) CSI , case when Row_Found_CIR3=1 and Row_Found_CIR4=1 then 'TEL'||CTY||CSI||TRIM(STR1.NUTEPA) Else case when Row_Found_CIR3=1 and Row_Found_CIR4=0 then 'TEL'||'1'||CSI||Trim(STR1.NUTEPA) Else case when Row_Found_CIR3=0 and Row_Found_CIR4=1 then 'TEL'||CTY||'1'||Trim(STR1.NUTEPA) Else 'TEL'||'1'||'1'||Trim(STR1.NUTEPA) End end end ID_TCO FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART=CIR2.ID_SOURCE1) LEFT JOIN %SOC%.TYP_SITUA_TEL CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE and STR1.CSITEL=CIR3.CD_SITUA_TEL AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_TEL CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE and STR1.CTYTEL=CIR4.CT_TEL AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_COORD_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND ID_TCO=TCO1.ID_SOURCE1) LEFT JOIN (SELECT T5.CD_EDS_BNQ ,T5.ID_SOURCE1 ,T5.ID_DWR FROM %TCO%.ID_PERSON_TCO T5 WHERE EXISTS (SELECT NULL FROM %SOC%.PERSON CIR5 WHERE T5.CD_EDS_BNQ=CIR5.CD_BQE and T5.ID_DWR = CIR5.ID_DWR_PERSON ) ) TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDPART=TCO2.ID_SOURCE1 ) LEFT JOIN %SOC%.PART CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_BQE AND STR1.IDPART=CIR6.ID_PART AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_ETS_TCO CIR7 ON (STR1.CD_EDS_BNQ=CIR7.CD_EDS_BNQ AND STR1.IDPART=CIR7.ID_SOURCE1)
TYINDICC                                          SELECT STR1.CD_EDS_BNQ , STR1.IDTYIN , STR1.LISOUR , STR1.LITYIN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
TYP_PROD_ASSU_IARD_CST                            SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
MOTEDC                                            SELECT STR1.CD_EDS_BNQ , STR1.IDSPEC IDSPEC_BYTE , CAST(Case When TCO1.ID_SOURCE1 is not null Then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDSPEC) End AS VARCHAR(30)) AS IDSPEC , STR1.CDEDFO , STR1.CDSDFO , CASE WHEN TRIM(STR1.CDSDFO)='' THEN '000' ELSE STR1.CDSDFO END AS CDSDFO_CIR2 , STR1.DAEDFO , STR1.DASDFO , STR1.CDMOIM , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Coalesce(TCO1.ID_DWR,0) AS ID_DWR_SITUA_PARTC_EDC , CASE WHEN TCO1.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_TCO1 , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_SITUA_PARTC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDSPEC = TCO1.BY_SOURCE1 AND SUBSTR(ID_SOURCE1,31,1)=3) LEFT JOIN %SOC%.SITUA_PARTC_ECD CIR1 ON TCO1.CD_EDS_BNQ = CIR1.CD_BQE AND TCO1.ID_DWR=CIR1.ID_DWR_SITUA_PARTC_EDC AND CIR1.DD_HISTO <=STR1.DT_ELIG AND STR1.DT_ELIG < CIR1.DF_HISTO LEFT JOIN %SOC%.TYP_MTF_SORT_DFT CIR2 ON STR1.CD_EDS_BNQ = CIR2.CD_BQE AND CDSDFO_CIR2=CIR2.CD_MTF_SORT_DFT AND CIR2.DD_HISTO <=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CIR2.DF_HISTO LEFT JOIN %SOC%.TYP_MTF_ENTREE_DFT CIR3 ON STR1.CD_EDS_BNQ = CIR3.CD_BQE AND STR1.CDEDFO=CIR3.CD_MTF_ENTREE_DFT AND CIR3.DD_HISTO <=TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) AND TD_MONTH_END(ADD_MONTHS(STR1.DT_ELIG,-1)) < CIR3.DF_HISTO
TYP_TECHN_COM_VNT_CST                             SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
SEGMREF                                           SELECT STR1.CD_EDS_BNQ , STR1.IDSGMT , STR1.IDSECH , STR1.LISEC1 , STR1.LISOUR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
PARAM_INDIC_NAF                                   SELECT STR1.CD_EDS_BNQ , STR1.TYP_NAF , STR1.CD_NAF , STR1.LB_TYP_NAF , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CURRENT_TIMESTAMP(0) DD_HISTO , CURRENT_TIMESTAMP(0) DF_HISTO FROM %DTA%.%ObjectNameFrom% STR1
CPTEPRET                                          SELECT STR1.CD_EDS_BNQ , STR1.NCPTE , STR1.DDCOMP , STR1.DFCOMP , STR1.IDEXELST , STR1.TYPCPTE , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.CPTETRG , CAST(NULL as CHAR(1)) CUSACPTE , CAST(NULL as INTEGER) CDGDM1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , case when COALESCE(CIR1.DD_VALID, STR1.DFCOMP) <= STR1.DFCOMP and COALESCE(CIR1.DF_VALID, STR1.DFCOMP) >= STR1.DFCOMP and COALESCE(CIR1.ID_DWR_EDS,0) > 0 Then CIR1.ID_DWR_EDS else Null END ID_DWR_EDS FROM %DTA%.CPTEPRET STR1 left join (SELECT CD_BQE CD_EDS_BNQ, ID_DWR_EDS, ID_EXT_EDS, DD_HISTO, DF_HISTO, DD_VALID, DF_VALID FROM %SOC%.ELT_DE_STRUCT WHERE ID_TYP_EDS = 6) CIR1 on (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ and STR1.IDEXELST = CIR1.ID_EXT_EDS and CAST(CIR1.DD_HISTO AS DATE)<=CAST(STR1.DT_ELIG AS DATE) AND CAST(STR1.DT_ELIG AS DATE) < CAST (CIR1.DF_HISTO AS DATE) AND COALESCE(CIR1.DD_VALID, STR1.DFCOMP) <= STR1.DFCOMP and COALESCE(CIR1.DF_VALID, STR1.DFCOMP) >= STR1.DFCOMP)
HICAET                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.DACAF , STR1.MTCAF1 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_ETS , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_ETS_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDPART = CIR1.ID_SOURCE1)
DTWHD001                                          SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.K300 , STR1.CDETA5 , STR1.IDELCO AS IDELCO_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.NCPTEY , STR1.IDPART , STR1.LNPATR , STR1.LNPRUS , STR1.CDTIC8 , STR1.DASIG1 , STR1.MVCPT , STR1.IDPOCE , STR1.IDUSEX , STR1.LNPATC , STR1.LNPRU3 , STR1.CDTIC9 , STR1.CDDEMB , STR1.MOCOM1 , STR1.DRPRO , STR1.DRPRO1 , STR1.FILLER , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR as ID_DWR_EDC , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 ,CIR3.ID_DWR_PART FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO=TCO1.BY_SOURCE1) LEFT Join %SOC%.CPTE CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND Trim(STR1.NCPTEY)=CAST(CAST(CAST(TRIM(CIR2.NU_CPTE) AS DECIMAL(11,0))AS FORMAT'9(11)') AS CHAR(11)) AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT Join %SOC%.PART CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND Trim(STR1.IDPART)=Trim(CIR3.ID_PART) AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE))
C816ACT                                           SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CTACO , STR1.IDCOV , STR1.CPIMVP , STR1.CQCOV , STR1.CFCOV , STR1.CTCOV , STR1.IDCCA , STR1.CPOBJC , STR1.DDCOV , STR1.DFCOV , STR1.LNCOV , STR1.CPVCR , STR1.LMINC , CIR1.LI_NATU_COVENANT , STR1.IDACT , STR1.IDACTC , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , CASE WHEN CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 , CASE WHEN CIR6.CD_BQE is null then 0 else 1 End Row_Found_CIR6 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_NATU_COVENANT CIR1 on (STR1.CQCOV=CIR1.CD_NATU_COVENANT and STR1.CD_EDS_BNQ=CIR1.CD_BQE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_CD_PERD_COVENANT CIR2 on (STR1.CFCOV=CIR2.CD_PERD_COVENANT and STR1.CD_EDS_BNQ=CIR2.CD_BQE AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_COVENANT CIR3 on (STR1.CTCOV=CIR3.CT_COVENANT and STR1.CD_EDS_BNQ=CIR3.CD_BQE AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %SOC%.CTR_CADRE CIR4 on (STR1.IDCCA=CIR4.ID_CTR_CADRE and STR1.CD_EDS_BNQ=CIR4.CD_BQE AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ACTN_CRED_COMPLEXE CIR5 on (STR1.IDACT=CIR5.ID_ACTN and STR1.CD_EDS_BNQ=CIR5.CD_BQE AND CAST(CIR5.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR5.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR6 on (STR1.CPOBJC=CIR6.CD_STATU_CRED_COMPLEXE and STR1.CD_EDS_BNQ=CIR6.CD_BQE AND CAST(CIR6.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR6.DF_HISTO AS DATE))
TDSCK174                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.IDR3PG , STR1.IDO3PG , STR1.FILLER180 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
T1R01P                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCTRA IDCTRA_BYTE , CAST(CASE WHEN CIR1.CD_EDS_BNQ is not null Then CIR1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRA) end AS VARCHAR(30)) AS IDCTRA , STR1.IDELCO IDELCO_BYTE , CAST(CASE WHEN CIR2.CD_EDS_BNQ is not null Then CIR2.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDELCO) end AS VARCHAR(30)) AS IDELCO , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_CTR , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR3.CQLCCP,' ') CQLCCP , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.IDCTRA= CIR1.BY_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDELCO= CIR2.BY_SOURCE1 and Substr(CIR2.ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %DE1%.DTWHNLIE CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_EDS_BNQ AND CIR3.CDTABO='T1R01P')
LIEN_OFR_PROD                                     SELECT STR1.CD_EDS_BNQ , STR1.CD_PROD_CIAL , STR1.ID_OFR_BQR , STR1.CD_PRES_PROD_OFR , STR1.DD_HISTO , STR1.DF_HISTO , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , Case WHEN CIR1.CD_PROD_CIAL is Null Then 0 Else 1 END Row_Found_CIR1 , Case WHEN CIR2.ID_OFR_BQR is Null Then 0 Else 1 END Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (Select DISTINCT CD_PROD_CIAL FROM %SOC%.PROD_CIAL) CIR1 ON (STR1.CD_PROD_CIAL=CIR1.CD_PROD_CIAL) LEFT JOIN (Select DISTINCT ID_OFR_BQR FROM %SOC%.OFR ) CIR2 ON (STR1.ID_OFR_BQR=CIR2.ID_OFR_BQR)
SIMDOS                                            SELECT STR1.CD_EDS_BNQ , STR1.IDVER , STR1.IDELEP , STR1.IDAGEN , STR1.IDELSTCO , STR1.IDPART , STR1.LNPART , STR1.LNPATR , STR1.LNPRUS , STR1.LIELEP , STR1.CDPHASE , STR1.DCREAT , STR1.DMODIF , STR1.CDPROV , STR1.MTPRCR , CAST(STR1.MTPRCR as DECIMAL(15,2)) MTPRCR1 , STR1.ISPROSP , STR1.IDPRCR , STR1.CDCANAL , STR1.CDCANOR , STR1.ORIGINE , STR1.SSORIG , STR1.CDTINT , STR1.CDMPRJ , STR1.DEPBIEN , STR1.CDAVWEB , STR1.IDAGQU , STR1.CDETQU , STR1.CDAVQU , STR1.CDACTM , STR1.DCONTP , STR1.CBOPTI , STR1.CDVLDS , STR1.DESPRJ , STR1.OBJPRJ , STR1.CTBIPR , STR1.NEUANC , STR1.TYPDOS , STR1.TYPPRJ , STR1.ADREMA , STR1.DAAFFD , STR1.CDJRDV , STR1.CDHRDV , STR1.IDOFC , STR1.CTCFI , STR1.CDGPRO , STR1.IDOFP , STR1.ICPRO , STR1.CDPRR1 , STR1.CDSJPR , STR1.LNPREP , STR1.CPAVAP , STR1.IDSESS , STR1.DAENVM , STR1.LSUPOP , STR1.IDJPAG , STR1.CDETDO , STR1.CPOSTA , STR1.CPOSTB , STR1.CDCOIN , STR1.CDZGEZ , STR1.NUTEPA , STR1.MTCAQU , STR1.MTTRVX , STR1.MTCTER , STR1.MKREVE , STR1.MTRVTE , STR1.MAPPO4 , STR1.MFISC2 , STR1.MCREVE , STR1.MCDEPE , STR1.MCECHE , STR1.CBPTZ , STR1.CBPTEZ , STR1.CBPPEL , STR1.CBPCEL , STR1.CBPPPL , STR1.CBPPPR , STR1.CBPPAS , STR1.CBPPC , STR1.CTSCRV , STR1.MTECHE , STR1.DF_VT , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CASE WHEN CIR4.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR4 , CIR1.ID_DWR_PART , CIR2.ID_DWR_AGT , CIR3.ID_DWR_EDS , CIR3.ID_EXT_EDS , COALESCE(CIR3.ID_TYP_EDS, 0) as ID_TYP_EDS , CIR4.ID_DWR_AGT as ID_DWR_AGT2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN ( SELECT * FROM %TCO%.ID_PART_TCO TCO1 INNER JOIN %SOC%.PART CIR11 ON (TCO1.CD_EDS_BNQ=CIR11.CD_BQE AND TCO1.ID_DWR=CIR11.ID_DWR_PART ) ) CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDPART=CIR1.ID_PART AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT OUTER JOIN( SELECT * FROM %TCO%.ID_AGT_TCO TCO2 INNER JOIN %SOC%.AGT CIR21 ON (TCO2.CD_EDS_BNQ=CIR21.CD_BQE AND TCO2.ID_DWR=CIR21.ID_DWR_AGT ) ) CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDAGEN=CIR2.ID_AGT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT OUTER JOIN %SOC%.ELT_DE_STRUCT CIR3 ON(STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDELSTCO =CIR3.ID_EXT_EDS AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT OUTER JOIN( SELECT * FROM %TCO%.ID_AGT_TCO TCO3 INNER JOIN %SOC%.AGT CIR41 ON (TCO3.CD_EDS_BNQ=CIR41.CD_BQE AND TCO3.ID_DWR=CIR41.ID_DWR_AGT ) ) CIR4 ON(STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.IDAGQU=CIR4.ID_AGT AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
C814ACT                                           SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.CTACO , STR1.IDCCA , STR1.CPIMVP , STR1.CPOBJA , STR1.IDACT , STR1.IDPART , STR1.DDCCA , STR1.DFCCA , STR1.LICCA , STR1.DDSAL , STR1.DFSAL , STR1.LMINC , STR1.IDACTA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_STATU_CRED_COMPLEXE CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CPOBJA = CIR1.CD_STATU_CRED_COMPLEXE AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.ACTN_CRED_COMPLEXE CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.IDACT = CIR2.ID_ACTN AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
C2RE13                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDCAIS , STR1.NBPAS , STR1.DADMA2 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_PART , COALESCE(TCO2.ID_DWR,0) ID_DWR_CL , CASE WHEN TCO1.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO1 , CASE WHEN TCO2.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_TCO2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_PART_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDPART = TCO1.ID_SOURCE1) LEFT JOIN %TCO%.ID_CL_TCO TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDCAIS = TCO2.ID_SOURCE1) WHERE 1=1 AND STR1.IDCAIS<>0
HRELPA                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELTD , STR1.IDPART , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , CASE WHEN CIR1.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.ELT_CONSTI_DOCU CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELTD=CIR1.ID_ELT_CONSTI_DOCU AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDPART=CIR2.ID_SOURCE1) LEFT JOIN ( SELECT PECD.CD_BQE AS CD_BQE, TCO.ID_SOURCE1 AS ID_SOURCE1, PECD.ID_ELT_CONSTI_DOCU AS ID_ELT_CONSTI_DOCU , PECD.DD_HISTO AS DD_HISTO, PECD.DF_HISTO AS DF_HISTO FROM (SELECT CD_BQE, ID_DWR_PART, ID_ELT_CONSTI_DOCU, DD_HISTO, DF_HISTO FROM %WRK%.PART_ELT_CONSTI_DOCU UNION SELECT CD_BQE, ID_DWR_PART, ID_ELT_CONSTI_DOCU, DD_HISTO, DF_HISTO FROM %SOC%.PART_ELT_CONSTI_DOCU ) AS PECD LEFT JOIN %TCO%.ID_PART_TCO TCO ON (PECD.CD_BQE=TCO.CD_EDS_BNQ AND PECD.ID_DWR_PART=TCO.ID_DWR) QUALIFY ROW_NUMBER() OVER(PARTITION BY CD_BQE, ID_DWR_PART, ID_ELT_CONSTI_DOCU ORDER BY DD_HISTO DESC)=1 ) CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IDELTD=CIR3.ID_ELT_CONSTI_DOCU AND STR1.IDPART=CIR3.ID_SOURCE1 AND STR1.DELIEN=CIR3.DD_HISTO ) WHERE 1=1 AND STR1.TK_ACTION <> 'D'
PAYS                                              SELECT STR1.CD_EDS_BNQ , STR1.CDPAYS , STR1.LIPAYS , STR1.CDZOFR , STR1.CDCEE , STR1.CDACSP , STR1.CDPABF , STR1.CDMOBF , STR1.CDINPO , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.CDOCDE , STR1.CDZONA , STR1.CDINDP , STR1.AGEMAJ , STR1.CPAINT , STR1.CDPAY0 , STR1.CDNIF , STR1.CDGDR , STR1.QLZONJ , STR1.CBDESE , STR1.QLITVA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
INCPAR                                            SELECT DISTINCT STR1.CD_EDS_BNQ , STR1.IDINPA IDINPA_BYTE , CAST(Case When TCO1.CD_EDS_BNQ is not null then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDINPA) End AS VARCHAR(30)) IDINPA , STR1.DDINPA , STR1.DFINPA , STR1.ITSPPA , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO1.ID_DWR,0) ID_DWR_SITUA_PARTC , COALESCE(CIR1.CT_DWR_SITUA_PARTC,0) ID_DWR_TYP_SITUA_PARTC , CASE WHEN CIR1.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR1 , CASE WHEN CIR2.CD_EDS_BNQ Is Null Then 0 Else 1 End Row_Found_CIR2 , CASE WHEN CIR3.CD_BQE Is Null Then 0 Else 1 End Row_Found_CIR3 , CIR2.IDPART , CIR3.CT_PART FROM %DTA%.INCPAR STR1 LEFT JOIN %TCO%.ID_SITUA_PARTC_TCO TCO1 ON(STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDINPA=TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,1)='2') LEFT JOIN %SOC%.TYP_SITUA_PARTC CIR1 ON(STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.ITSPPA=CIR1.CT_SITUA_PARTC AND CIR1.CD_REGRP_SITUA_PART=2 AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN (SELECT CD_EDS_BNQ, IDINPA, IDPART FROM %DE1%.T6R05 CIR2 WHERE CIR2.TK_ACTION IN ('I','U') QUALIFY Row_Number() OVER(PARTITION BY CD_EDS_BNQ, IDINPA ORDER BY DELIEN DESC ,DFLIEN DESC) = 1) CIR2 ON(STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDINPA=CIR2.IDINPA) LEFT JOIN %SOC%.PART CIR3 ON(CIR2.CD_EDS_BNQ=CIR3.CD_BQE AND CIR2.IDPART=CIR3.ID_PART AND CIR3.DF_HISTO = TIMESTAMP'9999-12-31 00:00:00')
CONTRA                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCTRA IDCTRA_BYTE , CAST(CASE WHEN TCO1.CD_EDS_BNQ is not null Then TCO1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRA) end AS VARCHAR(30)) AS IDCTRA , STR1.DASICO , STR1.DEFCON , STR1.DFINCO , STR1.CDMOOC , STR1.CDMOFC , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.IOFFRE , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.IDRSB,' ') IDRSB , COALESCE(CIR1.IDCANA,' ') IDCANA ,CAST(COALESCE(CIR3.ID_OFR_BQR,CAST(CAST(CAST(STR1.IOFFRE AS format 'Z(I)') AS format '9(5)') AS CHAR(5))) AS VARCHAR(30)) ID_OFR_BQR , COALESCE(TCO1.ID_DWR,0) ID_DWR_CTR , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then Case When CIR1.CD_EDS_BNQ is null then 1 else 0 End else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.CONTRA STR1 LEFT JOIN %DE1%.CPCTRA CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ and STR1.IDCTRA=CIR1.IDCTRA AND CIR1.TK_ACTION in ('I','U')) LEFT JOIN %SOC%.CNL CIR2 ON (CIR1.CD_EDS_BNQ=CIR2.CD_BQE and trim(CIR1.IDCANA)=trim(CIR2.ID_CNL) AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE) ) LEFT JOIN %SOC%.OFR CIR3 ON (99900=CIR3.CD_BQE and CAST(CAST(STR1.IOFFRE AS format '99999') AS CHAR(5)) =CAST(CIR3.ID_OFR_BQR as CHAR(5)) AND CAST(CIR3.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR3.DF_HISTO AS DATE)) LEFT JOIN %TCO%.ID_CTR_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.IDCTRA= TCO1.BY_SOURCE1)
TDSCK103                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.CLARC , STR1.IDEXEL , STR1.IDSES4 , STR1.NREM6 , STR1.LIBUD5 , STR1.IDDOTR , STR1.FILLER195 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
DGXG3B                                            SELECT STR1.CD_EDS_BNQ , STR1.IDTYR , STR1.LNTYR , STR1.IDRGL , STR1.CPTDM , STR1.CPTPS , STR1.CPDTR , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
H2RE7B                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(COALESCE(CIR1.ID_SOURCE1,'') AS VARCHAR(30)) AS IDELCO , STR1.IFBQAS , STR1.DELIEN , STR1.IDCANA , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_EDC , CAST(COALESCE(CIR2.ID_BAM,'') AS CHAR(11)) ID_BAM , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_EDC_TCO CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_EDS_BNQ AND STR1.IDELCO = CIR1.BY_SOURCE1 and SUBSTR(ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %SOC%.ECD_BAM CIR2 ON (CIR1.CD_EDS_BNQ =CIR2.CD_BQE AND CAST(CIR1.ID_SOURCE1 as VARCHAR(30)) = CIR2.ID_EDC_VEGA AND CAST(CIR2.DF_HISTO AS DATE) = '9999-12-31') LEFT JOIN %SOC%.FNCTN_BAM CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.IFBQAS = CIR3.ID_FNCTN_BAM AND CAST(CIR3.DF_HISTO AS DATE) = '9999-12-31') LEFT JOIN %SOC%.CNL CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.IDCANA = CIR4.ID_CNL AND CAST(CIR4.DF_HISTO AS DATE) = '9999-12-31')
IARFKA77                                          SELECT STR1.CD_EDS_BNQ , STR1.IDCLC , STR1.IDPACO , STR1.CDDOMI , STR1.CDPROD , STR1.NCPTPA , STR1.KA10_IDCTRT , STR1.KA64_NCOMMU , STR1.KA64_CDTYHA , STR1.KA64_CDTYRE , STR1.KA64_CDQUAL , STR1.KA64_CDNVOL , STR1.KA65_CBGDEL , STR1.KA65_CDNVOL , STR1.KA65_QTENC3 , STR1.KA65_NBPIR3 , STR1.KA65_DAATT , STR1.KA65_DARES , STR1.KA65_CDTOPB , STR1.KA66_LNNPP8A , STR1.KA66_LPENFSA , STR1.KA66_DANAI4A , STR1.KA66_LNNPP8B , STR1.KA66_LPENFSB , STR1.KA66_DANAI4B , STR1.KA66_LNNPP8C , STR1.KA66_LPENFSC , STR1.KA66_DANAI4C , STR1.KA66_LNNPP8D , STR1.KA66_LPENFSD , STR1.KA66_DANAI4D , STR1.KA66_LNNPP8E , STR1.KA66_LPENFSE , STR1.KA66_DANAI4E , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , TCO1.ID_DWR ID_DWR_CTR_IARD , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_IARD_TCO TCO1 ON (STR1.CD_EDS_BNQ = TCO1.CD_EDS_BNQ AND STR1.KA10_IDCTRT = TCO1.ID_SOURCE1)
DGXA70                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCNL , STR1.IDTCN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CAST(COALESCE(CIR1.ID_CNL,'') as CHAR(2)) ID_CNL , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.CNL CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_BQE AND STR1.IDCNL = CIR1.ID_CNL_EMACO AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TECHN_CNTCT CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_BQE AND STR1.IDTCN = CIR2.ID_TECHN_CNTCT AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
TIMELC                                            SELECT STR1.CD_EDS_BNQ , COALESCE(CIR1.CDETB9,'0') AS CDETB9 , STR1.IDELC9 , CIR1.NUCTSC , CIR1.CDBQS9 , CIR1.CDGUS9 , CIR1.NUCRS9 , CIR1.IDCDP8 , CIR1.NUCLTC , CIR1.NUCLBC , CIR1.LNBECC , CIR1.LNBQSC , CIR1.CTDEPC , CIR1.IDCLG9 , CIR1.NUBUG9 , CIR1.CDGUD9 , CIR1.CDMVP9 , CIR1.NUIDVC , CIR1.CDMEKE , CIR1.CDPCR9 , CIR1.DDCOC9 , CIR1.DFCOC9 , CIR1.CDMBC9 , CIR1.DMCOC8 , CIR1.DMCOC9 , CIR1.CDTDC9 , COALESCE (CIR1.DFTDC9,0) AS DFTDC9 , CIR1.CFPRCO , CIR1.DTDPC9 , CIR1.MTCKPR , CIR1.ZGRICC , CIR1.LNBQCC , CIR1.CDPRS9 , CIR1.NUCACS , CIR1.NUCACC , CIR1.IDNDCL , CIR1.DMNDC9 , CIR1.IDNDCD , CIR1.DENDC9 , CIR1.DFNDC9 , CIR1.NURECC , CIR1.CDAPCS , CIR1.CDGRPE , CIR1.DAJADP , CIR1.DAJPDP , CIR1.CDMPDP , CIR1.CDDOCU , CIR1.CPNBL9 , CIR1.CFDPCK , CIR1.CDFACD , CIR1.DDDF9 , CIR1.DFDF9 , CIR1.IDELL9 , CIR1.CDNATI , CIR1.IDVAD , CIR1.IDRBC , CIR1.DTOMG9 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , STR1.IDELCO AS IDELCO_BYTE , CAST(COALESCE(CIR2.ID_SOURCE1,'') AS VARCHAR(30)) IDELCO , STR1.CDETB9 CDETB9_REF , STR1.DELIEN , STR1.DFLIEN , STR1.DDEDIT ,Case when CIR3.DF_HISTO is null then CAST('1900-01-01' as DATE) else CAST(CIR3.DF_HISTO AS DATE) END as DF_HISTO_CIR , COALESCE(CIR2.ID_DWR,0) ID_DWR_EDC , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %DE1%.TIMTBK01 CIR1 ON (CIR1.CD_EDS_BNQ=STR1.CD_EDS_BNQ and CIR1.IDELC9 = STR1.IDELC9 AND CIR1.TK_ACTION in ('I','U')) LEFT JOIN %TCO%.ID_EDC_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDELCO = CIR2.BY_SOURCE1 and Substr(CIR2.ID_SOURCE1,31,3) ='ECD') LEFT JOIN %SOC%.PROD_CB CIR3 ON (CIR1.CD_EDS_BNQ = CIR3.CD_BQE and CIR1.IDCDP8 = CIR3.ID_CD_PROD_CB)
BCC                                               SELECT STR1.CD_EDS_BNQ , CAST(NULL AS VARCHAR(1)) AS FILLER , STR1.IDTYOL , STR1.IDFBCC , STR1.IDSFBC , STR1.IDOBCC , STR1.IDPART , STR1.IDCLC0 , STR1.IDCON1 , STR1.IDELST AS IDELST_BYTE ,CAST(Case When CIR3.CD_EDS_BNQ is not null then CIR3.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDELST) End AS VARCHAR(30)) AS IDELST , STR1.IDEXE5 , STR1.IDSUCA , STR1.IDCDP8 , STR1.IOFFRE , STR1.IDBAM , STR1.IDELCO AS IDELCO_BYTE , CAST(Case When CIR5.CD_EDS_BNQ is not null then CIR5.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDELCO) End AS VARCHAR(30)) AS IDELCO , STR1.NCPTEX , STR1.IDCANA , STR1.IDEXE4 , STR1.IPOSTF AS IPOSTF_BYTE , CAST(Case When CIR1.CD_EDS_BNQ is not null then CIR1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IPOSTF) End AS VARCHAR(30)) AS IPOSTF , STR1.IDWO , STR1.IFONCN , STR1.IDTYWO , STR1.IDAGT , STR1.IDELS1 AS IDELS1_BYTE , CAST(%PMU%.Bin2Char(STR1.IDELS1) AS VARCHAR(30)) AS IDELS1 , STR1.IDEXFC , STR1.IDSES , STR1.IDFCSR , STR1.CDORIG , STR1.CDTOP , STR1.DTDVA1 , STR1.DTFVA1 , STR1.HEDEB2 , STR1.HEFIN6 , STR1.CDENOU , STR1.PEDURJ , STR1.CADEVB , STR1.MOORDR , STR1.NBDEC0 , STR1.NUAUT , STR1.IDFLX , CAST(NULL AS VARCHAR(1)) AS FILLER_2 , CAST(NULL AS VARCHAR(1)) AS FILLER_3 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_PST_FNCT , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , COALESCE(CIR3.ID_DWR,0) ID_DWR_EDS_GEST , COALESCE(CIR5.ID_DWR,0) ID_DWR_EDC , COALESCE(CIR6.ID_DWR,0) ID_DWR_CLI_CIAL , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 , Case When CIR5.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR5 , Case When CIR6.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR6 FROM %DTA%.BCC STR1 LEFT JOIN %TCO%.ID_PST_FNCT_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND IPOSTF = CIR1.BY_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPART = CIR2.ID_SOURCE1) LEFT JOIN %TCO%.ID_EDS_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ and STR1.IDELST = CIR3.BY_SOURCE1) LEFT JOIN %TCO%.ID_EDC_TCO CIR5 ON (STR1.CD_EDS_BNQ = CIR5.CD_EDS_BNQ AND STR1.IDELCO = CIR5.BY_SOURCE1 AND SUBSTR(CIR5.ID_SOURCE1,31,3) = 'ECD') LEFT JOIN %TCO%.ID_CLI_CIAL_TCO CIR6 ON(STR1.CD_EDS_BNQ = CIR6.CD_EDS_BNQ AND STR1.IDCLC0 = CIR6.ID_SOURCE1)
JOURNAL_ACTION_PREUVE                             SELECT STR1.CD_EDS_BNQ , STR1.JOURNAL_ACTION_ID , STR1.PREUVE_CLIENT_ID , STR1.ACTION_ID , STR1.CANAL , STR1.CONSEILLER_ID , STR1.IDPART , STR1.DATE_ACTION , STR1.STATUT_ID , STR1.ID_CLIENT_COM_BNFCR , STR1.ENTITE_CR_BNFCR , STR1.OFFRE_ID , STR1.DAV_NUMERO , STR1.MONTANT_AVANTAGE , STR1.IND_UTI_CREDIT , STR1.IND_UTI_MRH , STR1.PREUVE_CLIENT_DT_UTI_CRE , STR1.PREUVE_CLIENT_DT_UTI_MRH , STR1.PREUVE_CLIENT_DT_UTI , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR,0) ID_DWR_AGT , COALESCE(CIR2.ID_DWR,0) ID_DWR_PART , CIR7.LI_STATU_PRVE , CIR8.LI_OFR_PRVE , CIR9.LI_CNL_FIDEL , Case When CIR1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_BQE is null then 0 else 1 End Row_Found_CIR3 , Case When CIR4.CD_BQE is null then 0 else 1 End Row_Found_CIR4 , Case When CIR5.CD_BQE is null then 0 else 1 End Row_Found_CIR5 , Case When CIR7.CD_BQE is null then 0 else 1 End Row_Found_CIR7 , Case When CIR8.CD_BQE is null then 0 else 1 End Row_Found_CIR8 , Case When CIR9.CD_BQE is null then 0 else 1 End Row_Found_CIR9 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_AGT_TCO CIR1 ON (STR1.CD_EDS_BNQ = CIR1.CD_EDS_BNQ AND STR1.CONSEILLER_ID = CIR1.ID_SOURCE1) LEFT JOIN %TCO%.ID_PART_TCO CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDPART = CIR2.ID_SOURCE1) LEFT JOIN %SOC%.PRVE_CLI_BNFCR CIR3 ON (STR1.CD_EDS_BNQ = CIR3.CD_BQE AND STR1.PREUVE_CLIENT_ID = CIR3.ID_PRVE_CLI) LEFT JOIN %SOC%.PRVE_CLI_ORIG CIR4 ON (STR1.CD_EDS_BNQ = CIR4.CD_BQE AND STR1.PREUVE_CLIENT_ID = CIR4.ID_PRVE_CLI) LEFT JOIN %SOC%.TYP_ACTN CIR5 ON (99900 = CIR5.CD_BQE AND STR1.ACTION_ID = CIR5.ID_ACTN) LEFT JOIN %SOC%.TYP_STATU_FIDL CIR7 ON (99900 = CIR7.CD_BQE AND STR1.STATUT_ID = CIR7.ID_STATU_PRVE) LEFT JOIN %SOC%.TYP_OFR_FIDL CIR8 ON (STR1.CD_EDS_BNQ = CIR8.CD_BQE AND STR1.OFFRE_ID = CIR8.ID_OFR_PRVE) LEFT JOIN %SOC%.TYP_CNL_FIDEL CIR9 ON (STR1.CANAL = CIR9.ID_CNL_FIDEL)
SEGSEG                                            SELECT STR1.CD_EDS_BNQ , STR1.IDSECO , STR1.IDSEC3 , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , CIR1.ID_SEGM_CIAL as ID_SEGM_CIAL1 , CIR2.ID_SEGM_CIAL as ID_SEGM_CIAL2 , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.SEGM_MRCH_CIAL CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDSECO = CIR1.ID_SEGM_CIAL AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.SEGM_MRCH_CIAL CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE and STR1.IDSEC3 = CIR2.ID_SEGM_CIAL AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE))
T6R21C                                            SELECT STR1.CD_EDS_BNQ , STR1.IDELCO IDELCO_BYTE , CAST(Case When TCO1.CD_EDS_BNQ is not null then TCO1.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDELCO) End AS VARCHAR(30)) IDELCO , STR1.IDSPEC IDSPEC_BYTE , CAST(Case When TCO3.CD_EDS_BNQ is not null then TCO3.ID_SOURCE1 Else %PMU%.Bin2Char(STR1.IDSPEC) End AS VARCHAR(30)) IDSPEC , STR1.DELIEN , STR1.DFLIEN , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(TCO3.ID_DWR,0) ID_DWR_EVT , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , TCO1.ID_DWR AS ID_DWR_EDC_TCO , TCO2.ID_DWR AS ID_DWR_SITUA_PARTC_EDC_TCO , CIR3.CDTELC as CDTELC , COALESCE(CIR4.ID_DWR_TYP_EVT,0) ID_DWR_TYP_EVT , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_BQE is null then 0 else 1 End Row_Found_CIR2 , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 , Case When TCO2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO2 FROM %DTA%.%ObjectNameFrom% STR1 LEFT OUTER JOIN %TCO%.ID_EVT_TCO TCO3 ON(STR1.CD_EDS_BNQ=TCO3.CD_EDS_BNQ AND STR1.IDSPEC=TCO3.BY_SOURCE1 AND SUBSTR(TCO3.ID_SOURCE1,31,1)='3') LEFT OUTER JOIN %TCO%.ID_EDC_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDELCO= TCO1.BY_SOURCE1 AND SUBSTR(TCO1.ID_SOURCE1,31,3)='ECD') LEFT OUTER JOIN %SOC%.ECD_DETENU CIR1 ON (TCO1.CD_EDS_BNQ=CIR1.CD_BQE AND TCO1.ID_DWR=CIR1.ID_DWR_EDC AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT OUTER JOIN %TCO%.ID_SITUA_PARTC_TCO TCO2 ON (STR1.CD_EDS_BNQ=TCO2.CD_EDS_BNQ AND STR1.IDSPEC=TCO2.BY_SOURCE1 AND SUBSTR(TCO2.ID_SOURCE1,31,1)='3') LEFT OUTER JOIN %SOC%.SITUA_PARTC_ECD CIR2 ON (TCO2.CD_EDS_BNQ=CIR2.CD_BQE AND TCO2.ID_DWR=CIR2.ID_DWR_SITUA_PARTC_EDC AND CAST(CIR2.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR2.DF_HISTO AS DATE)) LEFT OUTER JOIN %DE1%.SIPAEC CIR3 ON(STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDSPEC=CIR3.IDSPEC AND CIR3.TK_ACTION IN ('I','U')) LEFT OUTER JOIN %SOC%.TYP_EVT CIR4 ON(CIR3.CD_EDS_BNQ=CIR4.CD_BQE AND TO_NUMBER(CIR3.CDTELC)=CIR4.CT_EVT AND CIR4.CD_REGRP_EVT=3 AND CAST(CIR4.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR4.DF_HISTO AS DATE))
GRA080                                            SELECT STR1.CD_EDS_BNQ ,STR1.IDELCO ,STR1.IDGARA ,STR1.QQGARA ,STR1.MTGARA ,STR1.DDGARA ,STR1.DFGARA ,STR1.ZTEVER ,STR1.CSTAV6 ,STR1.CCPCAU ,STR1.IDGDEC ,STR1.DAVAGA ,STR1.DPVAGA ,STR1.MTASGA ,STR1.MTRVGA ,STR1.MVEXGA ,STR1.CDCVOR ,STR1.CTREVG ,STR1.CDREVG ,STR1.CDOPEX ,STR1.DMVEXP ,STR1.DFVEXP ,STR1.MTAVDC ,STR1.TXDCGA ,STR1.MTRVG1 ,STR1.MTRVG2 ,STR1.DBVAGA ,STR1.MPCAUT ,STR1.RE_CYCLE ,STR1.DT_ELIG ,STR1.TK_CREATE ,STR1.TK_CHANGE ,STR1.TK_FLAG ,STR1.TK_ACTION ,COALESCE(CIR7.ID_DWR_EDC,CIR1.ID_DWR_EDC,0) ID_DWR_EDC ,COALESCE (CIR7.DD_HISTO,CIR1.DD_HISTO) AS DD_HISTO_EDC ,CASE WHEN CIR1.CD_BQE IS NULL AND CIR7.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR1 ,CASE WHEN CIR2.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR2 ,CASE WHEN CIR3.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR3 ,CASE WHEN CIR4.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR4 ,CASE WHEN CIR5.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR5 ,CASE WHEN CIR6.CD_BQE IS NULL THEN 0 ELSE 1 END Row_Found_CIR6 FROM %DTA%.GRA080 STR1 LEFT JOIN %SOC%.CRED CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.IDELCO=CIR1.ID_EDC_CRED AND CIR1.TYP_SOURCE_CRED IN ('G', 'L') AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %SOC%.TYP_LIEN_PRT_CAUTION CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_BQE AND STR1.CCPCAU=CIR2.CD_LIEN_PRT_CAUTION) LEFT JOIN %SOC%.TYP_AVNC_INSTRCTN_GRNT CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_BQE AND STR1.CSTAV6=CIR3.CD_AVNC_INSTRCTN_GRNT) LEFT JOIN %SOC%.TYP_MODE_RVLRSN_GRNT CIR4 ON (STR1.CD_EDS_BNQ=CIR4.CD_BQE AND STR1.CTREVG=CIR4.CD_MODE_RVLRSN_GRNT) LEFT JOIN %SOC%.TYP_REGLE_RVLRSN_GRNT CIR5 ON (STR1.CD_EDS_BNQ=CIR5.CD_BQE AND STR1.CDREVG=CIR5.CD_REGLE_RVLRSN_GRNT) LEFT JOIN %SOC%.TYP_OPTN_VAL_EXPRT CIR6 ON (STR1.CD_EDS_BNQ=CIR6.CD_BQE AND STR1.CDOPEX=CIR6.CD_OPTN_VAL_EXPRT) LEFT JOIN ( SELECT DISTINCT ED.CD_BQE, ED.ID_EDC_CRED, ED.ID_DWR_EDC,PF.DD_HISTO,PF.DF_HISTO FROM %SOC%.PLFD_UTIL PF INNER JOIN %SOC%.ECD_DETENU ED ON PF.CD_BQE = ED.CD_BQE AND PF.ID_EDC_ECHCE = ED.ID_EDC_CRED ) CIR7 ON (CIR7.CD_BQE = STR1.CD_EDS_BNQ AND STR1.IDELCO=CIR7.ID_EDC_CRED AND CAST(CIR7.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR7.DF_HISTO AS DATE))
TYP_NB_J_ANO_RISQ_CST                             SELECT STR1.CD_BQE AS CD_EDS_BNQ, STR1.NB_J_ANO_RISQ, CASE WHEN STR1.NB_J_ANO_RISQ in (0,1) THEN CAST(TRIM(CAST(STR1.NB_J_ANO_RISQ AS VARCHAR(11)))||' jour' AS VARCHAR(60)) ELSE CAST(TRIM(CAST(STR1.NB_J_ANO_RISQ AS VARCHAR(11)))||' jours' AS VARCHAR(60)) END AS LI_NB_J_ANO_RISQ, CASE WHEN STR1.NB_J_ANO_RISQ = 0 THEN '01' WHEN STR1.NB_J_ANO_RISQ = 1 THEN '02' WHEN STR1.NB_J_ANO_RISQ = 2 THEN '03' WHEN STR1.NB_J_ANO_RISQ = 3 THEN '04' WHEN STR1.NB_J_ANO_RISQ = 4 THEN '05' WHEN STR1.NB_J_ANO_RISQ = 5 THEN '06' WHEN STR1.NB_J_ANO_RISQ >= 6 AND STR1.NB_J_ANO_RISQ <= 10 THEN '07' WHEN STR1.NB_J_ANO_RISQ >= 11 AND STR1.NB_J_ANO_RISQ <= 15 THEN '08' WHEN STR1.NB_J_ANO_RISQ >= 16 AND STR1.NB_J_ANO_RISQ <= 20 THEN '09' WHEN STR1.NB_J_ANO_RISQ >= 21 AND STR1.NB_J_ANO_RISQ <= 25 THEN '10' WHEN STR1.NB_J_ANO_RISQ >= 26 AND STR1.NB_J_ANO_RISQ <= 30 THEN '11' WHEN STR1.NB_J_ANO_RISQ >= 31 AND STR1.NB_J_ANO_RISQ <= 35 THEN '12' WHEN STR1.NB_J_ANO_RISQ >= 36 AND STR1.NB_J_ANO_RISQ <= 40 THEN '13' WHEN STR1.NB_J_ANO_RISQ >= 41 AND STR1.NB_J_ANO_RISQ <= 45 THEN '14' WHEN STR1.NB_J_ANO_RISQ >= 46 AND STR1.NB_J_ANO_RISQ <= 50 THEN '15' WHEN STR1.NB_J_ANO_RISQ >= 51 AND STR1.NB_J_ANO_RISQ <= 55 THEN '16' WHEN STR1.NB_J_ANO_RISQ >= 56 AND STR1.NB_J_ANO_RISQ <= 60 THEN '17' WHEN STR1.NB_J_ANO_RISQ >= 61 AND STR1.NB_J_ANO_RISQ <= 70 THEN '18' WHEN STR1.NB_J_ANO_RISQ >= 71 AND STR1.NB_J_ANO_RISQ <= 80 THEN '19' WHEN STR1.NB_J_ANO_RISQ >= 81 AND STR1.NB_J_ANO_RISQ <= 90 THEN '20' WHEN STR1.NB_J_ANO_RISQ >= 91 THEN '21' ELSE '-1' END AS CD_TRCH_ANO_RISQ, STR1.DD_HISTO, STR1.DF_HISTO, STR1.TK_FLAG, STR1.TK_ACTION FROM %WRK%.TYP_NB_J_ANO_RISQ STR1 UNION SELECT * FROM ( SEL 99900 AS CD_EDS_BNQ, -1 AS NB_J_ANO_RISQ, CAST('NON RENSEIGNE' AS VARCHAR(60)) AS LI_NB_J_ANO_RISQ, '-1' AS CD_TRCH_ANO_RISQ, CAST('1900-01-01 00:00:00' AS TIMESTAMP(0)) AS DD_HISTO, CAST('9999-12-31 00:00:00' AS TIMESTAMP(0)) AS DF_HISTO, 'Y' AS TK_FLAG, 'I' AS TK_ACTION ) AS DEF
SEGMTREF                                          SELECT STR1.CD_EDS_BNQ , STR1.IDSGMT , STR1.LISEC2 , STR1.CDCDO , STR1.CDPRC1 , STR1.LISOUR , STR1.CTSEG8 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
CTRASP                                            SELECT STR1.CD_EDS_BNQ , STR1.IDCTRA IDCTRA_BYTE , CAST(CASE WHEN REF1.CD_EDS_BNQ is not null Then REF1.ID_SOURCE1 else %PMU%.Bin2Char(STR1.IDCTRA) end AS VARCHAR(30)) AS IDCTRA , STR1.IDASPR , STR1.DDLIE9 , STR1.DFLIE9 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_CTR,0) ID_DWR_CTR , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CTR_TCO REF1 ON (STR1.CD_EDS_BNQ = REF1.CD_EDS_BNQ AND STR1.IDCTRA= REF1.BY_SOURCE1) LEFT JOIN %SOC%.CTR_DETENU CIR1 ON (REF1.CD_EDS_BNQ=CIR1.CD_BQE AND REF1.ID_DWR=CIR1.ID_DWR_CTR AND CAST(CIR1.DD_HISTO AS DATE)<=STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE))
TDSCK170                                          SELECT STR1.CD_EDS_BNQ , STR1.CDTCR2_NPU , STR1.CDEVA , STR1.NURNG_NPU , STR1.DACRE0_NPU , STR1.LNMPGE_NPU , STR1.CDEVF_NPU , STR1.IDCNL2_NPU , STR1.NCPTEX_NPU , STR1.IDPRB2 , STR1.IDCDP3 , STR1.IDPRB4 , STR1.IDCDP4 , STR1.IDDEVI , STR1.CDDEVI , STR1.MOOPF2_NPU , STR1.CADEVI_NPU , STR1.CDDEV1_NPU , STR1.MTDEV1_NPU , STR1.DTRAA2 , STR1.HETRT1 , STR1.DVMVRE_NPU , STR1.DVMVTH_NPU , STR1.IDTYME , STR1.CDAPP8 , STR1.CSENS , STR1.CDMDT , STR1.CDMRE3 , STR1.MOSPE1 , STR1.CDMOO3 , STR1.CDMORF , STR1.CCATM , STR1.NORDG2 , STR1.NUORD6 , STR1.CBINDR , STR1.DADTS , STR1.HEDTS0 , STR1.NUORD0 , STR1.FILLER15 , STR1.CTSLD1 , STR1.CDTCR2 , STR1.CDEVF , STR1.IDCRF AS IDCRF_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF) AS VARCHAR(30)) AS IDCRF , STR1.NURNG , STR1.DACRE0 , STR1.LNMPGE , STR1.CDBCF , STR1.CDGBD1 , STR1.NCPTEX , STR1.NCLERI , STR1.MOOPF2 , STR1.IDCNL2 , STR1.CTYDO , STR1.IDEXE6 , STR1.CDBCF1 , STR1.IDEXEV , STR1.NBREC , STR1.CDFOT1 , STR1.CDDGES , STR1.FILLER02 , STR1.CDFSU , STR1.IDEXEX , STR1.IDORDR AS IDORDR_BYTE , CAST(%PMU%.Bin2Char(STR1.IDORDR) AS VARCHAR(30)) AS IDORDR , STR1.IDCRF2 AS IDCRF2_BYTE , CAST(%PMU%.Bin2Char(STR1.IDCRF2) AS VARCHAR(30)) AS IDCRF2 , STR1.NURNG2 , STR1.CTCHA , STR1.DOOPF1 , STR1.HEOPE , STR1.DAENT , STR1.HEENT , STR1.DCPTA1 , STR1.DVREF , STR1.DVMVTH , STR1.DVMVRE , STR1.CDFVA , STR1.CADEVI , STR1.MTDEV1 , STR1.LIMVEL , STR1.IDUSER , STR1.IDSTR , STR1.CDDEV1 , STR1.CQCNL , STR1.FILLER28 , STR1.IDOPET , STR1.FILLER245 , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
CAISLO                                            SELECT STR1.CD_EDS_BNQ , STR1.NOMTAB , CAST(CAST(STR1.IDCAIS AS FORMAT '9999') AS DECIMAL(4,0)) IDCAIS , STR1.LNCAIS , STR1.CTCAIS , STR1.DDVAL , STR1.DFVAL , STR1.HFVAL , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(ID_DWR,0) ID_DWR_CL , Case When TCO1.CD_EDS_BNQ is null then 0 else 1 End Row_Found_TCO1 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %TCO%.ID_CL_TCO TCO1 ON (STR1.CD_EDS_BNQ=TCO1.CD_EDS_BNQ AND STR1.IDCAIS=TCO1.ID_SOURCE1)
C1RE70                                            SELECT STR1.CD_EDS_BNQ , STR1.IDPART , STR1.IDQUEX , STR1.DDVALK , STR1.DFVALQ , STR1.DTREVP , STR1.CQQEX , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR3.ID_DWR,0) AS ID_DWR_PART , Case When CIR1.CD_BQE is null then 0 else 1 End Row_Found_CIR1 , Case When CIR2.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR2 , Case When CIR3.CD_EDS_BNQ is null then 0 else 1 End Row_Found_CIR3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN %SOC%.TYP_STATU_MIF CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE AND STR1.CQQEX = CIR1.CD_STATU__MIF AND CAST(CIR1.DD_HISTO AS DATE) <= STR1.DT_ELIG AND STR1.DT_ELIG < CAST (CIR1.DF_HISTO AS DATE)) LEFT JOIN %DE1%.TQUAEX CIR2 ON (STR1.CD_EDS_BNQ=CIR2.CD_EDS_BNQ AND STR1.IDQUEX = CIR2.IDQUEX) LEFT JOIN %TCO%.ID_PART_TCO CIR3 ON (STR1.CD_EDS_BNQ=CIR3.CD_EDS_BNQ AND STR1.IDPART=CIR3.ID_SOURCE1)
DATBDC61                                          SELECT STR1.CD_EDS_BNQ , STR1.CDEMD , STR1.CDPCH , STR1.CDOED , STR1.CSEDD , STR1.CPEED , STR1.CDBUR , STR1.NUAHX , STR1.IDCNT , STR1.IDPRO , STR1.DBOPI1 , STR1.TXNOMB , STR1.NUDEB , STR1.NUFIN , STR1.QTOPI1 , STR1.LICLT , STR1.PDOPE1 , STR1.TBDTB1 , STR1.TXMRG1 , STR1.CTOPI , STR1.DHOPI1 , STR1.CFINR , STR1.CTFIS , STR1.CPNAS , STR1.CPOPI , STR1.TXACLB , STR1.NCDAS , STR1.NCDAI , STR1.UKNOM , STR1.MKNOM5 , STR1.UVVER , STR1.MVVER3 , STR1.DHPIN1 , STR1.DHDIN1 , STR1.UCBRU , STR1.MCBRU6 , STR1.UCBRL , STR1.MCBRLA , STR1.UCCTV , STR1.MCCTVD , STR1.UCPLF , STR1.MCPLF5 , STR1.UCCTB , STR1.MCCTB5 , STR1.UCISF , STR1.MCISF6 , STR1.UCAFI , STR1.MCAFID , STR1.UCREM , STR1.MCREM1 , STR1.CLGED , STR1.CPAVI , STR1.CDSAE , STR1.DASAE1 , STR1.HESAE , STR1.DADMA1 , STR1.IDCDPJ , STR1.NBLETP , STR1.RE_CYCLE , STR1.DT_ELIG , STR1.TK_CREATE , STR1.TK_CHANGE , STR1.TK_FLAG , STR1.TK_ACTION , COALESCE(CIR1.ID_DWR_EDC,0) ID_DWR_EDC , CIR2.MORBT3 FROM %DTA%.%ObjectNameFrom% STR1 LEFT JOIN (SELECT CD_BQE, NU_CPTE, MAX(ID_DWR_EDC) AS ID_DWR_EDC FROM %SOC%.ECD_CPTE WHERE CT_LIEN_EDC_CPTE = 'ELCOCPTE' GROUP BY 1, 2) AS CIR1 ON (STR1.CD_EDS_BNQ=CIR1.CD_BQE and STR1.IDCNT=CIR1.NU_CPTE) LEFT JOIN ( SELECT CD_EDS_BNQ, IDCNT, NUDEB, SUM (MORBT3) AS MORBT3 FROM %DE1%.DATBDC62 GROUP BY CD_EDS_BNQ,IDCNT,NUDEB WHERE TK_ACTION in ('I','U') ) CIR2 ON (STR1.CD_EDS_BNQ = CIR2.CD_EDS_BNQ AND STR1.IDCNT = CIR2.IDCNT AND STR1.NUDEB = CIR2.NUDEB)
TYP_NATU_SURT_CST                                 SELECT DISTINCT CAST(CD_BQE AS INTEGER) CD_EDS_BNQ , CAST('-1' AS VARCHAR(2)) ID_CL , CAST('NON RENSEIGNE' AS VARCHAR(13)) LI_CL , CAST('1900-01-01' AS DATE) DD_VALID , CAST('9999-12-31' AS DATE) DF_VALID , CAST(NULL AS TIME) HR_FIN_VALID , CAST('NON RENS' AS VARCHAR(10)) LC_CL , CAST('1900-01-01 00:00:00' AS TIMESTAMP) DD_HISTO , CAST('9999-12-31 00:00:00' AS TIMESTAMP) DF_HISTO , CAST('' AS VARCHAR(2)) ID_CL_EMACO , CAST('*' AS VARCHAR(1)) TK_FLAG , CAST('I' AS VARCHAR(1)) TK_ACTION FROM %SOC%.CL STR1
TYFAITUT                                          SELECT STR1. CD_EDS_BNQ , STR1. CTFUT , STR1. LIFUT , STR1. LMFUT LMFUT3 , STR1. LMFUT2 , TRIM(STR1.LMFUT) || TRIM(STR1.LMFUT2) LMFUT , STR1. RE_CYCLE , STR1. DT_ELIG , STR1. TK_CREATE , STR1. TK_CHANGE , STR1. TK_FLAG , STR1. TK_ACTION FROM %DTA%.%ObjectNameFrom% STR1
